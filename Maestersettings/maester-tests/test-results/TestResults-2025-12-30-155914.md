# <img src="https://maester.dev/img/logo.svg" alt="Maester logo" height="40" width="40" /> Maester Test Results

This is a summary of the test results from the Maester test run.

**Tenant:** Giraffe-it B.V.

**Date:** 12/30/2025 15:59:14

| üî• <br/> Total Tests | ‚úÖ <br/> Passed  | ‚ùå <br/> Failed | üîç <br/> Investigate | ‚ùî <br/> Skipped | ‚ùî <br/> Not Run |
|:-:|:-:|:-:|:-:|:-:|:-:|
| **313** | **208** | **54** | **0** | **29** |**20** |


## Test summary

|Test|Status|
|-|:-:|
| CIS.M365.1.1.1: Ensure Administrative accounts are cloud-only | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.1: Ensure that only organizationally managed/approved public groups exist | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.2: Ensure sign-in to shared mailboxes is blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.1: Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)' | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.3: Ensure 'External sharing' of calendars is not available | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.6: Ensure the customer lockbox feature is enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.2.1.1: Ensure Safe Links for Office Applications is Enabled (Only Checks Priority 0 Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.11: Ensure comprehensive attachment filtering is applied | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.12: Ensure the connection filter IP allow list is not used (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.13: Ensure the connection filter safe list is off (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.2: Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.3: Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.4: Ensure Safe Attachments policy is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.5: Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.6: Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.7: Ensure that an anti-phishing policy has been created (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.9: Ensure that DKIM is enabled for all Exchange Online Domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.4.4: Ensure Zero-hour auto purge for Microsoft Teams is on (Only Checks ZAP is enabled) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.3.1.1: Ensure Microsoft 365 audit log search is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.1.1: Ensure external file sharing in Teams is enabled for only approved cloud storage services | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.2.2: Ensure communication with unmanaged Teams users is disabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.4.1: Ensure all or a majority of third-party and custom apps are blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.5.3: Ensure only people in my org can bypass the lobby | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.8.6.1: Ensure users can report security concerns in Teams to internal destination | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.1.1: Legacy authentication SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.1: Users detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.3: If Microsoft Authenticator is enabled, it SHALL be configured to show login context information. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.7: Managed devices SHOULD be required for authentication. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.8: Managed Devices SHOULD be required to register MFA. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.4.1: Security logs SHALL be sent to the agency's security operations center for monitoring. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.5.1: Only administrators SHALL be allowed to register applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.3: An admin consent workflow SHALL be configured for applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.6.1: User passwords SHALL NOT expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Entra ID directory objects. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.1.1: Automatic forwarding to external domains SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.1: Emails SHALL be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.1: Impersonation protection checks SHOULD be used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.1: IP allow lists SHOULD NOT be created. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.2: Safe lists SHOULD NOT be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.13.1: Mailbox auditing SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.1: A spam filter SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.2: Direct download links SHOULD be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.3: User click tracking SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.16.1: Alerts SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.1: A list of approved IP addresses for sending mail SHALL be maintained. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.3.1: DKIM SHOULD be enabled for all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.1: A DMARC policy SHALL be published for every second-level domain. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.2: The DMARC message rejection option SHALL be p=reject. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.5.1: SMTP AUTH SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.1: Contact folders SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.2: Calendar details SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.7.1: External sender warnings SHALL be implemented. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.8.1: A DLP solution SHALL be used. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.9.1: Emails SHALL be filtered by attachment file types. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.3: Disallowed file types SHALL be determined and enforced. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF01: Authentication Method - FIDO2 security key - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AG01: Authentication Method - General Settings - Manage migration. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP07: Default Authorization Settings - Guest user access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP09: Default Authorization Settings - Allow user consent on risk-based apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT01: Authentication Method - Temporary Access Pass - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AV01: Authentication Method - Voice call - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1001: At least one Conditional Access policy is configured with device compliance. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1002: App management restrictions on applications and service principals is configured and enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1003: At least one Conditional Access policy is configured with All Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1004: At least one Conditional Access policy is configured with All Apps and All Users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1006: At least one Conditional Access policy is configured to require MFA for admins. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1007: At least one Conditional Access policy is configured to require MFA for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1009: At least one Conditional Access policy is configured to block other legacy authentication. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1016: At least one Conditional Access policy is configured to require MFA for guest access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1022: All users utilizing a P1 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1023: All users utilizing a P2 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1024.: . | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1025: No external user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1026: No hybrid user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1028: No user with mailbox and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1029: Stale accounts are not assigned to privileged roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1030: Eligible role assignments on Control Plane are in use by administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1031: Privileged role on Control Plane are managed by PIM only. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1032: Limited number of Global Admins are assigned. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1036: All excluded objects should have a fallback include in another policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1037: Only users with Presenter role are allowed to present in Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1038: Conditional Access policies should not include or exclude deleted groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1039: Ensure MailTips are enabled for end users | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1040: Ensure additional storage providers are restricted in Outlook on the web | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1041: Ensure users installing Outlook add-ins is not allowed | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1042: Restrict dial-in users from bypassing a meeting lobby  | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1043: Ensure Spam confidence level (SCL) is configured in mail transport rules with specific domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1044: Ensure modern authentication for Exchange Online is enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1045: Only invited users should be automatically admitted to Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1046: Restrict anonymous users from joining meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1047: Restrict anonymous users from starting Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1048: Limit external participants from having control in a Teams meeting | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1049: Conditional Access policies for User Risk and Sign-in Risk should be configured separately. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1052: At least one Conditional Access policy is targeting the Device Code authentication flow. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1053: Ensure intune device clean-up rule is configured | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1054: Ensure built-in Device Compliance Policy marks devices with no compliance policy assigned as 'Not compliant' | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1055: Microsoft 365 Group (and Team) creation should be restricted to approved users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1056: Ensure that no person has permanent access to all Azure subscriptions at the root scope | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1061: Device registration MFA control conflicts with Conditional Access policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1062: Ensure Direct Send is set to be rejected | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1065: Ensure all Recovery Services Vaults have soft delete enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1066: Conditional Access policies should not reference non-existent users, groups, or roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1067: Authentication method policies should not reference non-existent groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1068: Restrict non-admin users from creating tenants. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1069: Restrict non-admin users from creating security groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1070: Restrict device join to selected users/groups or none. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1071: At least one Conditional Access policy explicitly includes Azure DevOps. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1072: Conditional access policies should not use the deprecated Approved Client App grant. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1085: Pending approvals for Critical Asset Management should not be present. |  |
| MT.1090: Global administrator role should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1091: Registering user should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1096: Ensure at least one Intune Multi Admin Approval policy is configured | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1098: Mobile Threat Defense Connectors should be healthy | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1099: Windows Diagnostic Data Processing should be enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1100: Intune Diagnostic Settings should include Audit Logs | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1101: Default Branding Profile should be customized | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1102: Windows Feature Update Policy Settings should not reference end of support builds | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1103: Ensure Intune RBAC groups are protected by Restricted Management Administrative Units or Role Assignable groups | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1105: Ensure MDM Authority is set to Intune | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.100: Bulk Complaint Level threshold is between 4 and 6. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.101: Bulk is marked as spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.102: Advanced Spam filter options are turned off. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.103: Outbound spam filter policy settings configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.104: High Confidence Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.105: Safe Links Synchronous URL detonation is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.106: Quarantine retention period is 30 days. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.107: End-user spam notification is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108: DKIM signing is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108.1: DNS Records have been set up to support DKIM. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.109: Senders are not being allow listed in an unsafe manner. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.110: Internal Sender notifications are disabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.111: Anti-phishing policy exists and EnableUnauthenticatedSender is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.112: Anti-spoofing protection action is configured to Move message to the recipients' Junk Email folders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.113: AllowClickThrough is disabled in Safe Links policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.114: No IP Allow Lists have been configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.115: Mailbox intelligence based impersonation protection is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.116: Mailbox intelligence based impersonation protection action set to move message to junk mail folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.1: Domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.2: Domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.3: Your own domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.4: Your own domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.119: Similar Domains Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.1: Zero Hour Autopurge Enabled for Phish. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.2: Zero Hour Autopurge Enabled for Malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.3: Zero Hour Autopurge Enabled for Spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.121: Supported filter policy action used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.123: Unusual Characters Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.124: Safe attachments unknown malware response set to block messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.139: Spam action set to move message to junk mail folder or quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.140: High Confidence Spam action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.141: Bulk action set to Move message to Junk Email Folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.142: Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.156: Safe Links Policies are tracking when user clicks on safe links. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.158: Safe Attachments is enabled for SharePoint and Teams. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.179: Safe Links is enabled intra-organization. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.180: Anti-phishing policy exists and EnableSpoofIntelligence is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189: Safe Attachments is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189.2: Safe Links is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.205: Common attachment type filter is enabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.220: Advanced Phish filter Threshold level is adequate. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.221: Mailbox intelligence is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.222: Domain Impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.223: User impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.224: Similar Users Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.225: Safe Documents is enabled for Office clients. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.226: Each domain has a Safe Link policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.227: Each domain has a Safe Attachments policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.228: No trusted senders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.229: No trusted domains in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.230: Each domain has a Anti-phishing policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.231: Each domain has a anti-spam policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.232: Each domain has a malware filter policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233: Domains are pointed directly at EOP or enhanced filtering is used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233.1: Domains are pointed directly at EOP or enhanced filtering is configured on all default connectors. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.234: Click through is disabled for Safe Documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.235: SPF records is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.236: Safe Links is enabled for emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.237: Safe Links is enabled for teams messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.238: Safe Links is enabled for office documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.239: No exclusions for the built-in protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.240: Outlook is configured to display external tags for external emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.241: Anti-phishing policy exists and EnableFirstContactSafetyTips is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.242: Important protection alerts responsible for AIR activities are enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.243: Authenticated Receive Chain is set up for domains not pointing to EOP/MDO, or all domains point to EOP/MDO. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.244: Policies are configured to honor sending domains DMARC. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.1.3: Ensure that between two and four global admins are designated | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C). | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.4.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.8.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.9.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AS04: Authentication Method - SMS - Use for sign-in. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1021: Security Defaults are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1033.0: User should be blocked from using legacy authentication (Sander.breijer@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.1: User should be blocked from using legacy authentication (Adriaan.de.koning@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.2: User should be blocked from using legacy authentication (Michel.Melk@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.3: User should be blocked from using legacy authentication (Website@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.4: User should be blocked from using legacy authentication (Info@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1050: Apps with high-risk permissions having a direct path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1051: Apps with high-risk permissions having an indirect path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1057: App registrations should no longer use secrets. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1058: Exchange application access policies must be configured. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1063: All App registration owners should have MFA registered | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1064: Ensure that write permissions are required to create new management groups | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1073: Soft- and hard-matching of synchronized objects should be blocked. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1074: Ensure no more then 100 outbound mails per day are send using the .onmicrosoft.com domain |  |
| MT.1075: Require explicit assignment of Third Party Entra Apps. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1076: MOERA SHOULD NOT be used for sent mail | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1077: App registrations with privileged API permissions should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1078: App registrations with highly privileged directory roles should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1079: Privileged API permissions on service principals should not remain unused. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1080: Credentials, tokens, or cookies from highly privileged users should not be exposed on vulnerable endpoints. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1081: Hybrid users should not be assigned Entra ID role assignments. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1083: Ensure Delicensing Resiliency is enabled | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1084: Microsoft Entra seamless single sign-on should be disabled for all domains in EntraID Connect servers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1086: Devices should not share both critical and non-critical user credentials. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1087: Devices should not be publicly exposed with remotely exploitable, highly likely to be exploited, high or critical severity CVE's. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1088: Devices with critical credentials should be protected by TPM. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1089: Devices with critical credentials should be protected by Credential Guard. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1092: Intune APNS certificate should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1093: Apple Automated Device Enrollment Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1094: Apple Volume Purchase Program Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1095: Android Enterprise account connection should be healthy | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1097: Ensure all Intune Certificate Connectors are healthy and running supported versions | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| ORCA.143: Safety Tips are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |


## Test details

### ‚úÖ CIS.M365.1.1.1: Ensure Administrative accounts are cloud-only

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

1.1.1 (L1) Ensure Administrative accounts are cloud-only

Administrative accounts are special privileged accounts that could have varying levels of access to data, users, and settings. Regular user accounts should never be utilized for administrative tasks and care should be taken, in the case of a hybrid environment, to keep Administrative accounts separated from on-prem accounts. Administrative accounts should not have applications assigned so that they have no access to potentially vulnerable services (EX. email, Teams, SharePoint, etc.) and only access to perform tasks as needed for administrative purposes.

#### Remediation action:

To created licensed, separate Administrative accounts for Administrative users:
1. Navigate to Microsoft 365 admin center [https://admin.microsoft.com](https://admin.microsoft.com).
2. Click to expand **Users** select **Active users**
3. Click **Add a user**.
4. Fill out the appropriate fields for Name, user, etc.
5. When prompted to assign licenses select as needed **Microsoft Entra ID P1** or
**Microsoft Entra ID P2**, then click **Next**.
6. Under the **Option settings** screen you may choose from several types of
Administrative access roles. Choose **Admin center access** followed by the
appropriate role then click **Next**.
7. Select **Finish adding**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v 4.0.0 - Page 20](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant has no hybrid Global Administrators:

| Display Name | Cloud Only |
| --- | --- |
| ADM Break Glass01 | Giraffe IT | ‚úÖ Pass |
| ADM Jesse Mulder | Giraffe IT | ‚úÖ Pass |
| ADM Michel Melk | Giraffe IT | ‚úÖ Pass |
| ADM Romke Oppedijk | Giraffe IT | ‚úÖ Pass |
| ADM Sander Breijer | Giraffe IT | ‚úÖ Pass |


**Tag**: `CIS.M365.1.1.1` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisCloudAdmin.Tests.ps1`

---

### ‚úÖ CIS.M365.1.2.1: Ensure that only organizationally managed/approved public groups exist

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

1.2.1 (L2) Ensure that only organizationally managed/approved public groups exist

Microsoft 365 Groups is the foundational membership service that drives all teamwork across Microsoft 365. With Microsoft 365 Groups, you can give a group of people access to a collection of shared resources. While there are several different group types this recommendation concerns Microsoft 365 Groups.

Ensure that only organizationally managed and approved public groups exist.

#### Remediation action:

To enable only organizationally managed/approved public groups exist:
1. Navigate to Microsoft 365 admin center [https://admin.microsoft.com](https://admin.microsoft.com).
2. Click to expand **Teams & groups** select **Active teams & groups**.
3. On the **Active teams and groups** page, select the group's name that is public.
4. On the popup groups name page, **Select Settings**.
5. Under Privacy, select **Private**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 36](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant has no public 365 groups:

| Display Name | Group Public |
| --- | --- |


**Tag**: `CIS.M365.1.2.1` `L2` `CIS E3 Level 2` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCis365PublicGroup.Tests.ps1`

---

### ‚úÖ CIS.M365.1.2.2: Ensure sign-in to shared mailboxes is blocked

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

1.2.2 (L1) Ensure sign-in to shared mailboxes is blocked

The intent of the shared mailbox is the only allow delegated access from other mailboxes. An admin could reset the password, or an attacker could potentially gain access to the shared mailbox allowing the direct sign-in to the shared mailbox and subsequently the sending of email from a sender that does not have a unique identity. To prevent this, block sign-in for the account that is associated with the shared mailbox.

#### Remediation action:

Block sign-in to shared mailboxes in the UI:
1. Navigate to Microsoft 365 admin center [https://admin.microsoft.com](https://admin.microsoft.com).
2. Click to expand **Teams & groups** and select **Shared mailboxes**.
3. Take note of all shared mailboxes.
4. Click to expand **Users** and select **Active users**.
5. Select a shared mailbox account to open its properties pane and then select **Block sign-in**.
6. Check the box for Block this user from signing in.
7. Repeat for any additional shared mailboxes.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 39](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant has no shared mailboxes with sign-in enabled:

| Shared Mailbox | Sign-in Disabled |
| --- | --- |



**Tag**: `CIS.M365.1.2.2` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisSharedMailboxSignIn.Tests.ps1`

---

### ‚úÖ CIS.M365.1.3.1: Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)'

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

1.3.1 (L1) Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)'

Organizations such as NIST and Microsoft have updated their password policy recommendations to not arbitrarily require users to change their passwords after a specific amount of time, unless there is evidence that the password is compromised, or the user forgot it.

#### Remediation action:

To set Office 365 passwords are set to never expire:
1. Navigate to Microsoft 365 admin center [https://admin.microsoft.com](https://admin.microsoft.com).
2. Click to expand **Settings** select **Org Settings**.
3. Click on **Security & privacy**.
4. Check the **Set passwords to never expire (recommended)** box.
5. Click **Save**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 43](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant passwords are not set to expire:

| Display Name | Domain |
| --- | --- |
| Giraffeit.onmicrosoft.com | ‚úÖ Pass |
| giraffe-it.com | ‚úÖ Pass |
| giraffe-it.cloud | ‚úÖ Pass |
| Giraffe-it.eu | ‚úÖ Pass |
| Giraffe-it.nl | ‚úÖ Pass |


**Tag**: `CIS.M365.1.3.1` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisPasswordExpiry.Tests.ps1`

---

### ‚úÖ CIS.M365.1.3.3: Ensure 'External sharing' of calendars is not available

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

1.3.3 (L2) Ensure 'External sharing' of calendars is not available

Attackers often spend time learning about organizations before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.

#### Remediation action:

To remediate using the UI:
1. Navigate to Microsoft 365 admin center [https://admin.microsoft.com](https://admin.microsoft.com).
2. Click to expand **Settings** select **Org settings**.
3. In the **Services** section click **Calendar**.
4. Uncheck **Let your users share their calendars with people outside of
your organization who have Office 365 or Exchange**.
5. Click **Save**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 52](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant does not allow uncontrolled calendar sharing.

| Policy Name | Test Result |
| --- | --- |
| [Default Sharing Policy](https://admin.exchange.microsoft.com/#/individualsharing/:/individualsharingdetails/1807e6c0-7d05-4f28-9c86-253f70a57115/managedomain) | ‚úÖ Pass |


**Tag**: `CIS.M365.1.3.3` `L2` `CIS E3 Level 2` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisCalendarSharing.Tests.ps1`

---

### ‚ùå CIS.M365.1.3.6: Ensure the customer lockbox feature is enabled

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

1.3.6 (L2) Ensure the customer lockbox feature is enabled

Customer Lockbox is a security feature that provides an additional layer of control and transparency to customer data in Microsoft 365. Enabling this feature protects organizational data against data spillage and exfiltration.

Test implementation checks Exchange Online service only.

#### Remediation action:

To enable the Customer Lockbox feature:
1. Navigate to Microsoft 365 admin center [https://admin.microsoft.com](https://admin.microsoft.com).
2. Click to expand **Settings** then select **Org settings**.
3. Select **Security & privacy** tab.
4. Click **Customer lockbox**.
5. Check the box **Require approval for all data access requests**.
6. Click **Save**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 60](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Your tenant does not have the customer lockbox enabled:

| Customer Lockbox |
| --- |
| ‚ùå Fail |


**Tag**: `CIS.M365.1.3.6` `L2` `CIS E5 Level 2` `CIS E5` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisCustomerLockBox.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.1: Ensure Safe Links for Office Applications is Enabled (Only Checks Priority 0 Policy)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.1 (L2) Ensure Safe Links for Office Applications is Enabled

Safe Links for Office applications extends phishing protection to documents and emails that contain hyperlinks, even after they have been delivered to a user.

#### Remediation action:

To create a Safe Links policy:

1. Navigate to Microsoft 365 admin center [https://admin.microsoft.com](https://admin.microsoft.com).
2. Under **Email & collaboration** select **Policies & rules**
3. Select **Threat policies** then **Safe Links**
4. Click on **+Create**
5. Name the policy then click **Next**
6. In Domains select all valid domains for the organization and Next
7. Ensure the following **URL & click protection settings** are defined:

**Email**
* Checked **On: Safe Links checks a list of known, malicious links when users click links in email. URLs are rewritten by default**
* Checked **Apply Safe Links to email messages sent within the organization**
* Checked **Apply real-time URL scanning for suspicious links and links that point to files**
* Checked **Wait for URL scanning to complete before delivering the message**
* Unchecked **Do not rewrite URLs, do checks via Safe Links API only**.

**Teams**
* Checked **On: Safe Links checks a list of known, malicious links when users click links in Microsoft Teams. URLs are not rewritten**.

**Office 365 Apps**
* Checked On: **Safe Links checks a list of known, malicious links when users click links in Microsoft Office apps. URLs are not rewritten**

**Click protection settings**
* Checked: **Track user clicks**
* Unchecked: **Let users click through the original URL**
* There is no recommendation for organization branding
8. Click **Next** twice and finally Submit.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 70](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Safe link policy (Priority 0 policy) matches CIS recommendations (https://security.microsoft.com/presetSecurityPolicies).

| Check Name | Result |
| --- | --- |
| EnableSafeLinksForEmail | ‚úÖ Pass |
| EnableSafeLinksForTeams | ‚úÖ Pass |
| EnableSafeLinksForOffice | ‚úÖ Pass |
| TrackClicks | ‚úÖ Pass |
| AllowClickThrough | ‚úÖ Pass |
| ScanUrls | ‚úÖ Pass |
| EnableForInternalSenders | ‚úÖ Pass |
| DeliverMessageAfterScan | ‚úÖ Pass |
| DisableUrlRewrite | ‚úÖ Pass |


**Tag**: `CIS.M365.2.1.1` `L2` `CIS E5 Level 2` `CIS E5` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisSafeLink.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.11: Ensure comprehensive attachment filtering is applied

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.11 (L2) Ensure comprehensive attachment filtering is applied

**Rationale:**
Blocking known malicious file types can help prevent malware-infested files from infecting a host or performing other malicious attacks such as phishing and data extraction. Defining a comprehensive list of attachments can help protect against additional unknown and known threats.

#### Remediation action:

To implement a new policy containing a comprehensive list of extensions:
1. Connect to Exchange Online using Connect-ExchangeOnline.
2. Run the following script:
```
# Create an attachment policy and associated rule. The rule is
# intentionally disabled allowing the org to enable it when ready
$Policy = @{
    Name = "CIS L2 Attachment Policy"
    EnableFileFilter = $true
    ZapEnabled = $true
    EnableInternalSenderAdminNotifications = $true
    InternalSenderAdminAddress = 'admin@contoso.com' # Change this.
}

$L2Extensions = @(
    "7z", "a3x", "ace", "ade", "adp", "ani", "app", "appinstaller",
    "applescript", "application", "appref-ms", "appx", "appxbundle", "arj",
    "asd", "asx", "bas", "bat", "bgi", "bz2", "cab", "chm", "cmd", "com",
    "cpl", "crt", "cs", "csh", "daa", "dbf", "dcr", "deb",
    "desktopthemepackfile", "dex", "diagcab", "dif", "dir", "dll", "dmg",
    "doc", "docm", "dot", "dotm", "elf", "eml", "exe", "fxp", "gadget", "gz",
    "hlp", "hta", "htc", "htm", "htm", "html", "html", "hwpx", "ics", "img",
    "inf", "ins", "iqy", "iso", "isp", "jar", "jnlp", "js", "jse", "kext",
    "ksh", "lha", "lib", "library-ms", "lnk", "lzh", "macho", "mam", "mda",
    "mdb", "mde", "mdt", "mdw", "mdz", "mht", "mhtml", "mof", "msc", "msi",
    "msix", "msp", "msrcincident", "mst", "ocx", "odt", "ops", "oxps", "pcd",
    "pif", "plg", "pot", "potm", "ppa", "ppam", "ppkg", "pps", "ppsm", "ppt",
    "pptm", "prf", "prg", "ps1", "ps11", "ps11xml", "ps1xml", "ps2",
    "ps2xml", "psc1", "psc2", "pub", "py", "pyc", "pyo", "pyw", "pyz",
    "pyzw", "rar", "reg", "rev", "rtf", "scf", "scpt", "scr", "sct",
    "searchConnector-ms", "service", "settingcontent-ms", "sh", "shb", "shs",
    "shtm", "shtml", "sldm", "slk", "so", "spl", "stm", "svg", "swf", "sys",
    "tar", "theme", "themepack", "timer", "uif", "url", "uue", "vb", "vbe",
    "vbs", "vhd", "vhdx", "vxd", "wbk", "website", "wim", "wiz", "ws", "wsc",
    "wsf", "wsh", "xla", "xlam", "xlc", "xll", "xlm", "xls", "xlsb", "xlsm",
    "xlt", "xltm", "xlw", "xml", "xnk", "xps", "xsl", "xz", "z"
)

# Create the policy
New-MalwareFilterPolicy @Policy -FileTypes $L2Extensions

# Create the rule for all accepted domains
$Rule = @{
    Name = $Policy.Name
    Enabled = $false
    MalwareFilterPolicy = $Policy.Name
    RecipientDomainIs = (Get-AcceptedDomain).Name
    Priority = 0
}

New-MalwareFilterRule @Rule
```
3. When prepared enable the rule either through the UI or PowerShell.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 109](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant covers all CIS recommended file attachment extensions:

| Extension Name | Result |
| --- | --- |


**Tag**: `CIS.M365.2.1.11` `L2` `CIS E3 Level 2` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisAttachmentFilterComprehensive.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.12: Ensure the connection filter IP allow list is not used (Only Checks Default Policy)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.12 (L1) Ensure the connection filter IP allow list is not used

**Rationale:**
Without additional verification like mail flow rules, email from sources in the IP Allow List skips spam filtering and sender authentication (SPF, DKIM, DMARC) checks. This method creates a high risk of attackers successfully delivering email to the Inbox that would otherwise be filtered. Messages that are determined to be malware or high confidence phishing are filtered.

#### Remediation action:

To remove IPs from the allow list:
1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com).
2. Click to expand **Email & collaboration** select **Policies & rules** > **Threat policies**.
3. Under policies select **Anti-spam**.
4. Click on the **Connection filter policy (Default)**.
5. Click **Edit connection filter policy**.
6. Remove any IP entries from **Always allow messages from the following IP addresses or address range:**.
7. Click **Save**.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 113](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. The connection filter IP allow list was empty ‚úÖ

**Tag**: `CIS.M365.2.1.12` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisHostedConnectionFilterPolicy.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.13: Ensure the connection filter safe list is off (Only Checks Default Policy)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.13 (L1) Ensure the connection filter safe list is off

**Rationale:**
Without additional verification like mail flow rules, email from sources in the IP Allow List skips spam filtering and sender authentication (SPF, DKIM, DMARC) checks. This method creates a high risk of attackers successfully delivering email to the Inbox that would otherwise be filtered. Messages that are determined to be malware or high confidence phishing are filtered. The safe list is managed dynamically by Microsoft, and administrators do not have visibility into which sender are included. Incoming messages from email servers on the safe list bypass spam filtering.

#### Remediation action:

To remove IPs from the allow list:
1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com).
2. Click to expand **Email & collaboration** select **Policies & rules** > **Threat policies**.
3. Under policies select **Anti-spam**.
4. Click on the **Connection filter policy (Default)**.
5. Ensure Safe list is Off.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 116](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. The connection filter safe list was not enabled ‚úÖ

**Tag**: `CIS.M365.2.1.13` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisConnectionFilterSafeList.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.2: Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.2 (L1) Ensure the Common Attachment Types Filter is enabled

**Rationale:**
Blocking known malicious file types can help prevent malware-infested files from infecting a host.

#### Remediation action:

To enable the Common Attachment Types Filter:
1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com).
2. Click to expand **Email & collaboration** select **Policies & rules**.
3. On the Policies & rules page select **Threat policies**.
4. Under polices select **Anti-malware** and click on the **Default (Default)** policy.
5. On the Policy page that appears on the right hand pane scroll to the bottom and click on **Edit protection settings**, check the **Enable the common attachments filter**.
6. Click Save.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 74](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenants default malware filter policy has the common attachment file filter enabled (https://security.microsoft.com/presetSecurityPolicies).

| Policy | Result |
| --- | --- |
| EnableFileFilter | ‚úÖ Pass |


**Tag**: `CIS.M365.2.1.2` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisAttachmentFilter.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.3: Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.3 (L1) Ensure notifications for internal users sending malware is Enabled

**Rationale:**
This setting alerts administrators that an internal user sent a message that contained malware. This may indicate an account or machine compromise that would need to be investigated.

#### Remediation action:

To enable notifications for internal users sending malware:
1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com).
2. Click to expand **E-mail & Collaboration** select **Policies & rules**.
3. On the Policies & rules page select **Threat policies**.
4. Under Policies select **Anti-malware**.
5. Click on the **Default (Default)** policy.
6. Click on **Edit protection settings** and change the settings for **Notify an admin about undelivered messages from internal senders** to **On** and enter the email address of the administrator who should be notified under **Administrator email address**.
7. Click Save.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 77](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenants default anti malware policy has recommended internal malware notifications configured (https://security.microsoft.com/antimalwarev2).

| Policy | Result |
| --- | --- |
| EnableInternalSenderAdminNotification | ‚úÖ Pass |
| InternalSenderAdminAddress | ‚úÖ Pass |


**Tag**: `CIS.M365.2.1.3` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisInternalMalwareNotification.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.4: Ensure Safe Attachments policy is enabled (Only Checks Default Policy)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.4 (L2) Ensure Safe Attachments policy is enabled

**Rationale:**
Enabling Safe Attachments policy helps protect against malware threats in email attachments by analyzing suspicious attachments in a secure, cloud-based environment before they are delivered to the user's inbox. This provides an additional layer of security and can prevent new or unseen types of malware from infiltrating the organization's network.

#### Remediation action:

To enable the Safe Attachments policy:
1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com).
2. Click to expand **E-mail & Collaboration** select **Policies & rules**.
3. On the Policies & rules page select **Threat policies**.
4. Under **Policies** select **Safe Attachments**.
5. Click + **Create**.
6. Create a Policy Name and Description, and then click **Next**.
7. Select all valid domains and click Next.
8. Select **Block**.
9. Quarantine policy is **AdminOnlyAccessPolicy**.
10. Leave **Enable redirect** unchecked.
11. Click **Next** and finally **Submit**.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 80](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenants default safe attachments policy matches CIS recommendations (https://security.microsoft.com/safeattachmentv2).

| Check Name | Result |
| --- | --- |
| Enable | ‚úÖ Pass |
| Action | ‚úÖ Pass |
| QuarantineTag | ‚úÖ Pass |


**Tag**: `CIS.M365.2.1.4` `L2` `CIS E5 Level 2` `CIS E5` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisSafeAttachment.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.5: Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.5 (L2) Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled

Description: Safe Attachments for SharePoint, OneDrive, and Microsoft Teams scans these services for malicious files.

#### Remediation action:

To enable Safe Attachments for SharePoint, OneDrive, and Microsoft Teams:

1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com)
2. Under **Email & collaboration** select **Policies & rules**
3. Select **Threat policies** then **Safe Attachments**
4. Click on **Global settings**
5. Click to **Enable Turn on Defender for Office 365 for SharePoint, OneDrive, and Microsoft Teams**
6. Click to **Enable Turn on Safe Documents for Office clients**
7. Click to **Disable Allow people to click through Protected View even if Safe Documents identified the file as malicious**
8. Click **Save**.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 83](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant has Safe Attachments for SharePoint, OneDrive, and Microsoft Teams enabled (https://security.microsoft.com/safeattachmentv2).

| Check Name | Result |
| --- | --- |
| EnableATPForSPOTeamsODB | ‚úÖ Pass |
| EnableSafeDocs | ‚úÖ Pass |
| AllowSafeDocsOpen | ‚úÖ Pass |


**Tag**: `CIS.M365.2.1.5` `L2` `CIS E5 Level 2` `CIS E5` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisSafeAttachmentsAtpPolicy.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.6: Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.6 (L1) Ensure Exchange Online Spam Policies are set to notify administrators

Description: Configure Exchange Online Spam Policies to copy emails and notify someone when a sender in the organization has been blocked for sending spam emails.

#### Remediation action:

To set the Exchange Online Spam Policies:

1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com)
2. Under **Email & collaboration** select **Policies & rules**
3. Select **Threat policies** then **Anti-spam**
4. Click on the **Anti-spam outbound policy (default)**
5. Select **Edit protection settings** then under **Notifications**
6. Check **Send a copy of outbound messages that exceed these limits to these users and groups** then enter the desired email addresses
7. Check **Notify these users and groups if a sender is blocked due to sending outbound spam** then enter the desired email addresses.
8. Click **Save**.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 86](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenants default Exchange Online Spam policy set to notify administrators (https://security.microsoft.com/antispam).

| Check Name | Result |
| --- | --- |
| BccSuspiciousOutboundMail | ‚úÖ Pass |
| NotifyOutboundSpam | ‚úÖ Pass |


**Tag**: `CIS.M365.2.1.6` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisOutboundSpamFilterPolicy.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.7: Ensure that an anti-phishing policy has been created (Only Checks Default Policy)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.7 (L1) Ensure that an anti-phishing policy has been created

Description: Set up anti-phishing polices to increase this protection, for example by refining
settings to better detect and prevent impersonation and spoofing attacks.

#### Remediation action:

To enable Safe Attachments for SharePoint, OneDrive, and Microsoft Teams:

1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com)
2. Under **Email & collaboration** select **Policies & rules**
3. Select **Threat policies** then **Anti-Phishing**
4. Select the **Office365 AntiPhish Default (Default)** policy and click **Edit protection settings**
5. Set the **Phishing email threshold** to at least **2 - Aggressive**.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 91](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenants default anti-phishing policy matches CIS recommendations(https://security.microsoft.com/antiphishing).

| Check Name | Result |
| --- | --- |
| Enabled | ‚úÖ Pass |
| EnableMailboxIntelligenceProtection | ‚úÖ Pass |
| EnableMailboxIntelligence | ‚úÖ Pass |
| EnableSpoofIntelligence | ‚úÖ Pass |
| PhishThresholdLevel | ‚úÖ Pass |


**Tag**: `CIS.M365.2.1.7` `L1` `CIS E5 Level 1` `CIS E5` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisSafeAntiPhishingPolicy.Tests.ps1`

---

### ‚úÖ CIS.M365.2.1.9: Ensure that DKIM is enabled for all Exchange Online Domains

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.1.9 (L1) Ensure that DKIM is enabled for all Exchange Online Domains

Description: DKIM lets an organization add a digital signature to outbound email messages in the message header.

#### Remediation action:

To enable DKIM:

1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com)
2. Under **Email & collaboration** select **Policies & rules** then **Threat policies**
3. Under the **Rules** section click **Email authentication settings**
4. Select **DKIM**
5. Click on each domain and confirm that **Sign messages for this domain with DKIM signatures** is **Enabled**
6. A status of **Not signing DKIM signatures for this domain** is an audit fail.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 98](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant's domains have DKIM configured and valid records exist.

| Domain | Result | Reason |
| --- | --- | --- |
| giraffe-it.cloud | ‚úÖ Pass |  |
| giraffe-it.com | ‚úÖ Pass |  |
| Giraffe-it.eu | ‚úÖ Pass |  |
| Giraffe-it.nl | ‚úÖ Pass |  |
| Giraffeit.onmicrosoft.com | üóÑÔ∏è Skip | Parked domain |


**Tag**: `CIS.M365.2.1.9` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisDkim.Tests.ps1`

---

### ‚úÖ CIS.M365.2.4.4: Ensure Zero-hour auto purge for Microsoft Teams is on (Only Checks ZAP is enabled)

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

2.4.4 (L1) Ensure Zero-hour auto purge for Microsoft Teams is on

**Rationale:**
ZAP is intended to protect users that have received zero-day malware messages or content that is weaponized after being delivered to users. It does this by continually monitoring spam and malware signatures taking automated retroactive  action on messages that have already been delivered.

#### Remediation action:

To enable Zero-hour auto purge for Microsoft Teams:
1. Navigate to Microsoft 365 Defender [https://security.microsoft.com](https://security.microsoft.com)
2. Click to expand **Settings** > **Email & collaboration** > **Microsoft Teams protection**
3. Set **Zero-hour auto purge (ZAP)** to **On (Default)**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 138](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. Your tenant has Zero-hour auto purge (ZAP) enabled for Microsoft Teams:

| Zero-hour auto purge (ZAP) |
| --- |
| ‚úÖ Enabled |


**Tag**: `CIS.M365.2.4.4` `L1` `CIS E5 Level 1` `CIS E5` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisZAP.Tests.ps1`

---

### ‚úÖ CIS.M365.3.1.1: Ensure Microsoft 365 audit log search is Enabled

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

3.1.1 (L1) Ensure Microsoft 365 audit log search is Enabled

**Rationale:**
Enabling audit log search in the Microsoft Purview compliance portal can help organizations improve their security posture, meet regulatory compliance requirements, respond to security incidents, and gain valuable operational insights.

#### Remediation action:

To enable audit log search:
1. Navigate to [Microsoft Purview Audit Search](https://purview.microsoft.com/audit/auditsearch).
2. Select **Audit** to open the audit search.
3. Click **Start recording user and admin activity** next to the information warning at the top.
4. Click **Yes** on the dialog box to confirm.

#### Related links

* [Microsoft 365 Defender](https://security.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 143](https://www.cisecurity.org/benchmark/microsoft_365)
* [Turn auditing on or off | Microsoft Learn](https://learn.microsoft.com/en-us/purview/audit-log-enable-disable)



#### Test Results


Well done. Your tenant has audit log search enabled:

| Audit Log | Status |
| --- | --- |
| Admin Audit Log Settings | ‚úÖ Enabled |


**Tag**: `CIS.M365.3.1.1` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisAuditLogSearch.Tests.ps1`

---

### ‚úÖ CIS.M365.8.1.1: Ensure external file sharing in Teams is enabled for only approved cloud storage services

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

8.1.1 (L2) Ensure external file sharing in Teams is enabled for only approved cloud storage services

This test checks if the third-party cloud services are disabled.
- DropBox
- Box
- Google Drive
- Citrix Files
- Egnyte

Microsoft Teams enables collaboration via file sharing. This file sharing is conducted within Teams, using SharePoint Online, by default; however, third-party cloud services are allowed as well.

Rationale:\
Ensuring that only authorized cloud storage providers are accessible from Teams will help to dissuade the use of non-approved storage providers

#### Remediation action:

To change third-party cloud services using the UI:
1. Navigate to **Microsoft Teams admin center** [https://admin.teams.microsoft.com](https://admin.teams.microsoft.com).
2. Click to expand **Teams** select **Teams settings**.
3. Scroll to **Files**.
4. Set any unauthorized provider to **Off**.

To change third-party cloud services using PowerShell:
1. Connect to Teams using **Connect-MicrosoftTeams**.
2. Run following PowerShell Command:
```
$storageParams = @{
 AllowDropBox = $false
 AllowBox = $false
 AllowGoogleDrive = $false
 AllowShareFile = $false
 AllowEgnyte = $false
}
Set-CsTeamsClientConfiguration @storageParams
```

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [Microsoft Teams Admin Center](https://admin.teams.microsoft.com).
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 369](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. All third-party cloud services are disabled.

| Policy | Value | Status |
| --- | --- | --- |
| AllowDropBox | False | ‚úÖ Pass |
| AllowBox | False | ‚úÖ Pass |
| AllowGoogleDrive | False | ‚úÖ Pass |
| AllowShareFile | False | ‚úÖ Pass |
| AllowEgnyte | False | ‚úÖ Pass |


**Tag**: `Security` `CIS` `CIS M365 v5.0.0` `CIS.M365.8.1.1` `CIS E3 Level 2`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisThirdPartyFileSharing.Tests.ps1`

---

### ‚úÖ CIS.M365.8.2.2: Ensure communication with unmanaged Teams users is disabled

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

8.2.2 (L1) Ensure communication with unmanaged Teams users is disabled & 8.2.3 (L1) Ensure external Teams users cannot initiate conversations

This test checks if the communication with unmanaged Teams users is disabled .

8.2.2 (L1):\
This policy setting controls chats and meetings with external unmanaged Teams users (those not managed by an organization, such as Microsoft Teams (free))

Rationale:\
Allowing users to communicate with unmanaged Teams users presents a potential security threat as little effort is required by threat actors to gain access to a trial or free Microsoft Teams account.

8.2.3 (L1):\
This setting prevents external users who are not managed by an organization from initiating contact with users in the protected organization.
Note: Disabling this setting is used as an additional stop gap for the previous setting which disables communication with unmanaged Teams users entirely. If an organization chooses to have an exception to (L1) Ensure communication with unmanaged Teams users is disabled they can do so while also disabling the ability for the same group of users to initiate contact. Disabling communication entirely will also disable the ability for unmanaged users to initiate contact.

Rationale:\
Allowing users to communicate with unmanaged Teams users presents a potential security threat as little effort is required by threat actors to gain access to a trial or free Microsoft Teams account.

#### Remediation action:

To change communication with unmanaged Teams users using the UI:
1. Navigate to **Microsoft Teams admin center** [https://admin.teams.microsoft.com](https://admin.teams.microsoft.com).
2. Click to expand **Users** select **External access**.
3. Scroll to **Teams accounts not managed by an organization**.
4. Set **People in my organization can communicate with Teams users whose accounts aren't managed by an organization** to **Off**.
5. Uncheck **External users with Teams accounts not managed by an organization can contact users in my organization**.
    - If **People in my organization can communicate with Teams users whose accounts aren't managed by an organization** is already set to **Off** then this setting will not be visible and can be considered to be in a passing state.
6. Click **Save**

To change communication with unmanaged Teams users using PowerShell:
1. Connect to Teams using **Connect-MicrosoftTeams**.
2. Run following PowerShell Command:
```
Set-CsTenantFederationConfiguration -AllowTeamsConsumer $false
Set-CsTenantFederationConfiguration -AllowTeamsConsumerInbound $false
```

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [Microsoft Teams Admin Center](https://admin.teams.microsoft.com).
* [Manage external meetings and chat with people and organizations using Microsoft identities](https://learn.microsoft.com/en-us/microsoftteams/trusted-organizations-external-meetings-chat?tabs=organization-settings)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 378 - 384](https://www.cisecurity.org/benchmark/microsoft_365)
* [CISA MS.TEAMS.2.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/teams.md#msteams22v1)
* [DarkGate malware delivered via Microsoft Teams - detection and response](https://levelblue.com/blogs/security-essentials/darkgate-malware-delivered-via-microsoft-teams-detection-and-response)
* [Midnight Blizzard conducts targeted social engineering over Microsoft Teams](https://www.microsoft.com/en-us/security/blog/2023/08/02/midnight-blizzard-conducts-targeted-social-engineering-over-microsoft-teams/)
* [GIFShell Attack Lets Hackers Create Reverse Shell through Microsoft Teams GIFs](https://www.bitdefender.com/en-us/blog/hotforsecurity/gifshell-attack-lets-hackers-create-reverse-shell-through-microsoft-teams-gifs)



#### Test Results


Well done. Communication with unmanaged Teams users is disabled.

**Tag**: `CIS.M365.8.2.2` `Security` `CIS` `CIS M365 v5.0.0` `CIS E3 Level 1`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisCommunicateWithUnmanagedTeamsUsers.Tests.ps1`

---

### ‚úÖ CIS.M365.8.4.1: Ensure all or a majority of third-party and custom apps are blocked

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

8.4.1 (L1) Ensure app permission policies are configured

This test checks if the usage of third-party and custom apps are disabled.

This policy setting controls which class of apps are available for users to install.

Rationale:\
Allowing users to install third-party or unverified apps poses a potential risk of  introducing malicious software to the environment.

#### Remediation action:

> **NOTE:** Previously, this could be managed from the Permission policies under Teams apps in the Teams admin portal. The Permission policies now redirects you to the Manage Apps page. You can manage apps there now using the `Org-wide app settings` under _Actions_, but it's easier to remediate the recommended settings using PowerShell.

##### PowerShell

To change app permission policies using PowerShell

```powershell
# This cmdlet requires the MicrosoftTeams PowerShell module
# Make sure you're connected to Microsoft Teams using the Connect-MicrosoftTeams cmdlet before executing

## Enable all Microsoft Apps and Disable Third-party and Custom Apps
Set-CsTeamsAppPermissionPolicy -Identity Global -DefaultCatalogAppsType BlockedAppList -DefaultCatalogApps @() -GlobalCatalogAppsType AllowedAppList -GlobalCatalogApps @() -PrivateCatalogAppsType AllowedAppList -PrivateCatalogApps @()
```

##### Microsoft Teams Admin Center

To change app permission policies using the UI:
1. Navigate to **Microsoft Teams admin center** [https://admin.teams.microsoft.com](https://admin.teams.microsoft.com).
2. Click to expand **Teams Apps** [Teams apps | Teams admin center](https://admin.teams.microsoft.com/policies/manage-apps)
3. Under **Actions**, select **Org-wide app settings**
4. For **Microsoft apps** set **Let users install and use available apps by default** to **On** or less permissive.
5. For **Third-party apps** set **Let users install and use available apps by default** to **Off**.
6. For **Custom apps** set **Let users install and use available apps by default** to **Off**.
7. For **Custom apps** set **Let users interact with custom apps in preview** to **Off**.
8. Click **Save**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [Microsoft Teams Admin Center](https://admin.teams.microsoft.com).
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 391](https://www.cisecurity.org/benchmark/microsoft_365)
* [CISA MS.TEAMS.5.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/teams.md#msteams52v1)
* [CISA MS.TEAMS.5.3v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/teams.md#msteams53v1)



#### Test Results


Well done. All or a majority of third-party and custom apps are blocked.

| Policy | Value | Status |
| --- | --- | --- |
| Microsoft apps | Allow all apps | ‚úÖ Pass |
| Third-party apps | Block all apps | ‚úÖ Pass |
| Custom apps | Block all apps | ‚úÖ Pass |


**Tag**: `Security` `CIS` `CIS M365 v5.0.0` `CIS.M365.8.4.1` `CIS E3 Level 1`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisThirdPartyAndCustomApps.Tests.ps1`

---

### ‚ùå CIS.M365.8.5.3: Ensure only people in my org can bypass the lobby

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

8.5.3 (L1) Ensure only people in my org can bypass the lobby

This test checks if the Global (Org-wide default) meeting policy is configured to only bypass the lobby for 'Peoply in my org'.

This policy setting controls who can join a meeting directly and who must wait in the lobby until they're admitted by an organizer, co-organizer, or presenter of the meeting.

Rationale:\
For meetings that could contain sensitive information, it is best to allow the meeting organizer to vet anyone not directly sent an invite before admitting them to the meeting. This will also prevent the anonymous user from using the meeting link to have meetings at unscheduled times.

#### Remediation action:

To change who can bypass the lobby using the UI:
1. Navigate to [Microsoft Teams admin center](https://admin.teams.microsoft.com).
2. Click to expand **Meetings** select **Meeting policies**.
3. Click **Global (Org-wide default)**.
4. Seach for **Meeting join & lobby**.
5. Set **Who can bypass the lobby** to **People in my org**.
6. Click **Save**.

To change who can bypass the lobby using PowerShell:
1. Connect to Teams using **Connect-MicrosoftTeams**.
2. Run following PowerShell Command:
```
Set-CsTeamsMeetingPolicy -Identity Global -AutoAdmittedUsers "EveryoneInCompanyExcludingGuests"
```

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [Microsoft Teams Admin Center](https://admin.teams.microsoft.com).
* [Overview of lobby settings and policies](https://learn.microsoft.com/en-us/microsoftteams/who-can-bypass-meeting-lobby#overview-of-lobby-settings-and-policies)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 400](https://www.cisecurity.org/benchmark/microsoft_365)
* [CISA MS.TEAMS.1.4v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/teams.md#msteams14v1)



#### Test Results


Following people can bypass your lobby: 'InvitedUsers'.

**Tag**: `CIS.M365.8.5.3` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisTeamsLobbyBypass.Tests.ps1`

---

### ‚úÖ CIS.M365.8.6.1: Ensure users can report security concerns in Teams to internal destination

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

8.6.1 (L1) Ensure users can report security concerns in Teams

User reporting settings allow a user to report a message as malicious for further analysis. This recommendation is composed of 3 different settings and all be configured  to pass:
* In the Teams admin center: On by default and controls whether users are able to report messages from Teams. When this setting is turned off, users can't report messages within Teams, so the corresponding setting in the Microsoft 365 Defender portal is irrelevant.
* In the Microsoft 365 Defender portal: On by default for new tenants. Existing tenants need to enable it. If user reporting of messages is turned on in the Teams admin center, it also needs to be turned on the Defender portal for user reported messages to show up correctly on the User reported tab on the Submissions page.
* Defender - Report message destinations: This applies to more than just Microsoft Teams and allows for an organization to keep their reports contained. Due to how the parameters are configured on the backend it is included in this assessment as a requirement.

Rationale:\
Users will be able to more quickly and systematically alert administrators of suspicious malicious messages within Teams. The content of these messages may be sensitive in nature and therefore should be kept within the organization and not shared with Microsoft without first consulting company policy.

Note:\
- The reported message remains visible to the user in the Teams client.
- Users can report the same message multiple times.
- The message sender isn't notified that messages were reported.


#### Remediation action:

To change report security concerns settings using the UI:
1. Navigate to [Microsoft Teams admin center](https://admin.teams.microsoft.com).
2. Click to expand **Messaging** select **Messaging policies**.
3. Click **Global (Org-wide default)**.
4. Set **Report a security concern** to **On**.
5. Next, navigate to [Microsoft 365 Defender](https://security.microsoft.com/)
6. Click on **Settings** > **Email & collaboration** > **User reported settings**.
7. Scroll to **Microsoft Teams**.
8. Check **Monitor reported messages in Microsoft Teams** and **Save**.
9. Set **Send reported messages to:** to **My reporting mailbox only** with reports configured to be sent to authorized staff.

To change who can bypass the lobby using PowerShell:
1. Connect to Teams using **Connect-MicrosoftTeams**.
2. Connecto to ExchangeOnline using **Connect-ExchangeOnline**.
3. To configure the Teams reporting policy run the following PowerShell command:
```
Set-CsTeamsMessagingPolicy -Identity Global -AllowSecurityEndUserReporting $true
```
4. To configure the Defender reporting policy, edit and run following commands:
```
$socmail = "soc@contoso.com" # Change this.
$params = @{
    Identity = "DefaultReportSubmissionPolicy"
    EnableReportToMicrosoft = $false
    ReportChatMessageEnabled = $false
    ReportChatMessageToCustomizedAddressEnabled = $true
    ReportJunkToCustomizedAddress = $true
    ReportNotJunkToCustomizedAddress = $true
    ReportPhishToCustomizedAddress = $true
    ReportJunkAddresses = $socmail
    ReportNotJunkAddresses = $socmail
    ReportPhishAddresses = $socmail
}
Set-ReportSubmissionPolicy @params
New-ReportSubmissionRule -Name DefaultReportSubmissionRule -ReportSubmissionPolicy DefaultReportSubmissionPolicy -SentTo $socmail
```


#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [Microsoft Teams Admin Center](https://admin.teams.microsoft.com).
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 420](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Well done. All report submission policies are configured properly.

| Policy | Value | Status |
| --- | --- | --- |
| AllowSecurityEndUserReporting | True | ‚úÖ Pass |
| ReportJunkToCustomizedAddress | True | ‚úÖ Pass |
| ReportNotJunkToCustomizedAddress | True | ‚úÖ Pass |
| ReportPhishToCustomizedAddress | True | ‚úÖ Pass |
| ReportJunkAddresses | sander.breijer@giraffe-it.com | ‚úÖ Pass |
| ReportNotJunkAddresses | sander.breijer@giraffe-it.com | ‚úÖ Pass |
| ReportPhishAddresses | sander.breijer@giraffe-it.com | ‚úÖ Pass |
| ReportChatMessageEnabled | False | ‚úÖ Pass |
| ReportChatMessageToCustomizedAddressEnabled | True | ‚úÖ Pass |


**Tag**: `CIS.M365.8.6.1` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisTeamsReportSecurityConcerns.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.1.1: Legacy authentication SHALL be blocked.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Legacy authentication SHALL be blocked.

Rationale: The security risk of allowing legacy authentication protocols is they do not support MFA. Blocking legacy protocols reduces the impact of user credential theft.

#### Remediation action:

Follow the guide below to create a conditional access policy that blocks legacy authentication.

- [Block legacy authentication - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-block-legacy#create-a-conditional-access-policy)

#### Related links

- [CISA Legacy Authentication - MS.AAD.1.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#1-legacy-authentication)
- [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L47)



#### Test Results


Your tenant has one or more policies that block legacy authentication:

  - [Block Legacy Authentication](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/b0fc2034-ddf6-4758-bd7e-fa8f91bd1c12)



**Tag**: `MS.AAD` `MS.AAD.1.1` `CISA` `CISA.MS.AAD.1.1` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaBlockLegacyAuth.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.2.1: Users detected as high risk SHALL be blocked.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Users detected as high risk SHALL be blocked.

Rationale: Blocking high-risk users may prevent compromised accounts from accessing the tenant. This prevents compromised accounts from accessing the tenant.

#### Remediation action:

Create a conditional access policy blocking users categorized as high risk by the Identity Protection service. Configure the following policy settings in the new conditional access policy as per the values below:

* Users > Include > **All users**
* Target resources > Cloud apps > **All cloud apps**
* Conditions > User risk > **High**
* Access controls > Grant > **Block Access**

Note: While CISA recommends blocking, the [Microsoft recommendation](https://learn.microsoft.com/entra/id-protection/howto-identity-protection-configure-risk-policies#microsofts-recommendation) is to require multi-factor authentication for high-risk users.

#### Related links

* [CISA Risk Based Policies - MS.AAD.2.1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad21v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L85)



#### Test Results


Your tenant does not have any conditional access policies that block high risk users.


**Tag**: `MS.AAD` `MS.AAD.2.1` `CISA.MS.AAD.2.1` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaBlockHighRiskUsers.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

A notification SHOULD be sent to the administrator when high-risk users are detected.

Rationale: Notification enables the admin to monitor the event and remediate the risk. This helps the organization proactively respond to cyber intrusions as they occur.

#### Remediation action:

Follow the guide below to configure Entra ID Protection to send a regularly monitored security mailbox email notification when user accounts are determined to be high risk.

- [Configure Entra Identity Protection Notifications - Microsoft Learn](https://learn.microsoft.com/entra/id-protection/howto-identity-protection-configure-notifications#configure-users-at-risk-detected-alerts)

#### Related links

- [CISA Risk Based Policies - MS.AAD.2.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad22v1)
- [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L122)



#### Test Results


Well done. Your tenant has one or more recipients for notifications of risky user logins:

  - [ADM Jesse Mulder | Giraffe IT](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/IdentityProtectionMenuBlade/~/UsersAtRiskAlerts/fromNav/Identity)



**Tag**: `MS.AAD` `MS.AAD.2.2` `CISA.MS.AAD.2.2` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaNotifyHighRiskUsers.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Sign-ins detected as high risk SHALL be blocked.

Rationale: Blocking high-risk sign ins may prevent compromised sign-ins from accessing the tenant. This prevents compromised sign-ins from accessing the tenant.

#### Remediation action:

Create a Conditional Access policy blocking sign-ins determined high risk by the Identity Protection service. Configure the following policy settings in the new Conditional Access policy as per the values below:

* Users > Include > **All users**
* Target resources > Cloud apps > **All cloud apps**
* Conditions > Sign-in risk > **High**
* Access controls > Grant > **Block Access**

Note: While CISA recommends blocking, the [Microsoft recommendation](https://learn.microsoft.com/entra/id-protection/howto-identity-protection-configure-risk-policies#microsofts-recommendation) is to require multi-factor authentication for high-risk sign-ins.

#### Related links

* [CISA Risk Based Policies - MS.AAD.2.3](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad23v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L138)



#### Test Results


Well done. Your tenant has one or more policies that block high risk sign-ins.

| Criteria | Count of Policies |
| --- | --- |
| Enabled | 5 |
| Enabled & Blocking | 3 |
| Enabled, Blocking, & All Apps | 3 |
| Enabled, Blocking, All Apps, & Sign In Risk High | 1 |
| Enabled, Blocking, All Apps, Sign In Risk High, & All Users | 1 |




**Tag**: `MS.AAD` `MS.AAD.2.3` `CISA.MS.AAD.2.3` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaBlockHighRiskSignIns.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Phishing-resistant MFA SHALL be enforced for all users.

Rationale: Weaker forms of MFA do not protect against sophisticated phishing attacks. By enforcing methods resistant to phishing, those risks are minimized.

#### Remediation action:

Create a conditional access policy enforcing phishing-resistant MFA for all users. Configure the following policy settings in the new conditional access policy, per the values below:

* Users > Include > **All users**
* Target resources > Cloud apps > **All cloud apps**
* Access controls > Grant > Grant Access > Require authentication strength > **Phishing-resistant MFA**

#### Related links

* [CISA Strong Authentication & Secure Registration - MS.AAD.3.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad31v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L181)



#### Test Results


Your tenant does not have any conditional access policies that require Phishing Resistant Authentication Strengths.


**Tag**: `MS.AAD` `MS.AAD.3.1` `CISA.MS.AAD.3.1` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaPhishResistant.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users.

Rationale: This is a stopgap security policy to help protect the tenant if phishing-resistant MFA has not been enforced. This policy requires MFA enforcement, thus reducing single-form authentication risk.

#### Remediation action:

If phishing-resistant MFA has not been enforced for all users yet, create a conditional access policy that enforces MFA but does not dictate MFA method. Configure the following policy settings in the new conditional access policy, per the values below:

* Users > Include > **All users**
* Target resources > Cloud apps > **All cloud apps**
* Access controls > Grant > Grant Access > **Require multifactor authentication**

#### Related links

* [CISA Strong Authentication & Secure Registration - MS.AAD.3.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad32v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L214)



#### Test Results


Well done. Your tenant has one or more policies that require MFA:

  - [Require multifactor authentication for all users](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/0393c270-05f4-4a19-9237-ab113ea01786)



**Tag**: `MS.AAD` `MS.AAD.3.2` `CISA.MS.AAD.3.2` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaMfa.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.3.3: If Microsoft Authenticator is enabled, it SHALL be configured to show login context information.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

If Microsoft Authenticator is enabled, it SHALL be configured to show login context information.

Rationale: This policy helps protect the tenant when Microsoft Authenticator is used by showing user context information, which helps reduce MFA phishing compromises.

#### Remediation action:

If Microsoft Authenticator is in use, configure Authenticator to display context information to users when they log in.

1. In Entra ID, click Security > [Authentication Methods](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods/fromNav/Identity) > **Microsoft Authenticator**.
2. Click the **Configure tab**.
3. For **Allow use of Microsoft Authenticator OTP** select **No**.
4. Under Show application name in push and passwordless notifications select Status > **Enabled** and Target > Include > **All users**.
5. Under Show geographic location in push and passwordless notifications select Status > **Enabled** and Target > Include > **All users**.
6. Select **Save**.

#### Related links

* [CISA Strong Authentication & Secure Registration - MS.AAD.3.3v2](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad33v2)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L254)



#### Test Results


Your tenant does not have the [Authentication Methods](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods/fromNav/Identity) policy for Microsoft Authenticator set appropriately or migration to Authentication Methods is not complete.

| Setting | Result |
| --- | --- |
| Microsoft Authenticator state | ‚úÖ Pass |
| Included Targets | ‚úÖ Pass |
| Allow use of Microsoft Authenticator OTP set to *No* | ‚ùå Fail |
| Show application name in push and passwordless notifications status | ‚úÖ Pass | 
| Show application name in push and passwordless notifications included target | ‚úÖ Pass | 
| Show geographic location in push and passwordless notifications status | ‚úÖ Pass | 
| Show geographic location in push and passwordless notifications included target | ‚úÖ Pass | 



**Tag**: `MS.AAD` `MS.AAD.3.3` `CISA.MS.AAD.3.3` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaAuthenticatorContext.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The Authentication Methods Manage Migration feature SHALL be set to Migration Complete.

Rationale: To disable the legacy authentication methods screen for the tenant, configure the Manage Migration feature to Migration Complete. The MFA and Self-Service Password Reset (SSPR) authentication methods are both managed from a central admin page, thereby reducing administrative complexity and potential security misconfigurations.

#### Remediation action:

If phishing-resistant MFA has not been enforced for all users yet, create a conditional access policy that enforces MFA but does not dictate MFA method. Configure the following policy settings in the new conditional access policy, per the values below:

1. Go through the process of [migrating from the legacy Azure AD MFA and Self-Service Password Reset (SSPR) administration pages to the new unified Authentication Methods policy page](https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-authentication-methods-manage).
2. Once ready to finish the migration, [set the **Manage Migration** option to **Migration Complete**](https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-authentication-methods-manage#finish-the-migration).

#### Related links

* [CISA Strong Authentication & Secure Registration - MS.AAD.3.4v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad34v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L284)



#### Test Results


Well done. Your tenant has completed the migration to Authentication Methods.


**Tag**: `MS.AAD` `MS.AAD.3.4` `CISA.MS.AAD.3.4` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaMethodsMigration.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled.

Rationale: SMS, voice call, and email OTP are the weakest authenticators. This policy forces users to use stronger MFA methods.

#### Remediation action:

If phishing-resistant MFA has not been deployed yet and Microsoft Authenticator is in use, configure Authenticator to display context information to users when they log in.

1. In **Entra ID**, click **Security** > **[Authentication methods](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods/fromNav/Identity)**
2. Click on the **SMS**, **Voice Call**, and **Email OTP** authentication methods and disable each of them. Their statuses should be **Enabled** > **No** on the **Authentication methods** > **Policies** page.

#### Related links

* [Entra admin portal - Authentication methods](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods/fromNav/Identity)
* [CISA Strong Authentication & Secure Registration - MS.AAD.3.5v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad35v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L307)



#### Test Results


Well done. All weak authentication methods are disabled in your tenant.

| Authentication Method | State | Test Result |
| --- | --- | --- |
| [Sms](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods) | disabled | ‚úÖ Pass |
| [Voice](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods) | disabled | ‚úÖ Pass |
| [Email](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods) | disabled | ‚úÖ Pass |



**Tag**: `MS.AAD` `MS.AAD.3.5` `CISA.MS.AAD.3.5` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaWeakFactor.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Phishing-resistant MFA SHALL be required for highly privileged roles.

Rationale: This is a backup security policy to help protect privileged access to the tenant if the conditional access policy, which requires MFA for all users, is disabled or misconfigured.

#### Remediation action:

Create a conditional access policy enforcing phishing-resistant MFA for highly privileged roles. Configure the following policy settings in the new conditional access policy, per the values below:

1. In **Entra** under **Protection** and **Conditional Access**, select **[Policies](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies/fromNav/)**.
2. Click on **New policy**
3. Under **New Conditional Access policy**, configure the following policy settings in the new conditional access policy, per the values below:
    * Users > Include > Select users and groups > Directory roles > select each of the roles listed in the **[Highly Privileged Roles](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#highly-privileged-roles)** listed.
    * Target resources > Cloud apps > **All cloud apps**
    * Access controls > Grant > Grant Access > Require authentication strength > **Phishing-resistant MFA**
4. Click **Save**.

#### Related links

* [Entra admin center - Conditional Access | Policies](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies/fromNav/)
* [CISA Strong Authentication & Secure Registration - MS.AAD.3.6v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad36v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L354)
* [CISA ScubaGear Highly Privileged Roles](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#highly-privileged-roles)



#### Test Results


Your tenant does not have any conditional access policies that require phishing resistant MFA for highly privileged users.


**Tag**: `MS.AAD` `MS.AAD.3.6` `CISA.MS.AAD.3.6` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaPrivilegedPhishResistant.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.3.7: Managed devices SHOULD be required for authentication.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Managed devices SHOULD be required for authentication.

Rationale: The security risk of an adversary authenticating to the tenant from their own device is reduced by requiring a managed device to authenticate. Managed devices are under the provisioning and control of the agency. [OMB-22-09](https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf) states, "When authorizing users to access resources, agencies must consider at least one device-level signal alongside identity information about the authenticated user."

#### Remediation action:

Create a conditional access policy requiring a user's device to be either Microsoft Entra hybrid joined or compliant during authentication. Configure the following policy settings in the new conditional access policy, per the values below:

1. In **Entra** under **Protection** and **Conditional Access**, select **[Policies](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies/fromNav/)**.
2. Click on **New policy**
3. Under **New Conditional Access policy**, configure the following policy settings in the new conditional access policy, per the values below:
    * Users > Include > **All users**
    * Target resources > Cloud apps > **All cloud apps**
    * Access controls > Grant > Grant Access > **Require device to be marked as compliant** and **Require Microsoft Entra hybrid joined device** > For multiple controls > **Require one of the selected controls**
4. Click **Save**.

#### Related links

* [Entra admin center - Conditional Access | Policies](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies/fromNav/)
* [CISA Strong Authentication & Secure Registration - MS.AAD.3.7v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad37v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L397)



#### Test Results


Your tenant does not have any conditional access policies that require managed devices.


**Tag**: `MS.AAD` `MS.AAD.3.7` `CISA.MS.AAD.3.7` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaManagedDevice.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.3.8: Managed Devices SHOULD be required to register MFA.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Managed Devices SHOULD be required to register MFA.

Rationale: Reduce risk of an adversary using stolen user credentials and then registering their own MFA device to access the tenant by requiring a managed device provisioned and controlled by the agency to perform registration actions. This prevents the adversary from using their own unmanaged device to perform the registration.

#### Remediation action:

Create a conditional access policy requiring a user to be on a managed device when registering for MFA.

1. In **Entra** under **Protection** and **Conditional Access**, select **[Policies](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies/fromNav/)**.
2. Click on **New policy**
3. Under **New Conditional Access policy**, configure the following policy settings in the new conditional access policy, per the values below:
    * Users > Include > **All users**
    * Target resources > User actions > **Register security information**
    * Access controls > Grant > Grant Access > **Require device to be marked as compliant** and **Require Microsoft Entra hybrid joined device** > For multiple controls > **Require one of the selected controls**
4. Click **Save**.

#### Related links

* [Entra admin center - Conditional Access | Policies](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies/fromNav/)
* [CISA Strong Authentication & Secure Registration - MS.AAD.3.8v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad38v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L431)



#### Test Results


Your tenant does not have any conditional access policies that require managed devices for registration.


**Tag**: `MS.AAD` `MS.AAD.3.8` `CISA.MS.AAD.3.8` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaManagedDeviceRegistration.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.4.1: Security logs SHALL be sent to the agency's security operations center for monitoring.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Security logs SHALL be sent to the agency's security operations center for monitoring.

Rationale: The security risk of not having visibility into cyber attacks is reduced by collecting logs in the agency‚Äôs centralized security detection infrastructure. This makes security events available for auditing, query, and incident response.

Note: The following logs (configured in Entra diagnostic settings), are required: `AuditLogs`, `SignInLogs`, `RiskyUsers`, `UserRiskEvents`, `NonInteractiveUserSignInLogs`, `ServicePrincipalSignInLogs`, `ADFSSignInLogs`, `RiskyServicePrincipals`, `ServicePrincipalRiskEvents`, `EnrichedOffice365AuditLogs`, `MicrosoftGraphActivityLogs`. If managed identities are used for Azure resources, also send the `ManagedIdentitySignInLogs` log type. If the Entra ID Provisioning Service is used to provision users to software-as-a-service (SaaS) apps or other systems, also send the `ProvisioningLogs` log type.

Note: Agencies can benefit from security detection capabilities offered by the CISA Cloud Log Aggregation Warehouse (CLAW) system. Agencies are urged to send the logs to CLAW. Contact CISA at cyberliason@cisa.dhs.gov to request integration instructions.

#### Remediation action:

Follow the configuration instructions unique to the products and integration patterns at your organization to send the security logs to the security operations center for monitoring.

#### Related links

* [CISA 4. Centralized Log Collection - MS.AAD.4.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad41v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L523)



#### Test Results


Your tenant does not have [diagnostic settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/DiagnosticSettingsMenuBlade/~/General) configured for all logs:

| Log Name | Result |
| --- | --- |
| ADFSSignInLogs | ‚ùå Fail |
| AuditLogs | ‚ùå Fail |
| AzureADGraphActivityLogs | ‚ùî Optional |
| B2CRequestLogs | ‚ùî Optional |
| EnrichedOffice365AuditLogs | ‚ùå Fail |
| ManagedIdentitySignInLogs | ‚ùå Fail |
| MicrosoftGraphActivityLogs | ‚ùå Fail |
| MicrosoftServicePrincipalSignInLogs | ‚ùî Optional |
| NetworkAccessAlerts | ‚ùî Optional |
| NetworkAccessConnectionEvents | ‚ùî Optional |
| NetworkAccessGenerativeAIInsights | ‚ùî Optional |
| NetworkAccessTrafficLogs | ‚ùî Optional |
| NonInteractiveUserSignInLogs | ‚ùå Fail |
| ProvisioningLogs | ‚ùî Optional |
| RemoteNetworkHealthLogs | ‚ùî Optional |
| RiskyServicePrincipals | ‚ùå Fail |
| RiskyUsers | ‚ùå Fail |
| ServicePrincipalRiskEvents | ‚ùå Fail |
| ServicePrincipalSignInLogs | ‚ùå Fail |
| SignInLogs | ‚ùå Fail |
| UserRiskEvents | ‚ùå Fail |



**Tag**: `MS.AAD` `MS.AAD.4.1` `CISA.MS.AAD.4.1` `CISA` `Security` `Entra ID P1`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaDiagnosticSettings.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.5.1: Only administrators SHALL be allowed to register applications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Only administrators SHALL be allowed to register applications.

Rationale: Application access for the tenant presents a heightened security risk compared to interactive user access because applications are typically not subject to critical security protections, such as MFA policies. Reduce risk of unauthorized users installing malicious applications into the tenant by ensuring that only specific privileged users can register applications.

#### Remediation action:

1. In **Entra**, under **Identity** and **Users**, select **[User settings](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/UserSettings)**.
2. For **Users can register applications**, select **No**.
3. Click **Save**.

#### Related links

* [Entra admin center - User settings](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/UserSettings)
* [CISA Application Registration & Consent - MS.AAD.5.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad51v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L542)



#### Test Results


Well done. **[Users can register applications](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/UserSettings)** is set to **No** in your tenant.


**Tag**: `MS.AAD` `MS.AAD.5.1` `CISA.MS.AAD.5.1` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaAppRegistration.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Only administrators SHALL be allowed to consent to applications.

Rationale: Limiting applications consent to only specific privileged users reduces risk of users giving insecure applications access to their data via [consent grant attacks](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-illicit-consent-grants?view=o365-worldwide).

#### Remediation action:

1. In **Entra** under **Identity** and **Applications**, select **Enterprise applications**.
2. Under **Security**, select **Consent and permissions**.
3. Under **Manage**, select **[User consent settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings)**.
4. Under **User consent for applications**, select **Do not allow user consent**.
5. Click **Save**.

#### Related links

* [Entra admin center - Consent and permissions | User consent settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings)
* [CISA Application Registration & Consent - MS.AAD.5.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad52v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L575)



#### Test Results


Well done. **[User consent for applications](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings)** is set to **Do not allow user consent** in your tenant.


**Tag**: `MS.AAD` `MS.AAD.5.2` `CISA.MS.AAD.5.2` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaAppUserConsent.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.5.3: An admin consent workflow SHALL be configured for applications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

An admin consent workflow SHALL be configured for applications.

Rationale: Configuring an admin consent workflow reduces the risk of the previous policy by setting up a process for users to securely request access to applications necessary for business purposes. Administrators have the opportunity to review the permissions requested by new applications and approve or deny access based on a risk assessment.

#### Remediation action:

1. In **Entra** create a new **Group** that contains admin users responsible for reviewing and adjudicating application consent requests. Group members will be notified when users request consent for new applications.
2. Then in **Entra** under **Identity** and **Applications**, select **Enterprise applications**.
3. Under **Security**, select **Consent and permissions**.
3. Under **Manage**, select **[Admin consent settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/AdminConsentSettings)**.
5. Under **Admin consent requests** and **Users can request admin consent to apps they are unable to consent to** select **Yes**.
6. Under **Who can review admin consent requests**, select **+ Add groups** and select the **group** responsible for reviewing and adjudicating app requests **(created in step one above)**.
7. Click **Save**.

#### Related links

* [Entra admin center - Consent and permissions | Admin consent settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/AdminConsentSettings)
* [CISA Application Registration & Consent - MS.AAD.5.3v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad53v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L613)



#### Test Results


Well done. Your tenant admin consent request policy has at least 1 reviewer.


**Tag**: `MS.AAD` `MS.AAD.5.3` `CISA.MS.AAD.5.3` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaAppAdminConsent.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.6.1: User passwords SHALL NOT expire.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

User passwords SHALL NOT expire.

The National Institute of Standards and Technology (NIST), OMB, and Microsoft have published guidance indicating mandated periodic password changes make user accounts less secure. For example, OMB-22-09 states, "Password policies must not require use of special characters or regular rotation."

#### Remediation action:

Configure password policies to set passwords to never expire.
1. In **[Microsoft 365 admin center](https://admin.cloud.microsoft/)** under **Settings** and **Org settings**, select the tab **Security & privacy**.
2. Under **[Password expiration policy](https://admin.cloud.microsoft/?#/Settings/SecurityPrivacy/:/Settings/L1/PasswordPolicy)**, set **Set passwords to never expire**.
3. Click **Save**.

#### Related links

* [Microsoft 365 admin center - Org settings | Password expiration policy](https://admin.cloud.microsoft/?#/Settings/SecurityPrivacy/:/Settings/L1/PasswordPolicy)
* [Configure the **Password expiration policy** ](https://learn.microsoft.com/en-us/microsoft-365/admin/manage/set-password-expiration-policy?view=o365-worldwide#set-password-expiration-policy)
* [CISA Passwords - MS.AAD.6.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad61v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L723)



#### Test Results


Well done. Your tenant password expiration policy is set to never expire.

| Domain (Default) | Verified | Type | Validation |
| --- | --- | --- | --- |
| Giraffeit.onmicrosoft.com () | Verified | Managed | ‚úÖ Pass |
| giraffe-it.com (‚úîÔ∏è) | Verified | Managed | ‚úÖ Pass |
| giraffe-it.cloud () | Verified | Managed | ‚úÖ Pass |
| Giraffe-it.eu () | Verified | Managed | ‚úÖ Pass |
| Giraffe-it.nl () | Verified | Managed | ‚úÖ Pass |



**Tag**: `MS.AAD` `MS.AAD.6.1` `CISA.MS.AAD.6.1` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaPasswordExpiration.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Permanent active role assignments SHALL NOT be allowed for highly privileged roles.

Rationale: Instead of giving users permanent assignments to privileged roles, provisioning access just in time lessens exposure if those accounts become compromised. In Azure AD PIM or an alternative PAM system, just in time access can be provisioned by assigning users to roles as eligible instead of perpetually active.

Note: Exceptions to this policy are:
* **Emergency access** accounts that need **perpetual access** to the tenant in the rare event of system degradation or other scenarios.
* Some types of **service accounts** that require a user account with privileged roles; since these accounts are used by software programs, they **cannot** perform role activation.

#### Remediation action:

1. In **Entra admin center** select **Show more** and **Roles & Admins** and then **[All roles](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RolesManagementMenuBlade/~/AllRoles)**.

    Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.

2. Select the **Global administrator** role.
3. Under **Manage**, select **Assignments** and click the **Active assignments** tab.
4. Verify there are no users or groups with a value of **Permanent** in the **End time** column. If there are any, recreate those assignments to have an expiration date using Entra ID PIM or an alternative PAM system. If a group is identified and it is enrolled in PIM for Groups, see the exception cases below for details.

#### Related links

* [Entra admin center - Roles and administrators | All roles](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RolesManagementMenuBlade/~/AllRoles)
* [CISA 7.4 Highly Privileged User Access - MS.AAD.7.4v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad74v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L856)



#### Test Results


Your tenant has active assignments without expiration to privileged roles.

| Role | Principal Type | Display Name | Status |
| --- | --- | --- | --- |
| Global Administrator | user | ADM Break Glass01 | Giraffe IT | ‚ùå No Expiration |



**Tag**: `MS.AAD` `MS.AAD.7.4` `CISA.MS.AAD.7.4` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaPermanentRoleAssignment.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system.

Rationale: Provisioning users to privileged roles within a PAM system enables enforcement of numerous privileged access policies and monitoring. If privileged users are assigned directly to roles in the M365 admin center or via PowerShell outside of the context of a PAM system, a significant set of critical security capabilities are bypassed.

#### Remediation action:

1. In **Entra admin center** select **Show more** > **Roles & admins** and then select **[All roles](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RolesManagementMenuBlade/~/AllRoles)**.

    Perform the steps below for each highly privileged role. We reference the **Global Administrator** role as an example.

2. Select the **Global administrator** role.
3. Under **Manage**, select **Assignments** and click the **Active assignments** tab.
4. For each user or group listed, examine the value in the Start time column. If it contains a value of -, this indicates the respective user/group was assigned to that role outside of Entra ID PIM. If the role was assigned outside of Entra ID PIM, delete the assignment and recreate it using Entra ID PIM.

#### Related links

* [Entra admin center - Roles and administrators | All roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)
* [CISA 7.5 Highly Privileged User Access - MS.AAD.7.5v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad75v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L907)



#### Test Results


Well done. Your tenant has no unmanaged active role assignments.


**Tag**: `MS.AAD` `MS.AAD.7.5` `CISA.MS.AAD.7.5` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaUnmanagedRoleAssignments.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Activation of the Global Administrator role SHALL require approval.

Rationale: Requiring approval for a user to activate Global Administrator, which provides unfettered access, makes it more challenging for an attacker to compromise the tenant with stolen credentials and it provides visibility of activities indicating a compromise is taking place.

#### Remediation action:

1. In **Entra admin center** select **Identity governance** and **Privileged Identity Management**.
2. Under **Manage**, select **Microsoft Entra roles**.
3. Under **Manage**, select **[Roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)**.
4. Select the **Global Administrator** role in the list.
5. Click **Settings**.
6. Click **Edit**.
7. Select the **Require approval to activate** option.
8. Click **Update**.
9. Review the list of groups that are actively assigned to the **Global Administrator** role. If any of the groups are enrolled in PIM for Groups, then also apply the same configurations under step 2 above to each PIM group's Member settings.

#### Related links

* [Entra admin center - Privileged Identity Management | Microsoft Entra roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)
* [CISA 7.6 Highly Privileged User Access - MS.AAD.7.6v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad76v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L938)



#### Test Results


Your tenant does not require approval for the activation of the Global Administrator role


**Tag**: `MS.AAD` `MS.AAD.7.6` `CISA.MS.AAD.7.6` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaRequireActivationApproval.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Eligible and Active highly privileged role assignments SHALL trigger an alert.

Rationale: Closely monitor assignment of the highest privileged roles for signs of compromise. Send assignment alerts to enable the security monitoring team to detect compromise attempts.

#### Remediation action:

1. In **Entra admin center** select **Identity governance** and **Privileged Identity Management**.
2. Under **Manage**, select **Microsoft Entra roles**.
3. Under **Manage**, select **[Roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)**.

    Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.

4. Click the **Global Administrator** role.
5. Click **Settings** and then click **Edit**.
6. Click the **Notifications** tab.
7. Under **Send notifications when members are assigned as eligible to this role**, in the **Role assignment alert** > **Additional recipients** textbox, enter the email address of the security monitoring mailbox configured to receive privileged role assignment alerts.
8. Under **Send notifications when members are assigned as active to this role**, in the **Role assignment alert** > **Additional recipients** textbox, enter the email address of the security monitoring mailbox configured to receive privileged role assignment alerts.
9. Click **Update**.
10. For each of the highly privileged roles, if they have any PIM groups actively assigned to them, then also apply the same configurations per the steps above to each PIM group's **Member** settings.

#### Related links

* [Entra admin center - Privileged Identity Management | Microsoft Entra roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)
* [CISA 7.7 Highly Privileged User Access - MS.AAD.7.7v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad77v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L974)



#### Test Results


Your tenant has highly privileged roles without notifications.

| Role | Eligible Notification | Active Notification |
| --- | --- | --- |
| User Administrator | ‚ùå Fail | ‚ùå Fail |
| Exchange Administrator | ‚ùå Fail | ‚ùå Fail |
| SharePoint Administrator | ‚ùå Fail | ‚ùå Fail |
| Application Administrator | ‚ùå Fail | ‚ùå Fail |
| Privileged Role Administrator | ‚ùå Fail | ‚ùå Fail |
| Cloud Application Administrator | ‚ùå Fail | ‚ùå Fail |
| Hybrid Identity Administrator | ‚ùå Fail | ‚ùå Fail |



**Tag**: `MS.AAD` `MS.AAD.7.7` `CISA.MS.AAD.7.7` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaAssignmentNotification.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

User activation of the Global Administrator role SHALL trigger an alert.

Rationale: Closely monitor activation of the Global Administrator role for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts.

User activation of other highly privileged roles SHOULD trigger an alert.

Rationale: Closely monitor activation of high-risk roles for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts. In some environments, activating privileged roles can generate a significant number of alerts.

#### Remediation action:

1. In **Entra admin center** select **Identity governance** and **Privileged Identity Management**.
2. Under **Manage**, select **Microsoft Entra roles**.
3. Under **Manage**, select **[Roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)**.
4. Search and click the **Global Administrator** role.

    For each of the highly privileged roles (other than Global Administrator), follow the same steps but enter a security monitoring mailbox different from the one used to monitor Global Administrator activations.

5. Click **Settings** and then click **Edit**.
6. Click the **Notifications** tab.
7. Under **Send notifications when eligible members activate this role**, in the **Role activation alert** > **Additional recipients** textbox, enter the email address of the security monitoring mailbox configured to receive role activation alerts.
8. Click **Update**.
9. If the role has any PIM groups actively assigned to it, then also apply the same configurations per the steps above to each PIM group's **Member** settings.

#### Related links

* [Entra admin center - Privileged Identity Management | Microsoft Entra roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)
* [CISA 7.8 Highly Privileged User Access - MS.AAD.7.8v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad78v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L1022)
* [CISA 7.9 Highly Privileged User Access - MS.AAD.7.9v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad78v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L1057)



#### Test Results


Well done. Your tenant has notifications for [role activations](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles).

| Role Name | Result |
| --- | --- |
| Global Administrator | ‚úÖ Pass |



**Tag**: `MS.AAD` `MS.AAD.7.8` `CISA.MS.AAD.7.8` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaActivationNotificationGlobalAdmin.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

User activation of the Global Administrator role SHALL trigger an alert.

Rationale: Closely monitor activation of the Global Administrator role for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts.

User activation of other highly privileged roles SHOULD trigger an alert.

Rationale: Closely monitor activation of high-risk roles for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts. In some environments, activating privileged roles can generate a significant number of alerts.

#### Remediation action:

1. In **Entra admin center** select **Identity governance** and **Privileged Identity Management**.
2. Under **Manage**, select **Microsoft Entra roles**.
3. Under **Manage**, select **[Roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)**.
4. Search and click the **Global Administrator** role.

    For each of the highly privileged roles (other than Global Administrator), follow the same steps but enter a security monitoring mailbox different from the one used to monitor Global Administrator activations.

5. Click **Settings** and then click **Edit**.
6. Click the **Notifications** tab.
7. Under **Send notifications when eligible members activate this role**, in the **Role activation alert** > **Additional recipients** textbox, enter the email address of the security monitoring mailbox configured to receive role activation alerts.
8. Click **Update**.
9. If the role has any PIM groups actively assigned to it, then also apply the same configurations per the steps above to each PIM group's **Member** settings.

#### Related links

* [Entra admin center - Privileged Identity Management | Microsoft Entra roles](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles)
* [CISA 7.8 Highly Privileged User Access - MS.AAD.7.8v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad78v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L1022)
* [CISA 7.9 Highly Privileged User Access - MS.AAD.7.9v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad78v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L1057)



#### Test Results


Your tenant does not have notifications on [role activations](https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ResourceMenuBlade/~/roles/resourceId//resourceType/tenant/provider/aadroles).

| Role Name | Result |
| --- | --- |
| User Administrator | ‚ùå Fail |
| Exchange Administrator | ‚ùå Fail |
| SharePoint Administrator | ‚ùå Fail |
| Application Administrator | ‚ùå Fail |
| Privileged Role Administrator | ‚ùå Fail |
| Cloud Application Administrator | ‚ùå Fail |
| Hybrid Identity Administrator | ‚ùå Fail |



**Tag**: `MS.AAD` `MS.AAD.7.9` `CISA.MS.AAD.7.9` `CISA` `Security` `Entra ID P2`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaActivationNotificationOther.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Entra ID directory objects.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Guest users SHOULD have limited or restricted access to Azure AD directory objects.

Rationale: Limiting the amount of object information available to guest users in the tenant, reduces malicious reconnaissance exposure, should a guest account become compromised or be created by an adversary.

#### Remediation action

1. In **Entra ID** and **External Identities**, select **[External collaboration settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/CompanyRelationshipsMenuBlade/~/Settings/menuId/Settings)**.
2. Under **Guest user access**, select either **Guest users have limited access to properties and memberships of directory objects** or **Guest user access is restricted to properties and memberships of their own directory objects (most restrictive)**.
3. Click **Save**.

#### Related links

* [Entra admin center - External Identities | External collaboration settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/CompanyRelationshipsMenuBlade/~/Settings/menuId/Settings)
* [CISA Guest User Access - MS.AAD.8.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad81v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L1100)



#### Test Results


Well done. Guest user access is restricted to properties and memberships of their own directory objects (most restrictive)


**Tag**: `MS.AAD` `MS.AAD.8.1` `CISA.MS.AAD.8.1` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaGuestUserAccess.Tests.ps1`

---

### ‚úÖ CISA.MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Only users with the Guest Inviter role SHOULD be able to invite guest users.

Rationale: By only allowing an authorized group of individuals to invite external users to create accounts in the tenant, an agency can enforce a guest user account approval process, reducing the risk of unauthorized account creation.

#### Remediation action:

1. In **Entra ID** and **External Identities**, select **[External collaboration settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/CompanyRelationshipsMenuBlade/~/Settings/menuId/Settings)**.
2. Under **Guest invite settings**, select **Only users assigned to specific admin roles can invite guest users** or **No one in the organization can invite guest users including admins (most restrictive)**.

3. Click **Save**.

#### Related links

* [Entra admin center - External Identities | External collaboration settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/CompanyRelationshipsMenuBlade/~/Settings/menuId/Settings)
* [CISA Guest User Access - MS.AAD.8.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad82v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L1157)



#### Test Results


Well done. Your tenant restricts who can invite guests:

allowInvitesFrom : adminsAndGuestInviters


**Tag**: `MS.AAD` `MS.AAD.8.2` `CISA.MS.AAD.8.2` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaGuestInvitation.Tests.ps1`

---

### ‚ùå CISA.MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes.

Rationale: Limiting which domains can be invited to create guest accounts in the tenant helps reduce the risk of users from unauthorized external organizations getting access.

> ‚ö†Ô∏è WARNING: This test utilizes a technical mechanism that differs from CISA's, though the outcome is the same.

#### Remediation action:

1. In **Entra admin center** select **External Identities** and **Cross-tenant access settings**.
2. Under **Default settings**, select [**Edit inbound defaults**](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/InboundAccessSettings.ReactView/isDefault~/true/name//id/).
3. Under **B2B collaboration**, and **External users and groups**, ensure **Access status** is set to **Block access**.
4. Under **B2B collaboration**, and **Applications**, ensure **Access status** is set to **Block access**.

> This configuration will **only** allow B2B collaboration with other Entra tenants.

#### Related links

* [Entra admin center - External Identities | Cross-tenant access settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/InboundAccessSettings.ReactView/isDefault~/true/name//id/)
* [CISA 8 Guest User Access - MS.AAD.8.3v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad83v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L1190)



#### Test Results


Your tenant's default cross-tenant inbound access policy is not set to block:

| External Users & Groups | Applications |
| --- | --- |
| ‚ùå Fail | ‚ùå Fail |



**Tag**: `MS.AAD` `MS.AAD.8.3` `CISA` `CISA.MS.AAD.8.3` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaCrossTenantInboundDefault.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.1.1: Automatic forwarding to external domains SHALL be disabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Automatic forwarding to external domains SHALL be disabled.

Rationale: Adversaries can use automatic forwarding to gain persistent access to a victim's email. Disabling forwarding to external domains prevents this technique when the adversary is external to the organization but does not impede legitimate internal forwarding.

#### Remediation action:

To disable automatic forwarding to external domains:

1. Sign in to the **Exchange admin center**.
2. Select **Mail flow**, then **[Remote domains](https://admin.exchange.microsoft.com/#/remotedomains)**.
3. Select **Default**.
4. Under **Email reply types**, select **Edit reply types**.
5. Clear the checkbox next to **Allow automatic forwarding**, then click **Save**.
6. Return to **Remote domains** and repeat steps 4 and 5 for each additional remote domain in the list.

#### Related links

* [Exchange admin center - Remote domains](https://admin.exchange.microsoft.com/#/remotedomains)
* [CISA 1 Automatic Forwarding to External Domains - MS.EXO.1.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo11v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L28)



#### Test Results


Well done. Your tenant has [automatic forwarding](https://admin.exchange.microsoft.com/#/remotedomains) disabled for all domains.

| Name | Domain | Automatic forwarding | Test Result |
| --- | --- | --- | --- |
| [Default](https://admin.exchange.microsoft.com/#/remotedomains) | * | Not allow automatic forwarding | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.1.1` `CISA.MS.EXO.1.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaAutoExternalForwarding.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.10.1: Emails SHALL be scanned for malware.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Emails SHALL be filtered by attachment file types.

Rationale: Malicious attachments often take the form of click-to-run files. Sharing high risk file types, when necessary, is better left to a means other than email; the dangers of allowing them to be sent over email outweigh any potential benefits. Filtering email attachments based on file types can prevent spread of malware distributed via click-to-run email attachments.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [Defender admin center - Order and precedence of email protection](https://learn.microsoft.com/en-us/defender-office-365/how-policies-and-protections-are-combined)
* [CISA 9 Attachment File Type - MS.EXO.9.1v2](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo91v2)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L487)
* [Microsoft Learn - Common attachments filter in anti-malware policies](https://learn.microsoft.com/en-us/defender-office-365/anti-malware-protection-about#common-attachments-filter-in-anti-malware-policies)



#### Test Results


Well done. All the anti-malware policies in your tenant has the common attachments filter enabled (https://security.microsoft.com/antimalwarev2).

| Policy name | Enabled | EnableFileFilter | Extensions | Result |
| --- | --- | --- | --- | --- |
| Strict Preset Security Policy1766584481384 | True | True | ace, apk, app, appx, ani, & 48 others | ‚úÖ Pass |
| Standard Preset Security Policy1765450055055 | True | True | ace, apk, app, appx, ani, & 48 others | ‚úÖ Pass |
| CIS L2 Attachment Policy | True | True | 7z, a3x, ace, ade, adp, & 182 others | ‚úÖ Pass |
| Default | True | True | ace, apk, app, appx, ani, & 48 others | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.10.1` `CISA.MS.EXO.10.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaMalwareScan.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Emails identified as containing malware SHALL be quarantined or dropped.

Rationale: Email can be used as a mechanism for delivering malware. Preventing emails with known malware from reaching user mailboxes helps ensure users cannot interact with those emails.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [Defender admin center - Order and precedence of email protection](https://learn.microsoft.com/en-us/defender-office-365/how-policies-and-protections-are-combined)
* [CISA 10 Malware Scanning - MS.EXO.10.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo102v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L582)
* [Microsoft Learn - Anatomy of a quarantine policy](https://learn.microsoft.com/en-us/defender-office-365/quarantine-policies#anatomy-of-a-quarantine-policy)



#### Test Results


Well done. All the anti-malware policies in your tenant have the property QuarantinePolicy set to 'AdminOnlyAccessPolicy' (https://security.microsoft.com/antimalwarev2).

| Policy name | Enabled | Quarantine Tag | Result |
| --- | --- | --- | --- |
| Strict Preset Security Policy1766584481384 | True | AdminOnlyAccessPolicy | ‚úÖ Pass |
| Standard Preset Security Policy1765450055055 | True | AdminOnlyAccessPolicy | ‚úÖ Pass |
| CIS L2 Attachment Policy | True | AdminOnlyAccessPolicy | ‚úÖ Pass |
| Default | True | AdminOnlyAccessPolicy | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.10.2` `CISA.MS.EXO.10.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaMalwareAction.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Email scanning SHALL be capable of reviewing emails after delivery.

Rationale: As known malware signatures are updated, it is possible for an email to be retroactively identified as containing malware after delivery. By scanning emails, the number of malware-infected in users' mailboxes can be reduced.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [Defender admin center - Order and precedence of email protection](https://learn.microsoft.com/en-us/defender-office-365/how-policies-and-protections-are-combined)
* [CISA 10 Malware Scanning - MS.EXO.10.3v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo103v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L597)
* [Microsoft Learn - Zero-hour auto purge (ZAP) for malware](https://learn.microsoft.com/en-us/defender-office-365/zero-hour-auto-purge#zero-hour-auto-purge-zap-for-email-messages)



#### Test Results


Well done. All the anti-malware policies in your tenant have the property ZapEnabled set to true (https://security.microsoft.com/antimalwarev2).

| Policy name | Enabled | ZapEnabled | Result |
| --- | --- | --- | --- |
| Strict Preset Security Policy1766584481384 | True | True | ‚úÖ Pass |
| Standard Preset Security Policy1765450055055 | True | True | ‚úÖ Pass |
| CIS L2 Attachment Policy | True | True | ‚úÖ Pass |
| Default | True | True | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.10.3` `CISA.MS.EXO.10.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaMalwareZap.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.11.1: Impersonation protection checks SHOULD be used.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Impersonation protection checks SHOULD be used.

Rationale: Users might not be able to reliably identify phishing emails, especially if the `FROM` address is nearly indistinguishable from that of a known entity. By automatically identifying senders who appear to be impersonating known senders, the risk of a successful phishing attempt can be reduced.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 11 Phishing Protections - MS.EXO.11.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo111v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L617)
* [Microsoft Learn - Impersonation settings in anti-phishing policies in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/anti-phishing-policies-about#impersonation-settings-in-anti-phishing-policies-in-microsoft-defender-for-office-365)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies for the common file filter](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Result |
| --- | --- |
| Office365 AntiPhish Default | ‚ùå Fail |
| Standard Preset Security Policy1765450053058 | ‚úÖ Pass |
| Strict Preset Security Policy1766584478696 | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.11.1` `CISA.MS.EXO.11.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaImpersonation.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed.

Rationale: Many tasks are better suited for automated processes, such as identifying unusual characters in the `FROM` address or identifying a first-time sender. User warnings can handle these tasks, reducing the burden on end users and the risk of successful phishing attempts.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 11 Phishing Protections - MS.EXO.11.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo112v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L632)
* [Microsoft Learn - Impersonation settings in anti-phishing policies in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/anti-phishing-policies-about#impersonation-settings-in-anti-phishing-policies-in-microsoft-defender-for-office-365)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies for the common file filter](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Result |
| --- | --- |
| Office365 AntiPhish Default | ‚ùå Fail |
| Standard Preset Security Policy1765450053058 | ‚úÖ Pass |
| Strict Preset Security Policy1766584478696 | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.11.2` `CISA.MS.EXO.11.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaImpersonationTip.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence.

Rationale: Phishing attacks can result in unauthorized data disclosure and unauthorized access. Using AI-based phishing detection tools to improve the detection rate of phishing attempts helps reduce the risk of successful phishing attacks.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 11 Phishing Protections - MS.EXO.11.3v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo113v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L647)
* [Microsoft Learn - Mailbox intelligence impersonation protection](https://learn.microsoft.com/en-us/defender-office-365/anti-phishing-policies-about#mailbox-intelligence-impersonation-protection)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies for the common file filter](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Result |
| --- | --- |
| Office365 AntiPhish Default | ‚úÖ Pass |
| Standard Preset Security Policy1765450053058 | ‚úÖ Pass |
| Strict Preset Security Policy1766584478696 | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.11.3` `CISA.MS.EXO.11.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaMailboxIntelligence.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.12.1: IP allow lists SHOULD NOT be created.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

IP allow lists SHOULD NOT be created.

Rationale: Messages sent from IP addresses on an allow list bypass important security mechanisms, including spam filtering and sender authentication checks. Avoiding use of IP allow lists prevents potential threats from circumventing security mechanisms.

#### Remediation action:

To modify the connection filters, follow the instructions found in Use the Microsoft 365 Defender portal to modify the default connection filter policy.
1. Sign in to **Microsoft 365 Defender portal**.
2. From the left-hand menu, find **Email & collaboration** and select **Policies and Rules**.
3. Select **Threat Policies** from the list of policy names.
4. Under **Policies**, select [**Anti-spam**](https://security.microsoft.com/antispam).
5. Select **Connection filter policy (Default)**.
6. Click **Edit connection filter policy**.
7. Ensure no addresses are specified under **Always allow messages from the following IP addresses or address range**.

#### Related links

* [Defender admin center - Anti-spam policies](https://security.microsoft.com/antispam)
* [CISA 12 IP Allow Lists - MS.EXO.12.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo121v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L683)



#### Test Results


Well done. Your tenant does not have any [Anti-spam IP allow lists](https://security.microsoft.com/antispam).

**Tag**: `MS.EXO` `MS.EXO.12.1` `CISA.MS.EXO.12.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaAntiSpamAllowList.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.12.2: Safe lists SHOULD NOT be enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Safe lists SHOULD NOT be enabled.

Rationale: Messages sent from allowed safe list addresses bypass important security mechanisms, including spam filtering and sender authentication checks. Avoiding use of safe lists prevents potential threats from circumventing security mechanisms. While blocking all malicious senders is not feasible, blocking specific known, malicious IP addresses may reduce the threat from specific senders.

#### Remediation action:

To modify the connection filters, follow the instructions found in Use the Microsoft 365 Defender portal to modify the default connection filter policy.
1. Sign in to **Microsoft 365 Defender portal**.
2. From the left-hand menu, find **Email & collaboration** and select **Policies and Rules**.
3. Select **Threat Policies** from the list of policy names.
4. Under **Policies**, select [**Anti-spam**](https://security.microsoft.com/antispam).
5. Select **Connection filter policy (Default)**.
6. Click **Edit connection filter policy**.
8. Ensure **Turn on safe list** is not selected.

#### Related links

* [Defender admin center - Anti-spam policies](https://security.microsoft.com/antispam)
* [CISA 12 IP Allow Lists - MS.EXO.12.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo122v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L710)



#### Test Results


Well done. [Safe List](https://security.microsoft.com/antispam) is disabled in your tenant.

**Tag**: `MS.EXO` `MS.EXO.12.2` `CISA.MS.EXO.12.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaAntiSpamSafeList.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.13.1: Mailbox auditing SHALL be enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Mailbox auditing SHALL be enabled.

Rationale: Exchange Online user accounts can be compromised or misused. Enabling mailbox auditing provides a valuable source of information to detect and respond to mailbox misuse.

#### Remediation action:

Mailbox auditing can be managed from the [Exchange Online PowerShell module](https://learn.microsoft.com/en-us/microsoft-365/compliance/audit-mailboxes?view=o365-worldwide). Follow the instructions listed on Manage mailbox auditing in Office 365.
1. To enable mailbox auditing by default for your organization via PowerShell:
2. Connect to the Exchange Online PowerShell.
3. Run the following command:
    `Set-OrganizationConfig ‚ÄìAuditDisabled $false`

#### Related links

* [Microsoft Learn - Mailbox Auditing](https://learn.microsoft.com/en-us/microsoft-365/compliance/audit-mailboxes?view=o365-worldwide)
* [CISA 13 Mailbox Auditing - MS.EXO.13.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo131v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L741)



#### Test Results


Well done. Your tenant has mailbox auditing enabled.

‚úÖ Pass

**Tag**: `MS.EXO` `MS.EXO.13.1` `CISA.MS.EXO.13.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaMailboxAuditing.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.14.1: A spam filter SHALL be enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

A spam filter SHALL be enabled.

Rationale: Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Filtering out spam reduces user workload burden, prevents junk mail congestion, and reduces potentially malicious content exposure.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select [**Preset Security Policies**](https://security.microsoft.com/presetSecurityPolicies).
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 14 Inbound Anti-Spam Protections - MS.EXO.14.1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo141v2)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L753)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Spam Action | High Confidence Spam Action | Bulk Spam Action | Phish Spam Action |
| --- | --- | --- | --- | --- |
| Default | MoveToJmf | MoveToJmf | MoveToJmf | MoveToJmf |
| Standard Preset Security Policy1765450053678 | MoveToJmf | Quarantine | MoveToJmf | Quarantine |
| Strict Preset Security Policy1766584479940 | Quarantine | Quarantine | Quarantine | Quarantine |


**Tag**: `MS.EXO` `MS.EXO.14.1` `CISA.MS.EXO.14.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSpamFilter.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder.

Rationale: Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Moving spam messages to a separate junk or quarantine folder helps users filter out spam while still giving them the ability to review messages, as needed, in case a message is filtered incorrectly.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select [**Preset Security Policies**](https://security.microsoft.com/presetSecurityPolicies).
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 14 Inbound Anti-Spam Protections - MS.EXO.14.2](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo142v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L768)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Spam Action | High Confidence Spam Action |
| --- | --- | --- |
| Default | ‚úÖ Pass | ‚úÖ Pass |
| Standard Preset Security Policy1765450053678 | ‚úÖ Pass | ‚úÖ Pass |
| Strict Preset Security Policy1766584479940 | ‚úÖ Pass | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.14.2` `CISA.MS.EXO.14.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSpamAction.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Allowed domains SHALL NOT be added to inbound anti-spam protection policies.

Rationale: Legitimate emails may be incorrectly filtered by spam protections. Adding allowed senders is an acceptable method of combating these false positives. Allowing an entire domain, especially a common domain like office.com, however, provides for a large number of potentially unknown users to bypass spam protections.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select [**Preset Security Policies**](https://security.microsoft.com/presetSecurityPolicies).
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 14 Inbound Anti-Spam Protections - MS.EXO.14.3](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo143v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L783)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Policy Result | Allowed Domains |
| --- | --- | --- |
| Default | ‚úÖ Pass |  |
| Standard Preset Security Policy1765450053678 | ‚úÖ Pass |  |
| Strict Preset Security Policy1766584479940 | ‚úÖ Pass |  |


**Tag**: `MS.EXO` `MS.EXO.14.3` `CISA.MS.EXO.14.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSpamBypass.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

URL comparison with a block-list SHOULD be enabled.

Rationale: Users may be directed to malicious websites via links in email. Blocking access to known, malicious URLs can prevent users from accessing known malicious websites.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under either **Standard protection** or **Strict protection**, select **Manage protection settings**.
6. Select **Next** until you reach the **Apply Defender for Office 365 protection** page.
7. On the **Apply Defender for Office 365 protection** page, select **All recipients**.
8. (Optional) Under **Exclude these recipients**, add **Users** and **Groups** to be exempted from the preset policies.
9. Select **Next** on each page until the **Review and confirm your changes** page.
10. On the **Review and confirm your changes** page, select **Confirm**.

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 15 Link Protection - MS.EXO.15.1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo151v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L813)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Policy Result |
| --- | --- |
| Built-In Protection Policy | ‚úÖ Pass |
| Standard Preset Security Policy1765450057197 | ‚úÖ Pass |
| Strict Preset Security Policy1766584482636 | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.15.1` `CISA.MS.EXO.15.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSafeLink.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.15.2: Direct download links SHOULD be scanned for malware.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Direct download links SHOULD be scanned for malware.

Rationale: URLs in emails may direct users to download and run malware. Scanning direct download links in real-time for known malware and blocking access can prevent users from infecting their devices.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under either **Standard protection** or **Strict protection**, select **Manage protection settings**.
6. Select **Next** until you reach the **Apply Defender for Office 365 protection** page.
7. On the **Apply Defender for Office 365 protection** page, select **All recipients**.
8. (Optional) Under **Exclude these recipients**, add **Users** and **Groups** to be exempted from the preset policies.
9. Select **Next** on each page until the **Review and confirm your changes** page.
10. On the **Review and confirm your changes** page, select **Confirm**.

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 15 Link Protection - MS.EXO.15.2](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo152v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L828)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Policy Result |
| --- | --- |
| Built-In Protection Policy | ‚úÖ Pass |
| Standard Preset Security Policy1765450057197 | ‚úÖ Pass |
| Strict Preset Security Policy1766584482636 | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.15.2` `CISA.MS.EXO.15.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSafeLinkDownloadScan.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.15.3: User click tracking SHOULD be enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

User click tracking SHOULD be enabled.

Rationale: Users may click on malicious links in emails, leading to compromise or unauthorized data disclosure. Enabling user click tracking lets agencies know if a malicious link may have been visited after the fact to help tailor a response to a potential incident.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under either **Standard protection** or **Strict protection**, select **Manage protection settings**.
6. Select **Next** until you reach the **Apply Defender for Office 365 protection** page.
7. On the **Apply Defender for Office 365 protection** page, select **All recipients**.
8. (Optional) Under **Exclude these recipients**, add **Users** and **Groups** to be exempted from the preset policies.
9. Select **Next** on each page until the **Review and confirm your changes** page.
10. On the **Review and confirm your changes** page, select **Confirm**.

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 15 Link Protection - MS.EXO.15.3](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo153v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L843)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | Policy Result |
| --- | --- |
| Built-In Protection Policy | ‚úÖ Pass |
| Standard Preset Security Policy1765450057197 | ‚úÖ Pass |
| Strict Preset Security Policy1766584482636 | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.15.3` `CISA.MS.EXO.15.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSafeLinkClickTracking.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.16.1: Alerts SHALL be enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

At a minimum, the following alerts SHALL be enabled:
- Suspicious email sending patterns detected.
- Suspicious Connector Activity.
- Suspicious Email Forwarding Activity.
- Messages have been delayed.
- Tenant restricted from sending unprovisioned email.
- Tenant restricted from sending email.
- A potentially malicious URL click was detected.

Rationale: Potentially malicious or service impacting events may go undetected without a means of detecting these events. Setting up a mechanism to alert administrators to events listed above draws attention to them to help minimize impact to users and the agency.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. Under **Email & collaboration**, select **Policies & rules**.
3. Select [**Alert Policy**](https://security.microsoft.com/alertpoliciesv2).
4. Select the checkbox next to each alert to enable as determined by the agency and at a minimum those referenced in the [CISA M365 Security Configuration Baseline for Exchange Online](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo161v1) which are:
    - Suspicious email sending patterns detected.
    - Suspicious connector activity.
    - Suspicious Email Forwarding Activity.
    - Messages have been delayed.
    - Tenant restricted from sending unprovisioned email.
    - Tenant restricted from sending email.
    - A potentially malicious URL click was detected.
5. Click the pencil icon from the top menu.
6. Select the **Enable selected policies** action from the **Bulk actions** menu.

#### Related links

* [Defender admin center - Alert policy](https://security.microsoft.com/alertpoliciesv2)
* [CISA 16 Alerts - MS.EXO.16.1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo161v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L863)



#### Test Results


Well done. Your tenant has [alerts configured](https://security.microsoft.com/alertpoliciesv2).

| Alert Name | Alert Result |
| --- | --- |
| Messages have been delayed | ‚úÖ Pass |
| Suspicious Email Forwarding Activity | ‚úÖ Pass |
| Suspicious email sending patterns detected | ‚úÖ Pass |
| Tenant restricted from sending unprovisioned email | ‚úÖ Pass |
| Suspicious connector activity | ‚úÖ Pass |
| Tenant restricted from sending email | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.16.1` `CISA.MS.EXO.16.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaExoAlert.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Microsoft Purview Audit (Standard) logging SHALL be enabled.

Rationale: Responding to incidents without detailed information about activities that took place slows response actions. Enabling Microsoft Purview Audit (Standard) helps ensure agencies have visibility into user actions. Furthermore, Microsoft Purview Audit (Standard) is required for government agencies by OMB M-21-31 (referred to therein by its former name, Unified Audit Logs).

#### Remediation action:

To enable auditing via the Microsoft Purview compliance portal:
1. Sign in to the **Microsoft Purview compliance portal**.
2. Under **Solutions**, select [**Audit**](https://purview.microsoft.com/audit/auditsearch).
3. If auditing is not enabled, a banner is displayed to notify the administrator to start recording user and admin activity.
4. Click the **Start recording user and admin activity**.

#### Related links

* [Purview portal - Audit search](https://purview.microsoft.com/audit/auditsearch)
* [CISA 17 Audit Logging - MS.EXO.17.1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo171v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L898)



#### Test Results


Well done. Your tenant has [unified audit log enabled](https://purview.microsoft.com/audit/auditsearch).

**Tag**: `MS.EXO` `MS.EXO.17.1` `CISA.MS.EXO.17.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaAuditLog.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.2.1: A list of approved IP addresses for sending mail SHALL be maintained.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

A list of approved IP addresses for sending mail SHALL be maintained.

Rationale: Failing to maintain an accurate list of authorized IP addresses may result in spoofed email messages or failure to deliver legitimate messages when SPF is enabled. Maintaining such a list helps ensure that unauthorized servers sending spoofed messages can be detected, and permits message delivery from legitimate senders.

#### Remediation action:

* Identify any approved senders specific to your agency.
* Perform regular review of SPF record and update as necessary.
* Additionally, see [External DNS records required for SPF](https://learn.microsoft.com/en-us/microsoft-365/enterprise/external-domain-name-system-records?view=o365-worldwide#external-dns-records-required-for-spf) for inclusions required for Microsoft to send email on behalf of your domain.

#### Related links

* [Exchange admin center - Accepted domains](https://admin.exchange.microsoft.com/#/accepteddomains)
* [CISA 2 Sender Policy Framework - MS.EXO.2.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo21v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L58)



#### Test Results


Well done. Your tenant's domains have a restricted SPF, review authorized senders for accuracy.

| Domain | Result | Reason | Addresses |
| --- | --- | --- | --- |
| giraffe-it.cloud | ‚úÖ Pass | Last directive is '-all' | 40.92.0.0/15, 40.107.0.0/16, & ...9 addresses |
| giraffe-it.com | ‚úÖ Pass | Last directive is '-all' | 40.92.0.0/15, 40.107.0.0/16, & ...9 addresses |
| Giraffe-it.eu | ‚úÖ Pass | Last directive is '-all' | 40.92.0.0/15, 40.107.0.0/16, & ...9 addresses |
| Giraffe-it.nl | ‚úÖ Pass | Last directive is '-all' | 40.92.0.0/15, 40.107.0.0/16, & ...9 addresses |
| Giraffeit.onmicrosoft.com | ‚úÖ Pass | Last directive is '-all' | 40.92.0.0/15, 40.107.0.0/16, & ...9 addresses |


**Tag**: `MS.EXO` `MS.EXO.2.1` `CISA.MS.EXO.2.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSpfRestriction.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.2.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

An SPF policy SHALL be published for each domain, designating only these addresses as approved senders.

Rationale: An adversary may modify the `FROM` field of an email such that it appears to be a legitimate email sent by an agency, facilitating phishing attacks. Publishing an SPF policy for each agency domain mitigates forged `FROM` fields by providing a means for recipients to detect emails spoofed in this way. SPF is required for FCEB departments and agencies by Binding Operational Directive (BOD) 18-01, "Enhance Email and Web Security".

Coexistence domains related to Hybrid Configuration Wizard (HCW) are skipped.
Production use of coexistence domains is discouraged, and additional controls, such as transport rules, should be used to restrict their use.

#### Remediation action:

SPF is not configured through the Exchange admin center, but rather via DNS records hosted by the agency's domain. Thus, the exact steps needed to set up SPF varies from agency to agency. See [Add or edit an SPF TXT record to help prevent email spam (Outlook, Exchange Online) | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/admin/get-help-with-domains/create-dns-records-at-any-dns-hosting-provider?view=o365-worldwide#add-or-edit-an-spf-txt-record-to-help-prevent-email-spam-outlook-exchange-online) for more details.

To test your SPF configuration, consider using a web-based tool, such as those listed under [How can I validate SPF records for my domain? | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/admin/setup/domains-faq?view=o365-worldwide#how-can-i-validate-spf-records-for-my-domain). Additionally, SPF records can be requested using the PowerShell tool `Resolve-DnsName`. For example:

`Resolve-DnsName example.onmicrosoft.com txt`

If SPF is configured, you will see a response resembling `v=spf1 include:spf.protection.outlook.com -all` returned; though by necessity, the contents of the SPF policy may vary by agency. In this example, the SPF policy indicates the IP addresses listed by the policy for "spf.protection.outlook.com" are the only approved senders for "example.onmicrosoft.com." These IPs can be determined via an additional SPF lookup, this time for "spf.protection.outlook.com." Ensure the IP addresses listed as approved senders for your domain are those identified for MS.EXO.2.1v1. [See SPF TXT record syntax for Microsoft 365 | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-anti-spoofing?view=o365-worldwide#spf-txt-record-syntax-for-microsoft-365) for a more in-depth discussion of SPF record syntax.

#### Related links

* [Exchange admin center - Accepted domains](https://admin.exchange.microsoft.com/#/accepteddomains)
* [CISA 2 Sender Policy Framework - MS.EXO.2.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo22v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L75)



#### Test Results


Well done. Your tenant's domains have at least 1 directives with specific mechanism targets, review authorized senders for accuracy.

| Domain | Result | Reason | Directives |
| --- | --- | --- | --- |
| giraffe-it.cloud | ‚úÖ Pass | 1+ mechanism targets | include:spf.protection.outlook.com |
| giraffe-it.com | ‚úÖ Pass | 1+ mechanism targets | include:spf.protection.outlook.com |
| Giraffe-it.eu | ‚úÖ Pass | 1+ mechanism targets | include:spf.protection.outlook.com |
| Giraffe-it.nl | ‚úÖ Pass | 1+ mechanism targets | include:spf.protection.outlook.com |


**Tag**: `MS.EXO` `MS.EXO.2.2` `CISA.MS.EXO.2.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSpfDirective.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.3.1: DKIM SHOULD be enabled for all domains.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

DKIM SHOULD be enabled for all domains.

Rationale: An adversary may modify the `FROM` field of an email such that it appears to be a legitimate email sent by an agency, facilitating phishing attacks. Enabling DKIM is another means for recipients to detect spoofed emails and verify the integrity of email content.

### Remediation action:

#### Option 1: Enable DKIM
To enable DKIM, follow the instructions listed on [Steps to Create, enable and disable DKIM from Microsoft 365 Defender portal | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-dkim-configure?view=o365-worldwide#steps-to-create-enable-and-disable-dkim-from-microsoft-365-defender-portal).

#### Option 2: Disallow mail to be sent from domain
If the domain is not used for sending mail, we recommend disabling the ability to send from this domain. This will skip the domain for this particular test.

1. Sign in to the [**Exchange Admin Center - Accepted Domains**](https://admin.exchange.microsoft.com/#/accepteddomains).
2. Select the domain to disable sending from.
3. Uncheck **Allow mail to be sent from this domain**.

We recommend doing this for **\*onmicrosoft.com** domains.

### Related links

* [Defender admin center - Email authentication settings](https://security.microsoft.com/authentication?viewid=DKIM)
* [CISA 3 Sender Policy Framework - MS.EXO.3.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo31v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L107)



#### Test Results


Well done. Your tenant's domains have DKIM configured and valid records exist.

| Domain | Result | Reason |
| --- | --- | --- |
| giraffe-it.cloud | ‚úÖ Pass |  |
| giraffe-it.com | ‚úÖ Pass |  |
| Giraffe-it.eu | ‚úÖ Pass |  |
| Giraffe-it.nl | ‚úÖ Pass |  |
| Giraffeit.onmicrosoft.com | üóÑÔ∏è Skip | Parked domain |


**Tag**: `MS.EXO` `MS.EXO.3.1` `CISA.MS.EXO.3.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaDkim.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.4.1: A DMARC policy SHALL be published for every second-level domain.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

A DMARC policy SHALL be published for every second-level domain.

Rationale: Without a DMARC policy available for each domain, recipients may improperly handle SPF and DKIM failures, possibly enabling spoofed emails to reach end users' mailboxes. Publishing DMARC records at the second-level domain protects the second-level domains and all subdomains.

#### Remediation action:

DMARC is not configured through the Exchange admin center, but rather via DNS records hosted by the agency's domain. As such, implementation varies depending on how an agency manages its DNS records. See [Form the DMARC TXT record for your domain | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-dmarc-configure?view=o365-worldwide#step-4-form-the-dmarc-txt-record-for-your-domain) for Microsoft guidance.

A DMARC record published at the second-level domain will protect all subdomains. In other words, a DMARC record published for `example.com` will protect both `a.example.com` and `b.example.com`, but a separate record would need to be published for `c.example.gov`.

To test your DMARC configuration, consider using one of many publicly available web-based tools. Additionally, DMARC records can be requested using the PowerShell tool `Resolve-DnsName`. For example:

`Resolve-DnsName _dmarc.example.com txt`

If DMARC is configured, a response resembling `v=DMARC1; p=reject; pct=100; rua=mailto:reports@dmarc.cyber.dhs.gov, mailto:reports@example.com; ruf=mailto:reports@example.com` will be returned, though by necessity, the contents of the record will vary by agency. In this example, the policy indicates all emails failing the SPF/DKIM checks are to be rejected and aggregate reports sent to reports@dmarc.cyber.dhs.gov and reports@example.com. Failure reports will be sent to reports@example.com.

#### Related links

* [Exchange admin center - Accepted domains](https://admin.exchange.microsoft.com/#/accepteddomains)
* [CISA 4 Domain-Based Message Authentication, Reporting, and Conformance (DMARC) - MS.EXO.4.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo41v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L147)



#### Test Results


Well done. Your tenant's second level domains have a DMARC record. Review report targets.

| Domain | Result | Reason | Targets |
| --- | --- | --- | --- |
| cloud | ‚ùå Fail | Failure to obtain record | Aggregate Reports:  |
| cloud | ‚ùå Fail | Failure to obtain record | Forensic Reports:  |
| com | ‚ùå Fail | Failure to obtain record | Aggregate Reports:  |
| com | ‚ùå Fail | Failure to obtain record | Forensic Reports:  |
| Giraffe-it.eu | ‚úÖ Pass |  | Aggregate Reports:  |
| Giraffe-it.eu | ‚úÖ Pass |  | Forensic Reports:  |
| Giraffe-it.nl | ‚úÖ Pass |  | Aggregate Reports:  |
| Giraffe-it.nl | ‚úÖ Pass |  | Forensic Reports:  |
| onmicrosoft.com | üóÑÔ∏è Skip | Initial domain ||


**Tag**: `MS.EXO` `MS.EXO.4.1` `CISA.MS.EXO.4.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaDmarcRecordExist.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.4.2: The DMARC message rejection option SHALL be p=reject.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The DMARC message rejection option SHALL be p=reject.

Rationale: Of the three policy options (i.e., none, quarantine, and reject), reject provides the strongest protection. Reject is the level of protection required by BOD 18-01 for FCEB departments and agencies.

#### Remediation action:

* See MS.EXO.4.1v1 Instructions for an overview of how to publish and check a DMARC record.
* Ensure the record published includes p=reject.

#### Related links

* [Exchange admin center - Accepted domains](https://admin.exchange.microsoft.com/#/accepteddomains)
* [CISA 4 Domain-Based Message Authentication, Reporting, and Conformance (DMARC) - MS.EXO.4.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo42v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L176)



#### Test Results


Well done. Your tenant's domains have a DMARC record with reject policy. Review report targets.

| Domain | Result | Reason | Policy | Subdomain Policy |
| --- | --- | --- | --- | --- |
| cloud | ‚ùå Fail | Failure to obtain record |  |  |


**Tag**: `MS.EXO` `MS.EXO.4.2` `CISA.MS.EXO.4.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaDmarcRecordReject.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.5.1: SMTP AUTH SHALL be disabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

SMTP AUTH SHALL be disabled.

Rationale: SMTP AUTH is not used or needed by modern email clients. Therefore, disabling it as the global default conforms to the principle of least functionality.

#### Remediation action:

1. To disable SMTP AUTH for the organization:
2. Sign in to the **Exchange admin center**.
3. On the left hand pane, select [**Settings**](https://admin.exchange.microsoft.com/#/settings); then from the settings list, select **Mail Flow**.
4. Make sure the setting **Turn off SMTP AUTH protocol for your organization** is checked.

#### Related links

* [Exchange admin center - Settings](https://admin.exchange.microsoft.com/#/settings)
* [CISA 5 Simple Mail Transfer Protocol Authentication - MS.EXO.5.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo51v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L306)



#### Test Results


Well done. Your tenant has [SMTP Authentication](https://admin.exchange.microsoft.com/#/settings) disabled.

**Tag**: `MS.EXO` `MS.EXO.5.1` `CISA.MS.EXO.5.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSmtpAuthentication.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.6.1: Contact folders SHALL NOT be shared with all domains.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Contact folders SHALL NOT be shared with all domains.

Rationale: Contact folders may contain information that should not be shared by default with all domains. Disabling sharing with all domains closes an avenue for data exfiltration while still allowing for specific legitimate use as needed.

#### Remediation action:

To restrict sharing with all domains:
1. Sign in to the **Exchange admin center**.
2. On the left-hand pane under **Organization**, select **Sharing**.
3. Select [**Individual Sharing**](https://admin.exchange.microsoft.com/#/individualsharing).
4. For all existing policies, select the policy, then select **Manage domains**.
5. For all sharing rules under all existing policies, ensure **Sharing with everyone** and **Anonymous** do not include ContactsSharing.

#### Related links

* [Exchange admin center - Individual Sharing](https://admin.exchange.microsoft.com/#/individualsharing)
* [CISA 6 Calendar and Contact Sharing - MS.EXO.6.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo61v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L335)



#### Test Results


Well done. Your tenant does not allow uncontrolled contact sharing.

| Policy Name | Test Result |
| --- | --- |
| [Default Sharing Policy](https://admin.exchange.microsoft.com/#/individualsharing/:/individualsharingdetails/1807e6c0-7d05-4f28-9c86-253f70a57115/managedomain) | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.6.1` `CISA.MS.EXO.6.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaContactSharing.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.6.2: Calendar details SHALL NOT be shared with all domains.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Calendar details SHALL NOT be shared with all domains.

Rationale: Calendar details may contain information that should not be shared by default with all domains. Disabling sharing with all domains closes an avenue for data exfiltration while still allowing for legitimate use as needed.

#### Remediation action:

To restrict sharing with all domains:
1. Sign in to the **Exchange admin center**.
2. On the left-hand pane under **Organization**, select **Sharing**.
3. Select [**Individual Sharing**](https://admin.exchange.microsoft.com/#/individualsharing).
4. For all existing policies, select the policy, then select **Manage domains**.
5. For all sharing rules under all existing policies, ensure **Sharing with everyone** and **Anonymous** do not include CalendarSharing.

#### Related links

* [Exchange admin center - Individual Sharing](https://admin.exchange.microsoft.com/#/individualsharing)
* [Microsoft 365 admin center - Org settings - Calendar](https://admin.microsoft.com/#/Settings/Services/:/Settings/L1/Calendar)
* [CISA 6 Calendar and Contact Sharing - MS.EXO.6.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo62v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L368)



#### Test Results


Well done. Your tenant does not allow uncontrolled calendar sharing.

| Policy Name | Test Result |
| --- | --- |
| [Default Sharing Policy](https://admin.exchange.microsoft.com/#/individualsharing/:/individualsharingdetails/1807e6c0-7d05-4f28-9c86-253f70a57115/managedomain) | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.6.2` `CISA.MS.EXO.6.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaCalendarSharing.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.7.1: External sender warnings SHALL be implemented.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

External sender warnings SHALL be implemented.

Rationale: Phishing is an ever-present threat. Alerting users when email originates from outside their organization can encourage them to exercise increased caution, especially if an email is one they expected from an internal sender.

> ‚ö†Ô∏è WARNING: This test allows the use of a technical mechanism that differs from CISA's, though the outcome is the same.

#### Remediation action:

##### Option 1: Use external sender identification

This feature is only available for Outlook, Outlook for Mac, Outlook on the web, and Outlook for iOS and Android.

1. Connect to Exchange Online using PowerShell module `ExchangeOnlineManagement`
2. Enable the feature with the cmdlet `Set-ExternalInOutlook`

```powershell
Install-Module -Name ExchangeOnlineManagement
Connect-ExchangeOnline
Set-ExternalInOutlook -Enabled $true
```

##### Option 2: Prepend subject with "[External]"

To create a mail flow rule to produce external sender warnings:
1. Sign in to the **Exchange admin center**.
2. Under **Mail flow**, select [**Rules**](https://admin.exchange.microsoft.com/#/transportrules).
3. Click the plus (+) button to create a new rule.
4. Select **Modify messages‚Ä¶**.
5. Give the rule an appropriate name.
6. Under **Apply this rule if‚Ä¶**, select **The sender is external/internal**.
7. Under **select sender location**, select **Outside the organization**, then click **OK**.
8. Under **Do the following‚Ä¶**, select **Prepend the subject of the message with‚Ä¶**.
9. Under **specify subject prefix**, enter a message such as "[External]" (without the quotation marks), then click **OK**.
10. Click **Next**.
11. Under **Choose a mode for this rule**, select **Enforce**.
12. Leave the **Severity** as **Not Specified**.
13. Leave the **Match sender address in message** as **Header** and click **Next**.
14. Click **Finish** and then **Done**.
15. The new rule will be disabled. Re-select the new rule to show its settings and slide the **Enable or disable rule** slider to the right until it shows as **Enabled**.

#### Related links

* [Exchange admin center - Mail Flow Rules](https://admin.exchange.microsoft.com/#/transportrules)
* [CISA 7 External Sender Warnings - MS.EXO.7.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo71v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L405)



#### Test Results


Well done. Your tenant has an external sender warning.

Exchange External Sender Identification is enabled.

No domains are allowed to bypass the external sender warning.



**Tag**: `MS.EXO` `MS.EXO.7.1` `CISA.MS.EXO.7.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaExternalSenderWarning.Tests.ps1`

---

### ‚ùå CISA.MS.EXO.8.1: A DLP solution SHALL be used.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

A DLP solution SHALL be used.

Rationale: Users may inadvertently disclose sensitive information to unauthorized individuals. A DLP solution may detect the presence of sensitive information in Exchange Online and block access to unauthorized entities.

#### Remediation action:

1. Sign in to the **Microsoft Purview compliance portal**.
2. Under the **Solutions** section, select **Data loss prevention**.
3. Select [**Policies**](https://purview.microsoft.com/datalossprevention/policies) from the left menu.
4. Select **Create policy**.
5. From the **Categories** list, select **Custom**.
6. From the **Templates** list, select **Custom policy** and then click **Next**.
7. Edit the name and description of the policy if desired, then click **Next**.
8. Under **Choose locations to apply the policy**, set **Status** to **On** for at least the Exchange email, OneDrive accounts, SharePoint sites, Teams chat and channel messages, and Devices locations, then click **Next**.
9. Under **Define policy settings**, select **Create or customize advanced DLP rules**, and then click **Next**.
10. Click **Create rule**. Assign the rule an appropriate name and description.
11. Click **Add condition**, then **Content contains**.
12. Click **Add**, then **Sensitive info types**.
13. Add information types that protect information sensitive to the agency.

    At a minimum, the agency should protect:
    - Credit card numbers
    - U.S. Individual Taxpayer Identification Numbers (ITIN)
    - U.S. Social Security Numbers (SSN)
    - All agency-defined PII and sensitive information

14. Click **Add**.
15. Under **Actions**, click **Add an action**.
16. Check **Restrict Access or encrypt the content in Microsoft 365 locations**.
17. Under this action, select **Block Everyone**.
18. Under **User notifications**, turn on **Use notifications to inform your users and help educate them on the proper use of sensitive info**.
19. Under **Microsoft 365 services**, a section that appears after user notifications are turned on, check the box next to **Notify users in Office 365 service with a policy tip**.
20. Click **Save**, then **Next**.
21. Select **Turn it on right away**, then click **Next**.
22. Click **Submit**.

#### Related links

* [Purview admin center - Data loss prevention policies](https://purview.microsoft.com/datalossprevention/policies)
* [CISA 8 Data Loss Prevention Solutions - MS.EXO.8.1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo81v2)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L439)



#### Test Results


Your tenant does not have [Purview Data Loss Prevention Policies](https://purview.microsoft.com/datalossprevention/policies) enabled.

| Name | Status | Description |
| --- | --- | --- |
| DLP - Baseline - EU Sensitive Data | ‚ùå Fail |  |


**Tag**: `MS.EXO` `MS.EXO.8.1` `CISA.MS.EXO.8.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaDlp.Tests.ps1`

---

### ‚ùå CISA.MS.EXO.8.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency.

> Reference your organization's policy defining PII.

Rationale: Users may inadvertently share sensitive information with others who should not have access to it. Data loss prevention policies provide a way for agencies to detect and prevent unauthorized disclosures.

#### Remediation action:

1. Sign in to the **Microsoft Purview compliance portal**.
2. Under the **Solutions** section, select **Data loss prevention**.
3. Select [**Policies**](https://purview.microsoft.com/datalossprevention/policies) from the left menu.
4. Select **Create policy**.
5. From the **Categories** list, select **Custom**.
6. From the **Templates** list, select **Custom policy** and then click **Next**.
7. Edit the name and description of the policy if desired, then click **Next**.
8. Under **Choose locations to apply the policy**, set **Status** to **On** for at least the Exchange email, OneDrive accounts, SharePoint sites, Teams chat and channel messages, and Devices locations, then click **Next**.
9. Under **Define policy settings**, select **Create or customize advanced DLP rules**, and then click **Next**.
10. Click **Create rule**. Assign the rule an appropriate name and description.
11. Click **Add condition**, then **Content contains**.
12. Click **Add**, then **Sensitive info types**.
13. Add information types that protect information sensitive to the agency.

    At a minimum, the agency should protect:
    - Credit card numbers
    - U.S. Individual Taxpayer Identification Numbers (ITIN)
    - U.S. Social Security Numbers (SSN)
    - All agency-defined PII and sensitive information

14. Click **Add**.
15. Under **Actions**, click **Add an action**.
16. Check **Restrict Access or encrypt the content in Microsoft 365 locations**.
17. Under this action, select **Block Everyone**.
18. Under **User notifications**, turn on **Use notifications to inform your users and help educate them on the proper use of sensitive info**.
19. Under **Microsoft 365 services**, a section that appears after user notifications are turned on, check the box next to **Notify users in Office 365 service with a policy tip**.
20. Click **Save**, then **Next**.
21. Select **Turn it on right away**, then click **Next**.
22. Click **Submit**.

#### Related links

* [Purview admin center - Data loss prevention policies](https://purview.microsoft.com/datalossprevention/policies)
* [CISA 8 Data Loss Prevention Solutions - MS.EXO.8.2](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo82v2)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L438)



#### Test Results


Your tenant does not have [Purview Data Loss Prevention Policies](https://purview.microsoft.com/datalossprevention/policies) enabled with the Sensitive Info Type of All Full Names.



**Tag**: `MS.EXO` `MS.EXO.8.2` `CISA.MS.EXO.8.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaDlpPii.Tests.ps1`

---

### ‚ùå CISA.MS.EXO.8.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email.

> Reference your organization's policy defining restricted information.

Rationale: Users may inadvertently share sensitive information with others who should not have access to it. Data loss prevention policies provide a way for agencies to detect and prevent unauthorized disclosures.

#### Remediation action:

1. Sign in to the **Microsoft Purview compliance portal**.
2. Under the **Solutions** section, select **Data loss prevention**.
3. Select [**Policies**](https://purview.microsoft.com/datalossprevention/policies) from the left menu.
4. Select **Create policy**.
5. From the **Categories** list, select **Custom**.
6. From the **Templates** list, select **Custom policy** and then click **Next**.
7. Edit the name and description of the policy if desired, then click **Next**.
8. Under **Choose locations to apply the policy**, set **Status** to **On** for at least the Exchange email, OneDrive accounts, SharePoint sites, Teams chat and channel messages, and Devices locations, then click **Next**.
9. Under **Define policy settings**, select **Create or customize advanced DLP rules**, and then click **Next**.
10. Click **Create rule**. Assign the rule an appropriate name and description.
11. Click **Add condition**, then **Content contains**.
12. Click **Add**, then **Sensitive info types**.
13. Add information types that protect information sensitive to the agency.

    At a minimum, the agency should protect:
    - Credit card numbers
    - U.S. Individual Taxpayer Identification Numbers (ITIN)
    - U.S. Social Security Numbers (SSN)
    - All agency-defined PII and sensitive information

14. Click **Add**.
15. Under **Actions**, click **Add an action**.
16. Check **Restrict Access or encrypt the content in Microsoft 365 locations**.
17. Under this action, select **Block Everyone**.
18. Under **User notifications**, turn on **Use notifications to inform your users and help educate them on the proper use of sensitive info**.
19. Under **Microsoft 365 services**, a section that appears after user notifications are turned on, check the box next to **Notify users in Office 365 service with a policy tip**.
20. Click **Save**, then **Next**.
21. Select **Turn it on right away**, then click **Next**.
22. Click **Submit**.

#### Related links

* [Purview admin center - Data loss prevention policies](https://purview.microsoft.com/datalossprevention/policies)
* [CISA 8 Data Loss Prevention Solutions - MS.EXO.8.4](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo84v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L468)



#### Test Results


Your tenant does not have [Purview Data Loss Prevention Policies](https://purview.microsoft.com/datalossprevention/policies) enabled with the Sensitive Info Type of credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN).

Required Rules:

| Credit Card Number | U.S. Social Security Number | U.S. Individual Taxpayer Identification Number |
| --- | --- | --- |
| ‚ùå Fail | ‚ùå Fail | ‚ùå Fail |

Rule Relationships:

| Status | Policy | Rule |
| --- | --- | --- |


**Tag**: `MS.EXO` `MS.EXO.8.4` `CISA.MS.EXO.8.4` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaDlpBaselineRule.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.9.1: Emails SHALL be filtered by attachment file types.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Emails SHALL be filtered by attachment file types.

Rationale: Malicious attachments often take the form of click-to-run files. Sharing high risk file types, when necessary, is better left to a means other than email; the dangers of allowing them to be sent over email outweigh any potential benefits. Filtering email attachments based on file types can prevent spread of malware distributed via click-to-run email attachments.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [Defender admin center - Order and precedence of email protection](https://learn.microsoft.com/en-us/defender-office-365/how-policies-and-protections-are-combined)
* [CISA 9 Attachment File Type - MS.EXO.9.1v2](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo91v2)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L487)
* [Microsoft Learn - Common attachments filter in anti-malware policies](https://learn.microsoft.com/en-us/defender-office-365/anti-malware-protection-about#common-attachments-filter-in-anti-malware-policies)



#### Test Results


Well done. All the anti-malware policies in your tenant has the common attachments filter enabled (https://security.microsoft.com/antimalwarev2).

| Policy name | Enabled | EnableFileFilter | Extensions | Result |
| --- | --- | --- | --- | --- |
| Strict Preset Security Policy1766584481384 | True | True | ace, apk, app, appx, ani, & 48 others | ‚úÖ Pass |
| Standard Preset Security Policy1765450055055 | True | True | ace, apk, app, appx, ani, & 48 others | ‚úÖ Pass |
| CIS L2 Attachment Policy | True | True | 7z, a3x, ace, ade, adp, & 182 others | ‚úÖ Pass |
| Default | True | True | ace, apk, app, appx, ani, & 48 others | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.9.1` `CISA.MS.EXO.9.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaAttachmentFilter.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.9.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The attachment filter SHOULD attempt to determine the true file type and assess the file extension.

Rationale: Users can change a file extension at the end of a file name (e.g., notepad.exe to notepad.txt) to obscure the actual file type. Verifying the file type and checking that this matches the designated file extension can help detect instances where the file extension was changed.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select [**Preset Security Policies**](https://security.microsoft.com/presetSecurityPolicies).
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 9 Attachment File Type - MS.EXO.9.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo92v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L502)
* [Microsoft Learn - True type matching in the common attachments filter](https://learn.microsoft.com/en-us/defender-office-365/anti-malware-protection-about#true-type-matching-in-the-common-attachments-filter)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies for the common file filter](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | File Filter Enabled |
| --- | --- |
| CIS L2 Attachment Policy | ‚úÖ Pass |
| Default | ‚úÖ Pass |
| Standard Preset Security Policy1765450055055 | ‚úÖ Pass |
| Strict Preset Security Policy1766584481384 | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.9.2` `CISA.MS.EXO.9.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaAttachmentFileType.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.9.3: Disallowed file types SHALL be determined and enforced.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The attachment filter SHOULD attempt to determine the true file type and assess the file extension.

Rationale: Users can change a file extension at the end of a file name (e.g., notepad.exe to notepad.txt) to obscure the actual file type. Verifying the file type and checking that this matches the designated file extension can help detect instances where the file extension was changed.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select [**Preset Security Policies**](https://security.microsoft.com/presetSecurityPolicies).
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 9 Attachment File Type - MS.EXO.9.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo92v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L502)
* [Microsoft Learn - True type matching in the common attachments filter](https://learn.microsoft.com/en-us/defender-office-365/anti-malware-protection-about#true-type-matching-in-the-common-attachments-filter)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies for the common file filter](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | File Filter Enabled |
| --- | --- |
| CIS L2 Attachment Policy | ‚úÖ Pass |
| Default | ‚úÖ Pass |
| Standard Preset Security Policy1765450055055 | ‚úÖ Pass |
| Strict Preset Security Policy1766584481384 | ‚úÖ Pass |


**Tag**: `MS.EXO` `MS.EXO.9.3` `CISA.MS.EXO.9.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaBlockFileType.Tests.ps1`

---

### ‚úÖ CISA.MS.EXO.9.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe).

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe).

Rationale: Malicious attachments often take the form of click-to-run files. Blocking a list of common executable files helps mitigate the risk of adversarial exploitation.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 9 Attachment File Type - MS.EXO.9.5v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo95v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L547)



#### Test Results


Well done. Your tenant has [standard and strict preset security policies for the common file filter](https://security.microsoft.com/presetSecurityPolicies).

| Policy | Status |
| --- | --- |
| Standard | ‚úÖ Pass |
| Strict | ‚úÖ Pass |

| Policy Name | File Filter Enabled | Extensions |
| --- | --- | --- |
| CIS L2 Attachment Policy | ‚úÖ Pass | cmd, exe, vbe |
| Default | ‚úÖ Pass | cmd, exe, vbe |
| Standard Preset Security Policy1765450055055 | ‚úÖ Pass | cmd, exe, vbe |
| Strict Preset Security Policy1766584481384 | ‚úÖ Pass | cmd, exe, vbe |


**Tag**: `MS.EXO` `MS.EXO.9.5` `CISA.MS.EXO.9.5` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaBlockExecutable.Tests.ps1`

---

### ‚ùå CISA.MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization.

Rationale: Sharing information outside the organization via SharePoint increases the risk of unauthorized access. By limiting external sharing, administrators decrease the risk of access to information.

#### Remediation action:

1. Sign in to the [SharePoint admin center](https://go.microsoft.com/fwlink/?linkid=2185219).
2. Select Policies > Sharing.
3. Adjust external sharing slider for SharePoint to Existing guests or Only people in your organization.

> ‚ö†Ô∏è WARNING: This will break existing sharing.

4. Select Save.

#### Related links

* [CISA 1 External Sharing - MS.SHAREPOINT.1.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint11v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/SharepointConfig.rego#L68)



#### Test Results


Your tenant does not restrict SharePoint Online sharing.

* externalUserAndGuestSharing


**Tag**: `MS.SHAREPOINT` `MS.SHAREPOINT.1.1` `CISA.MS.SHAREPOINT.1.1` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\spo\Test-MtCisaSpoSharing.Tests.ps1`

---

### ‚ùå CISA.MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs.

Rationale: By limiting sharing to domains or approved security groups used for interagency collaboration purposes, administrators help prevent sharing with unknown organizations and individuals.

#### Remediation action:

This policy is only applicable if the external sharing slider on the admin page is set to any value other than Only People in your organization.
1. Sign in to the [SharePoint admin center](https://go.microsoft.com/fwlink/?linkid=2185219).
2. Select Policies > Sharing.
3. Expand More external sharing settings.
4. Select Limit external sharing by domain.
5. Select Add domains.
6. Add each approved external domain users are allowed to share files with.
7. Select Manage security groups
8. Add each approved security group. Members of these groups will be allowed to share files externally.
9. Select Save.

#### Related links

* [CISA 1 External Sharing - MS.SHAREPOINT.1.3v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint13v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/SharepointConfig.rego#L130)



#### Test Results


Your tenant does not restrict SharePoint Online sharing to specific domains.

**Tag**: `MS.SHAREPOINT` `MS.SHAREPOINT.1.3` `CISA.MS.SHAREPOINT.1.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\spo\Test-MtCisaSpoSharingAllowedDomain.Tests.ps1`

---

### ‚úÖ EIDSCA.AF01: Authentication Method - FIDO2 security key - State.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Whether the FIDO2 security keys is enabled in the tenant.

enabled

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')
.state -eq 'enabled'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/fido2authenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'enabled'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AF01](https://maester.dev/docs/tests/EIDSCA.AF01)

**Tag**: `EIDSCA` `Security` `EIDSCA.AF01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Allows users to register a FIDO key through the MySecurityInfo portal, even if enabled by Authentication Methods policy.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')
.isSelfServiceRegistrationAllowed -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/fido2authenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'true'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AF02](https://maester.dev/docs/tests/EIDSCA.AF02)

**Tag**: `EIDSCA` `Security` `EIDSCA.AF02`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Requires the FIDO security key metadata to be published and verified with the FIDO Alliance Metadata Service, and also pass Microsoft's additional set of validation testing.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')
.isAttestationEnforced -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/fido2authenticationmethodconfiguration)




#### Test Results


Your tenant is configured as **False**.

The recommended value is **'true'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AF03](https://maester.dev/docs/tests/EIDSCA.AF03)

**Tag**: `EIDSCA` `Security` `EIDSCA.AF03`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Manages if registration of FIDO2 keys should be restricted.

Restrict usage of FIDO2 from unauthorized vendors or platforms

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')
.keyRestrictions.isEnforced -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/fido2authenticationmethodconfiguration)




#### Test Results


Your tenant is configured as **False**.

The recommended value is **'true'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AF04](https://maester.dev/docs/tests/EIDSCA.AF04)

**Tag**: `EIDSCA` `Security` `EIDSCA.AF04`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AG01: Authentication Method - General Settings - Manage migration.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The state of migration of the authentication methods policy from the legacy multifactor authentication and self-service password reset (SSPR) policies. In January 2024, the legacy multifactor authentication and self-service password reset policies will be deprecated and you'll manage all authentication methods here in the authentication methods policy. Use this control to manage your migration from the legacy policies to the new unified policy.

On September 30th, 2025, the legacy multifactor authentication and self-service password reset policies will be deprecated and you'll manage all authentication methods here in the authentication methods policy. Use this control to manage your migration from the legacy policies to the new unified policy.

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy
.policyMigrationState -in @('migrationComplete', '')
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [Get authenticationMethodsPolicy - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/authenticationmethodspolicy-get)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods)



#### Test Results


Well done. The configuration in your tenant and recommended value is one of the following values **@('migrationComplete', '')** for **policies/authenticationMethodsPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AG01](https://maester.dev/docs/tests/EIDSCA.AG01)

**Tag**: `EIDSCA` `Security` `EIDSCA.AG01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Allows users to report suspicious activities if they receive an authentication request that they did not initiate. This control is available when using the Microsoft Authenticator app and voice calls. Reporting suspicious activity will set the user's risk to high. If the user is subject to risk-based Conditional Access policies, they may be blocked.

Allows to integrate report of fraud attempt by users to identity protection: Users who report an MFA prompt as suspicious are set to High User Risk. Administrators can use risk-based policies to limit access for these users, or enable self-service password reset (SSPR) for users to remediate problems on their own.

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy
.reportSuspiciousActivitySettings.state -eq 'enabled'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [Get authenticationMethodsPolicy - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/authenticationmethodspolicy-get)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AuthMethodsSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'enabled'** for **policies/authenticationMethodsPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AG02](https://maester.dev/docs/tests/EIDSCA.AG02)

**Tag**: `EIDSCA` `Security` `EIDSCA.AG02`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Object Id or scope of users which will be included to report suspicious activities if they receive an authentication request that they did not initiate.

Apply this feature to all users.

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy
.reportSuspiciousActivitySettings.includeTarget.id -eq 'all_users'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [Get authenticationMethodsPolicy - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/authenticationmethodspolicy-get)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AuthMethodsSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'all_users'** for **policies/authenticationMethodsPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AG03](https://maester.dev/docs/tests/EIDSCA.AG03)

**Tag**: `EIDSCA` `Security` `EIDSCA.AG03`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Whether the Authenticator App is enabled in the tenant.

enabled

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')
.state -eq 'enabled'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/microsoftauthenticatorauthenticationmethodconfiguration)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'enabled'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AM01](https://maester.dev/docs/tests/EIDSCA.AM01)

**Tag**: `EIDSCA` `Security` `EIDSCA.AM01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Defines if users can use the OTP code generated by the Authenticator App.

CISA MS.AAD.3.3v2 recommends disabling Microsoft Authenticator OTP. We recommend using this method only if no stronger MFA option is available, or if it is needed for specific restore scenarios. Make sure you have configured authentication strength to require stronger and phishing-resistant authentication methods, in order to enforce stronger authentication than OTP in all other scenarios.

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')
.isSoftwareOathEnabled -eq 'false'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/microsoftauthenticatorauthenticationmethodconfiguration)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods)



#### Test Results


Your tenant is configured as **True**.

The recommended value is **'false'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AM02](https://maester.dev/docs/tests/EIDSCA.AM02)

**Tag**: `EIDSCA` `Security` `EIDSCA.AM02`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Defines if number matching is required for MFA notifications.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')
.featureSettings.numberMatchingRequiredState.state -eq 'enabled'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/microsoftauthenticatorauthenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'enabled'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AM03](https://maester.dev/docs/tests/EIDSCA.AM03)

**Tag**: `EIDSCA` `Security` `EIDSCA.AM03`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Object Id or scope of users which will be showing number matching in the Authenticator App.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')
.featureSettings.numberMatchingRequiredState.includeTarget.id -eq 'all_users'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/microsoftauthenticatorauthenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'all_users'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AM04](https://maester.dev/docs/tests/EIDSCA.AM04)

**Tag**: `EIDSCA` `Security` `EIDSCA.AM04`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Determines whether the user's Authenticator app will show them the client app they are signing into.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')
.featureSettings.displayAppInformationRequiredState.state -eq 'enabled'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/microsoftauthenticatorauthenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'enabled'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AM06](https://maester.dev/docs/tests/EIDSCA.AM06)

**Tag**: `EIDSCA` `Security` `EIDSCA.AM06`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Object Id or scope of users which will be showing app information in the Authenticator App.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')
.featureSettings.displayAppInformationRequiredState.includeTarget.id -eq 'all_users'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/microsoftauthenticatorauthenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'all_users'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AM07](https://maester.dev/docs/tests/EIDSCA.AM07)

**Tag**: `EIDSCA` `Security` `EIDSCA.AM07`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Determines whether the user's Authenticator app will show them the geographic location of where the authentication request originated from.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')
.featureSettings.displayLocationInformationRequiredState.state -eq 'enabled'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/microsoftauthenticatorauthenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'enabled'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AM09](https://maester.dev/docs/tests/EIDSCA.AM09)

**Tag**: `EIDSCA` `Security` `EIDSCA.AM09`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Object Id or scope of users which will be showing geographic location in the Authenticator App.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')
.featureSettings.displayLocationInformationRequiredState.includeTarget.id -eq 'all_users'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/microsoftauthenticatorauthenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'all_users'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AM10](https://maester.dev/docs/tests/EIDSCA.AM10)

**Tag**: `EIDSCA` `Security` `EIDSCA.AM10`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Indicates whether administrators of the tenant can use the Self-Service Password Reset (SSPR). The policy applies to some critical critical roles in Microsoft Entra ID.

Administrators with sensitive roles should use phishing-resistant authentication methods only and therefore not able to reset their password using SSPR.

#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.allowedToUseSSPR -eq 'false'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/PasswordResetMenuBlade/~/AdminPasswordResetPolicy)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'false'** for **policies/authorizationPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP01](https://maester.dev/docs/tests/EIDSCA.AP01)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Manages controls who can invite guests to your directory to collaborate on resources secured by your Entra ID (Azure AD), such as SharePoint sites or Azure resources.

CISA SCuBA 2.18: Only users with the Guest Inviter role SHOULD be able to invite guest users

#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.allowInvitesFrom -in @('adminsAndGuestInviters','none')
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AllowlistPolicyBlade)



#### Test Results


Well done. The configuration in your tenant and recommended value is one of the following values **@('adminsAndGuestInviters','none')** for **policies/authorizationPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP04](https://maester.dev/docs/tests/EIDSCA.AP04)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP04`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Indicates whether users can sign up for email based subscriptions.



#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.allowedToSignUpEmailBasedSubscriptions -eq 'false'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)




#### Test Results


Your tenant is configured as **True**.

The recommended value is **'false'** for **policies/authorizationPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP05](https://maester.dev/docs/tests/EIDSCA.AP05)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP05`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Controls whether users can join the tenant by email validation. To join, the user must have an email address in a domain which matches one of the verified domains in the tenant.

[Self-service sign up for email-verified users - Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/en-us/azure/active-directory/enterprise-users/directory-self-service-signup)

#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.allowEmailVerifiedUsersToJoinOrganization -eq 'false'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'false'** for **policies/authorizationPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP06](https://maester.dev/docs/tests/EIDSCA.AP06)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP06`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AP07: Default Authorization Settings - Guest user access.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Represents role templateId for the role that should be granted to guest user.

CISA SCuBA 2.18: Guest users SHOULD have limited access to Entra ID (Azure AD) directory objects.

#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.guestUserRoleId -eq '2af84b1e-32c8-42b7-82bc-daa82404023b'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AllowlistPolicyBlade)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'2af84b1e-32c8-42b7-82bc-daa82404023b'** for **policies/authorizationPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP07](https://maester.dev/docs/tests/EIDSCA.AP07)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP07`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AP09: Default Authorization Settings - Allow user consent on risk-based apps.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Indicates whether user consent for risky apps is allowed. For example, consent requests for newly registered multi-tenant apps that are not publisher verified and require non-basic permissions are considered risky.

[Configure risk-based step-up consent - Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/configure-risk-based-step-up-consent)

#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.allowUserConsentForRiskyApps -eq 'false'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'false'** for **policies/authorizationPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP09](https://maester.dev/docs/tests/EIDSCA.AP09)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP09`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Controls if non-admin users may register custom-developed applications for use within this directory.

CISA SCuBA 2.6: Only Administrators SHALL Be Allowed To Register Third-Party Applications

#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.defaultUserRolePermissions.allowedToCreateApps -eq 'false'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'false'** for **policies/authorizationPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP10](https://maester.dev/docs/tests/EIDSCA.AP10)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP10`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Prevents all non-admins from reading user information from the directory. This flag doesn't prevent reading user information in other Microsoft services like Exchange Online.

Restrict this default permissions for members have huge impact on collaboration features and user lookup.

#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.defaultUserRolePermissions.allowedToReadOtherUsers -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'true'** for **policies/authorizationPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP14](https://maester.dev/docs/tests/EIDSCA.AP14)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP14`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AT01: Authentication Method - Temporary Access Pass - State.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Whether the Temporary Access Pass is enabled in the tenant.

Use Temporary Access Pass for secure onboarding users (initial password replacement) and enforce MFA for registering security information in Conditional Access Policy.

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('TemporaryAccessPass')
.state -eq 'enabled'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('TemporaryAccessPass')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [temporaryAccessPassAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/temporaryaccesspassauthenticationmethodconfiguration)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'enabled'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('TemporaryAccessPass')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AT01](https://maester.dev/docs/tests/EIDSCA.AT01)

**Tag**: `EIDSCA` `Security` `EIDSCA.AT01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Determines whether the pass is limited to a one-time use.

Avoid to allow reusable passes and restrict usage to one-time use (if applicable)

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('TemporaryAccessPass')
.isUsableOnce -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('TemporaryAccessPass')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [temporaryAccessPassAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/temporaryaccesspassauthenticationmethodconfiguration)




#### Test Results


Your tenant is configured as **False**.

The recommended value is **'true'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('TemporaryAccessPass')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AT02](https://maester.dev/docs/tests/EIDSCA.AT02)

**Tag**: `EIDSCA` `Security` `EIDSCA.AT02`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.AV01: Authentication Method - Voice call - State.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Whether the Voice call is enabled in the tenant.

Choose authentication methods with number matching (Authenticator) 

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Voice')
.state -eq 'disabled'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Voice')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)





#### Test Results


Well done. The configuration in your tenant and recommended value is **'disabled'** for **policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Voice')**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AV01](https://maester.dev/docs/tests/EIDSCA.AV01)

**Tag**: `EIDSCA` `Security` `EIDSCA.AV01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Defines whether user consent will be blocked when a risky request is detected

[Configure risk-based step-up consent - Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/configure-risk-based-step-up-consent)

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'BlockUserConsentForRiskyApps' | select-object -expand value -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)




#### Test Results


Well done. The configuration in your tenant and recommended value is **'true'** for **settings**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.CP03](https://maester.dev/docs/tests/EIDSCA.CP03)

**Tag**: `EIDSCA` `Security` `EIDSCA.CP03`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

If this option is set to enabled, then users request admin consent to any app that requires access to data they do not have the permission to grant. If this option is set to disabled, then users must contact their admin to request to consent in order to use the apps they need.

CISA SCuBA 2.7: Non-Admin Users SHALL Be Prevented From Providing Consent To Third-Party Applications.

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'EnableAdminConsentRequests' | select-object -expand value -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/AdminConsentSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'true'** for **settings**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.CP04](https://maester.dev/docs/tests/EIDSCA.CP04)

**Tag**: `EIDSCA` `Security` `EIDSCA.CP04`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Defines if admin consent request feature is enabled or disabled



#### Test script
```
https://graph.microsoft.com/beta/policies/adminConsentRequestPolicy
.isEnabled -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/adminConsentRequestPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [adminConsentRequestPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/adminconsentrequestpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/AdminConsentSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'true'** for **policies/adminConsentRequestPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.CR01](https://maester.dev/docs/tests/EIDSCA.CR01)

**Tag**: `EIDSCA` `Security` `EIDSCA.CR01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Specifies whether reviewers will receive notifications



#### Test script
```
https://graph.microsoft.com/beta/policies/adminConsentRequestPolicy
.notifyReviewers -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/adminConsentRequestPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [adminConsentRequestPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/adminconsentrequestpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/AdminConsentSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'true'** for **policies/adminConsentRequestPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.CR02](https://maester.dev/docs/tests/EIDSCA.CR02)

**Tag**: `EIDSCA` `Security` `EIDSCA.CR02`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Specifies whether reviewers will receive reminder emails



#### Test script
```
https://graph.microsoft.com/beta/policies/adminConsentRequestPolicy
.remindersEnabled -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/adminConsentRequestPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [adminConsentRequestPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/adminconsentrequestpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/AdminConsentSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is **'true'** for **policies/adminConsentRequestPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.CR03](https://maester.dev/docs/tests/EIDSCA.CR03)

**Tag**: `EIDSCA` `Security` `EIDSCA.CR03`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days).

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Specifies the duration the request is active before it automatically expires if no decision is applied



#### Test script
```
https://graph.microsoft.com/beta/policies/adminConsentRequestPolicy
.requestDurationInDays -le 30
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/adminConsentRequestPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [adminConsentRequestPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/adminconsentrequestpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/AdminConsentSettings)



#### Test Results


Well done. The configuration in your tenant and recommended value is less than or equal to **30** for **policies/adminConsentRequestPolicy**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.CR04](https://maester.dev/docs/tests/EIDSCA.CR04)

**Tag**: `EIDSCA` `Security` `EIDSCA.CR04`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

If set to Enforce, users will be prevented from setting banned passwords and the attempt will be logged. If set to Audit, the attempt will only be logged.

[Microsoft Entra Password Protection - Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/en-us/azure/active-directory/authentication/concept-password-ban-bad-on-premises)

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'BannedPasswordCheckOnPremisesMode' | select-object -expand value -eq 'Enforce'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/PasswordProtection)



#### Test Results


Your tenant is **not configured explicitly**.

The recommended value is **'Enforce'** for **settings**. It seems that you are using a default value by Microsoft. We recommend to set the setting value explicitly since non set values could change depending on what Microsoft decides the current default should be.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.PR01](https://maester.dev/docs/tests/EIDSCA.PR01)

**Tag**: `EIDSCA` `Security` `EIDSCA.PR01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

If set to Yes, password protection is turned on for Active Directory domain controllers when the appropriate agent is installed.

[Azure identity &amp; access security best practices - Microsoft Learn](https://learn.microsoft.com/en-us/azure/security/fundamentals/identity-management-best-practices#enable-password-management)

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'EnableBannedPasswordCheckOnPremises' | select-object -expand value -eq 'True'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/PasswordProtection)



#### Test Results


Your tenant is **not configured explicitly**.

The recommended value is **'True'** for **settings**. It seems that you are using a default value by Microsoft. We recommend to set the setting value explicitly since non set values could change depending on what Microsoft decides the current default should be.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.PR02](https://maester.dev/docs/tests/EIDSCA.PR02)

**Tag**: `EIDSCA` `Security` `EIDSCA.PR02`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

When enabled, the words in the list below are used in the banned password system to prevent easy-to-guess passwords.

[Password protection in Microsoft Entra ID - Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/en-us/azure/active-directory/authentication/concept-password-ban-bad#global-banned-password-list)

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'EnableBannedPasswordCheck' | select-object -expand value -eq 'True'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/PasswordProtection)



#### Test Results


Your tenant is **not configured explicitly**.

The recommended value is **'True'** for **settings**. It seems that you are using a default value by Microsoft. We recommend to set the setting value explicitly since non set values could change depending on what Microsoft decides the current default should be.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.PR03](https://maester.dev/docs/tests/EIDSCA.PR03)

**Tag**: `EIDSCA` `Security` `EIDSCA.PR03`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

The minimum length in seconds of each lockout. If an account locks repeatedly, this duration increases.

[Prevent attacks using smart lockout - Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/en-us/azure/active-directory/authentication/howto-password-smart-lockout)

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'LockoutDurationInSeconds' | select-object -expand value -ge 60
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/PasswordProtection)



#### Test Results


Your tenant is configured as **0**.

The recommended value is greater than or equal to **60** for **settings**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.PR05](https://maester.dev/docs/tests/EIDSCA.PR05)

**Tag**: `EIDSCA` `Security` `EIDSCA.PR05`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚úÖ EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

How many failed sign-ins are allowed on an account before its first lockout. If the first sign-in after a lockout also fails, the account locks out again.

[Prevent attacks using smart lockout - Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/en-us/azure/active-directory/authentication/howto-password-smart-lockout)

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'LockoutThreshold' | select-object -expand value -le 10
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/PasswordProtection)



#### Test Results


Well done. The configuration in your tenant and recommended value is less than or equal to **10** for **settings**


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.PR06](https://maester.dev/docs/tests/EIDSCA.PR06)

**Tag**: `EIDSCA` `Security` `EIDSCA.PR06`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Indicating whether or not a guest user can be an owner of groups, manage

CISA SCuBA 2.18: Guest users SHOULD have limited access to Entra ID (Azure AD) directory objects

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'AllowGuestsToBeGroupOwner' | select-object -expand value -eq 'false'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)




#### Test Results


Your tenant is **not configured explicitly**.

The recommended value is **'false'** for **settings**. It seems that you are using a default value by Microsoft. We recommend to set the setting value explicitly since non set values could change depending on what Microsoft decides the current default should be.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.ST08](https://maester.dev/docs/tests/EIDSCA.ST08)

**Tag**: `EIDSCA` `Security` `EIDSCA.ST08`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Indicating whether or not a guest user can have access to Microsoft 365 groups content. This setting does not require an Azure Active Directory Premium P1 license.

Manages if guest accounts can access resources through Microsoft 365 Group membership and could break collaboration if you disable it.

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'AllowGuestsToAccessGroups' | select-object -expand value -eq 'True'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)




#### Test Results


Your tenant is **not configured explicitly**.

The recommended value is **'True'** for **settings**. It seems that you are using a default value by Microsoft. We recommend to set the setting value explicitly since non set values could change depending on what Microsoft decides the current default should be.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.ST09](https://maester.dev/docs/tests/EIDSCA.ST09)

**Tag**: `EIDSCA` `Security` `EIDSCA.ST09`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### ‚ùå MT.1001: At least one Conditional Access policy is configured with device compliance.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview


It is recommended to have at least one conditional access policy that enforces the use of a compliant device.

See [Require a compliant device, Microsoft Entra hybrid joined device, or MFA - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-compliant-device)

#### Test Results

There was no conditional access policy requiring device compliance.

**Learn more**: [https://maester.dev/docs/tests/MT.1001](https://maester.dev/docs/tests/MT.1001)

**Tag**: `Maester` `CA` `Security` `MT.1001`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1002: App management restrictions on applications and service principals is configured and enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

By default Microsoft Entra ID allows service principals and applications to be configured with weak credentials.

This can include

- client secrets instead of certificates
- secrets and certificates with long expiry (e.g. 10 year)

## How to fix

Using shorter expiry periods and certificates instead of secrets can help reduce the risk of credentials being compromised and used by an attacker.

The sample policy below can be used to enforce credential configurations on apps and service principals.

```powershell
Import-Module Microsoft.Graph.Identity.SignIns

$params = @{
isEnabled = $true
applicationRestrictions = @{
    passwordCredentials = @(
    @{
        restrictionType = "passwordAddition"
        maxLifetime = $null
        restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse("2021-01-01T10:37:00Z")
    }
    @{
        restrictionType = "passwordLifetime"
        maxLifetime = "P365D"
        restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse("2017-01-01T10:37:00Z")
    }
    @{
        restrictionType = "symmetricKeyAddition"
        maxLifetime = $null
        restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse("2021-01-01T10:37:00Z")
    }
    @{
        restrictionType = "customPasswordAddition"
        maxLifetime = $null
        restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse("2015-01-01T10:37:00Z")
    }
    @{
        restrictionType = "symmetricKeyLifetime"
        maxLifetime = "P365D"
        restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse("2015-01-01T10:37:00Z")
    }
    )
    keyCredentials = @(
    @{
        restrictionType = "asymmetricKeyLifetime"
        maxLifetime = "P365D"
        restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse("2015-01-01T10:37:00Z")
    }
    )
}
}

Update-MgPolicyDefaultAppManagementPolicy -BodyParameter $params
```

## Learn more

- [Tenant App Management Policy - Microsoft Graph Reference](https://learn.microsoft.com/graph/api/resources/tenantappmanagementpolicy?view=graph-rest-1.0)
- [What are Workload ID Premium features, and which are free?](https://learn.microsoft.com/en-us/entra/workload-id/workload-identities-faqs#what-are-workload-id-premium-features-and-which-are-free)
- [Microsoft Entra application management policies API overview](https://learn.microsoft.com/en-us/graph/api/resources/applicationauthenticationmethodpolicy?view=graph-rest-1.0#requirements)


#### Test Results

Well done. Your tenant has an app management policy enabled.

**Learn more**: [https://maester.dev/docs/tests/MT.1002](https://maester.dev/docs/tests/MT.1002)

**Tag**: `Maester` `App` `Security` `MT.1002`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-AppManagementPolicies.Tests.ps1`

---

### ‚úÖ MT.1003: At least one Conditional Access policy is configured with All Apps.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


  Microsoft recommends creating at least one conditional access policy targeting all cloud apps and ideally all users.

  See [Plan a Conditional Access deployment - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/plan-conditional-access#apply-conditional-access-policies-to-every-app)

#### Test Results

These conditional access policies target all cloud apps:

  - [Block Legacy Authentication](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/b0fc2034-ddf6-4758-bd7e-fa8f91bd1c12?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)
  - [Block High risk sign ins](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/7e104d64-5664-411f-8f72-0685c9a623d8?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)
  - [Require multifactor authentication for all users](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/0393c270-05f4-4a19-9237-ab113ea01786?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)
  - [Block authentication flows](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/43b6ebc2-aa39-4557-9818-79ab8250deb9?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)


**Learn more**: [https://maester.dev/docs/tests/MT.1003](https://maester.dev/docs/tests/MT.1003)

**Tag**: `Maester` `CA` `Security` `MT.1003`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1004: At least one Conditional Access policy is configured with All Apps and All Users.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


  Microsoft recommends creating at least one conditional access policy targeting all cloud apps and ideally all users.

  See [Plan a Conditional Access deployment - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/plan-conditional-access#apply-conditional-access-policies-to-every-app)

#### Test Results

These conditional access policies target all cloud apps and all users:

  - [Block Legacy Authentication](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/b0fc2034-ddf6-4758-bd7e-fa8f91bd1c12?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)
  - [Block High risk sign ins](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/7e104d64-5664-411f-8f72-0685c9a623d8?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)
  - [Require multifactor authentication for all users](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/0393c270-05f4-4a19-9237-ab113ea01786?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)
  - [Block authentication flows](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/43b6ebc2-aa39-4557-9818-79ab8250deb9?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)


**Learn more**: [https://maester.dev/docs/tests/MT.1004](https://maester.dev/docs/tests/MT.1004)

**Tag**: `Maester` `CA` `Security` `MT.1004`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

It is recommended to have at least one emergency/break glass account or account group excluded from all conditional access policies.
This allows for emergency access to the tenant in case of a misconfiguration or other issues.

See [Manage emergency access accounts in Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/entra/identity/role-based-access-control/security-emergency-access)



#### Test Results


These conditional access policies don't have the emergency access  excluded:

%TestResult%

**Learn more**: [https://maester.dev/docs/tests/MT.1005](https://maester.dev/docs/tests/MT.1005)

**Tag**: `Maester` `CA` `Security` `MT.1005`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1006: At least one Conditional Access policy is configured to require MFA for admins.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks if the tenant has at least one conditional access policy requiring MFA for admins.
The following roles are considered as admin roles:

- Global Administrator
- Application Administrator
- Authentication Administrator
- Billing Administrator
- Cloud Application Administrator
- Conditional Access Administrator
- Exchange Administrator
- Helpdesk Administrator
- Password Administrator
- Privileged Authentication Administrator
- Privileged Role Administrator
- Security Administrator
- SharePoint Administrator
- User Administrator

See [Require MFA for administrators - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa)"



#### Test Results



The following conditional access policies require multi-factor authentication for admins:

  - [Require password change users with High Risk](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/3e6e4fa0-63a7-401a-a3fe-620b904bb784)
  - [Require multifactor authentication for all users](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/0393c270-05f4-4a19-9237-ab113ea01786)


**Learn more**: [https://maester.dev/docs/tests/MT.1006](https://maester.dev/docs/tests/MT.1006)

**Tag**: `Maester` `CA` `Security` `MT.1006`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1007: At least one Conditional Access policy is configured to require MFA for all users.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks if the tenant has at least one conditional access policy requiring MFA for all users.

See [Require MFA for all users - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-all-users-mfa)


#### Test Results


The following conditional access policies require multi-factor authentication for all users:

  - [Require multifactor authentication for all users](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/0393c270-05f4-4a19-9237-ab113ea01786)


**Learn more**: [https://maester.dev/docs/tests/MT.1007](https://maester.dev/docs/tests/MT.1007)

**Tag**: `Maester` `CA` `Security` `MT.1007`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


Microsoft recommends requiring MFA for Azure Management.

See [Require MFA for administrators - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa)

#### Test Results

The following conditional access policies require multi-factor authentication for azure management:

  - [Require password change users with High Risk](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/3e6e4fa0-63a7-401a-a3fe-620b904bb784)
  - [Require multifactor authentication for all users](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/0393c270-05f4-4a19-9237-ab113ea01786)


**Learn more**: [https://maester.dev/docs/tests/MT.1008](https://maester.dev/docs/tests/MT.1008)

**Tag**: `Maester` `CA` `Security` `MT.1008`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1009: At least one Conditional Access policy is configured to block other legacy authentication.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


Legacy authentication is an unsecure method to authenticate. This function checks if the tenant has at least one
conditional access policy that blocks legacy authentication.

See [Block legacy authentication - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-block-legacy)

#### Test Results

These conditional access policies block legacy authentication for other clients :

  - [Block Legacy Authentication](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/b0fc2034-ddf6-4758-bd7e-fa8f91bd1c12?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)


**Learn more**: [https://maester.dev/docs/tests/MT.1009](https://maester.dev/docs/tests/MT.1009)

**Tag**: `Maester` `CA` `Security` `MT.1009`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


Legacy authentication is an unsecure method to authenticate. This function checks if the tenant has at least one
conditional access policy that blocks legacy authentication.

See [Block legacy authentication - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-block-legacy)

#### Test Results

These conditional access policies block legacy authentication for Exchange Active Sync:

  - [Block Legacy Authentication](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/b0fc2034-ddf6-4758-bd7e-fa8f91bd1c12?%23view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies?=)


**Learn more**: [https://maester.dev/docs/tests/MT.1010](https://maester.dev/docs/tests/MT.1010)

**Tag**: `Maester` `CA` `Security` `MT.1010`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Checks if the tenant has at least one conditional access policy securing security info registration.

See [Securing security info registration - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-registration)


#### Test Results


No conditional access policy securing security info registration.

**Learn more**: [https://maester.dev/docs/tests/MT.1011](https://maester.dev/docs/tests/MT.1011)

**Tag**: `Maester` `CA` `Security` `MT.1011`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Checks if the tenant has at least one conditional access policy requiring multifactor authentication for risky sign-ins.

See [Sign-in risk-based multifactor authentication - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-risk)


#### Test Results


No conditional access policy requires multi-factor authentication for risky sign-ins.

**Learn more**: [https://maester.dev/docs/tests/MT.1012](https://maester.dev/docs/tests/MT.1012)

**Tag**: `Maester` `CA` `Security` `MT.1012`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Checks if the tenant has at least one conditional access policy requiring password change for high user risk.

See [User risk-based password change - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-risk-user)


#### Test Results


The following conditional access policies require password change for risky users

  - [Require password change users with High Risk](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/3e6e4fa0-63a7-401a-a3fe-620b904bb784)


**Learn more**: [https://maester.dev/docs/tests/MT.1013](https://maester.dev/docs/tests/MT.1013)

**Tag**: `Maester` `CA` `Security` `MT.1013`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview


Microsoft recommends requiring device compliance for administrators that are members of the following roles:

* Global administrator
* Application administrator
* Authentication Administrator
* Billing administrator
* Cloud application administrator
* Conditional Access administrator
* Exchange administrator
* Helpdesk administrator
* Password administrator
* Privileged authentication administrator
* Privileged Role Administrator
* Security administrator
* SharePoint administrator
* User administrator

See [Require compliant or Microsoft Entra hybrid joined device for administrators - Microsoft Learn](https://aka.ms/CATemplatesAdminDevices)

#### Test Results

There was no conditional access policy requiring compliant or Microsoft Entra hybrid joined device for administrators.

**Learn more**: [https://maester.dev/docs/tests/MT.1014](https://maester.dev/docs/tests/MT.1014)

**Tag**: `Maester` `CA` `Security` `MT.1014`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview


Microsoft recommends blocking access for unknown or unsupported device platforms.

See [Block access for unknown or unsupported device platform - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-policy-unknown-unsupported-device)

#### Test Results

There was no conditional access policy blocking access for unknown or unsupported device platforms.

**Learn more**: [https://maester.dev/docs/tests/MT.1015](https://maester.dev/docs/tests/MT.1015)

**Tag**: `Maester` `CA` `Security` `MT.1015`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1016: At least one Conditional Access policy is configured to require MFA for guest access.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This check verifies if there is at least one conditional access policy that requires multifactor authentication for all guest accounts.

See [Require multifactor authentication for guest access - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-policy-guest-mfa)


#### Test Results


The following conditional access policies require multi-factor authentication for guest accounts:

  - [Require multifactor authentication for all users](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/0393c270-05f4-4a19-9237-ab113ea01786)


**Learn more**: [https://maester.dev/docs/tests/MT.1016](https://maester.dev/docs/tests/MT.1016)

**Tag**: `Maester` `CA` `Security` `MT.1016`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview


Microsoft recommends disabling browser persistence for users accessing the tenant from a unmanaged device.

See [Require reauthentication and disable browser persistence - Microsoft Learn](https://aka.ms/CATemplatesBrowserSession)

#### Test Results

There was no conditional access policy enforcing non persistent browser session for non-corporate devices.

**Learn more**: [https://maester.dev/docs/tests/MT.1017](https://maester.dev/docs/tests/MT.1017)

**Tag**: `Maester` `CA` `Security` `MT.1017`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview


Microsoft recommends disabling browser persistence for users accessing the tenant from a unmanaged device.

See [Require reauthentication and disable browser persistence - Microsoft Learn](https://aka.ms/CATemplatesBrowserSession)

#### Test Results

There was no conditional access policy enforcing sign-in frequency for non-corporate devices.

**Learn more**: [https://maester.dev/docs/tests/MT.1018](https://maester.dev/docs/tests/MT.1018)

**Tag**: `Maester` `CA` `Security` `MT.1018`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview


Microsoft recommends blocking or limiting access to SharePoint, OneDrive, and Exchange content from unmanaged devices.

See [Use application enforced restrictions for unmanaged devices - Microsoft Learn](https://aka.ms/CATemplatesAppRestrictions)

#### Test Results

There was no conditional access policy enforcing restrictions for unmanaged devices.

**Learn more**: [https://maester.dev/docs/tests/MT.1019](https://maester.dev/docs/tests/MT.1019)

**Tag**: `Maester` `CA` `Security` `MT.1019`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

It is recommended to exclude directory synchronization accounts from all conditional access policies scoped to all cloud apps.

#### Test Results

This tenant does not have directory synchronization accounts and therefor this test is not applicable.

**Learn more**: [https://maester.dev/docs/tests/MT.1020](https://maester.dev/docs/tests/MT.1020)

**Tag**: `Maester` `CA` `Security` `MT.1020`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1022: All users utilizing a P1 license should be licensed.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks the utilization of Entra ID P1 licenses in the tenant.

#### Test Results

Total users entitled for Entra ID P1: **35**

Total P1 licenses utilized: **0**

**Learn more**: [https://maester.dev/docs/tests/MT.1022](https://maester.dev/docs/tests/MT.1022)

**Tag**: `Entra` `License` `MT.1022`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1023: All users utilizing a P2 license should be licensed.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks the utilization of Entra ID P2 licenses in the tenant.

#### Test Results

Total users entitled for Entra ID P2: **15**

Total P2 licenses utilized: **0**

**Learn more**: [https://maester.dev/docs/tests/MT.1023](https://maester.dev/docs/tests/MT.1023)

**Tag**: `Entra` `License` `MT.1023`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1024.: .

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview



#### Remediation action:



**Impact:** 

#### Related links:

* [ - Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RecommendationDetails.ReactView/recommendationId/)

#### Test Results



‚û°Ô∏è Open [Recommendation - ](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RecommendationDetails.ReactView/recommendationId/) in the Entra admin portal.

*Note: If the recommendation is not applicable for your tenant, it can be marked as **Dismissed** for Maester to skip it in the future.*

**Learn more**: [https://maester.dev/docs/tests/MT.1024](https://maester.dev/docs/tests/MT.1024)

**Tag**: `Maester` `Entra` `Security` `Recommendation` `MT.1024` ``

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-EntraRecommendations.Tests.ps1`

---

### ‚úÖ MT.1025: No external user with permanent role assignment on Control Plane.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


  Take attention on B2B collaboration user with Entra ID directory role assignments on ControlPlane.
  Verify the affected external users, the user source (e.g., MSSP/partner or managing tenant) and if the privileged accounts pass your requirements for Conditional Access, Lifecycle Workflow and Identity Protection.
  Learn more about the best practices for privileges users:
    - [Securing privileged access for hybrid and cloud deployments in Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning#ensure-separate-user-accounts-and-mail-forwarding-for-global-administrator-accounts)

#### Test Results

Well done!

**Learn more**: [https://maester.dev/docs/tests/MT.1025](https://maester.dev/docs/tests/MT.1025)

**Tag**: `Maester` `Privileged` `Security` `MT.1025`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-PrivilegedAssignments.Tests.ps1`

---

### ‚úÖ MT.1026: No hybrid user with permanent role assignment on Control Plane.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


  It's recommended to use cloud-only accounts for privileges with ControlPlane privileges to avoid attack paths from on-premises environment.
  Learn more about the best practices for privileges users:
    - [Securing privileged access for hybrid and cloud deployments in Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning#ensure-separate-user-accounts-and-mail-forwarding-for-global-administrator-accounts)
    - [Protecting Microsoft 365 from on-premises attacks](https://learn.microsoft.com/en-us/entra/architecture/protect-m365-from-on-premises-attacks#isolate-privileged-identities)
  

#### Test Results

Well done!

**Learn more**: [https://maester.dev/docs/tests/MT.1026](https://maester.dev/docs/tests/MT.1026)

**Tag**: `Maester` `Privileged` `Security` `MT.1026`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-PrivilegedAssignments.Tests.ps1`

---

### ‚úÖ MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


  Review your Service Principals with Client Secrets and ControlPlane privileges.
  It's recommended to use certificates for Service Principals. Review if you can replace client secrets by certificates or use managed identities instead of a Service Principal.
  Learn more about the best practices for issuing certificates for Service Principals:
    - [Securing service principals in Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/architecture/service-accounts-principal#service-principal-authentication)
    - [Best practices for all isolation architectures - Service Principal Credentials](https://learn.microsoft.com/en-us/entra/architecture/secure-best-practices#service-principals-credentials)
  

#### Test Results

Well done!

**Learn more**: [https://maester.dev/docs/tests/MT.1027](https://maester.dev/docs/tests/MT.1027)

**Tag**: `Maester` `Privileged` `Security` `MT.1027`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-PrivilegedAssignments.Tests.ps1`

---

### ‚úÖ MT.1028: No user with mailbox and permanent role assignment on Control Plane.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview


  Take attention on mail-enabled administrative accounts with ControlPlane privileges.
  It's recommended to use mail forwarding to regular work account which allows to avoid direct mail access and phishing attacks on privileged user.
  Learn more about the best practices for securing privileged user accounts:
    - [Securing privileged access for hybrid and cloud deployments in Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning#ensure-separate-user-accounts-and-mail-forwarding-for-global-administrator-accounts)
  

#### Test Results

Well done!

**Learn more**: [https://maester.dev/docs/tests/MT.1028](https://maester.dev/docs/tests/MT.1028)

**Tag**: `Maester` `Privileged` `Security` `MT.1028`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-PrivilegedAssignments.Tests.ps1`

---

### ‚úÖ MT.1029: Stale accounts are not assigned to privileged roles.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview



**Security Impact**


Accounts in a privileged role have not signed in recently. These accounts might be service or shared accounts that aren't being maintained and are vulnerable to attackers.

**Mitigation steps**


Review the accounts in the list. If they no longer need access, remove them from their privileged roles.

**How to prevent**


Regularly review accounts with privileged roles using [access reviews](https://docs.microsoft.com/en-us/azure/active-directory/governance/access-reviews-overview) and remove role assignments which are no longer needed.


#### Test Results

All privileged role assignments are managed by PIM. Well done!

**Learn more**: [https://maester.dev/docs/tests/MT.1029](https://maester.dev/docs/tests/MT.1029)

**Tag**: `Privileged` `Security` `PIM` `MT.1029`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-PrivilegedAssignments.Tests.ps1`

---

### ‚úÖ MT.1030: Eligible role assignments on Control Plane are in use by administrators.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview



**Security Impact**


Users that have been assigned privileged roles they don't need increases the chance of an attack. It is also easier for attackers to remain unnoticed in accounts that are not actively being used.

**Mitigation steps**


Review the users in the list and remove them from privileged roles they do not need.

**How to prevent**


¬∑Assign privileged roles to users that have a business justification.
¬∑Schedule regular access reviews to verify that users still need their access.


#### Test Results

All privileged role assignments are managed by PIM. Well done!

**Learn more**: [https://maester.dev/docs/tests/MT.1030](https://maester.dev/docs/tests/MT.1030)

**Tag**: `Privileged` `Security` `PIM` `MT.1030`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-PrivilegedAssignments.Tests.ps1`

---

### ‚úÖ MT.1031: Privileged role on Control Plane are managed by PIM only.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview



**Security Impact**


Privileged role assignments made outside of Privileged Identity Management are not properly monitored and may indicate an active attack.

**Mitigation steps**


Review the users in the list and remove them from privileged roles assigned outside of PIM.

**How to prevent**


Investigate where users are being assigned privileged roles outside of Privileged Identity Management and prohibit future assignments from there.


#### Test Results

All privileged role assignments are managed by PIM. Well done!

**Learn more**: [https://maester.dev/docs/tests/MT.1031](https://maester.dev/docs/tests/MT.1031)

**Tag**: `Privileged` `Security` `PIM` `MT.1031`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-PrivilegedAssignments.Tests.ps1`

---

### ‚úÖ MT.1032: Limited number of Global Admins are assigned.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview



**Security Impact**


Global administrator is the highest privileged role. If a Global Administrator is compromised, the attacker gains access to all of their permissions, which puts your whole system at risk.

**Mitigation steps**


¬∑Review the users in the list and remove any that do not absolutely need the Global Administrator role.
¬∑Assign lower privileged roles to these users instead.

**How to prevent**


Assign users the least privileged role they need.


#### Test Results

All privileged role assignments are managed by PIM. Well done!

**Learn more**: [https://maester.dev/docs/tests/MT.1032](https://maester.dev/docs/tests/MT.1032)

**Tag**: `Privileged` `Security` `PIM` `MT.1032`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-PrivilegedAssignments.Tests.ps1`

---

### ‚úÖ MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Security Groups will be used to exclude and include users from Conditional Access Policies. Modify group membership outside of Conditional Access Administrator or other privileged roles can lead to bypassing Conditional Access Policies.

To prevent this, you can protect these groups by using Restricted Management Administrative Units or Role Assignable Groups. Role Assignable Group should be used in combination of assignments to Entra ID roles. Restricted Management Administrative Units should be used to protect groups by restricting management to specific users or groups. This test checks if all groups used in Conditional Access Policies are protected.

See [Restricted management administrative units in Microsoft Entra ID - Microsoft Entra ID | Microsoft Learn](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-restricted-management)

#### Test Results

Well done! All security groups with assignment in Conditional Access are protected.

**Learn more**: [https://maester.dev/docs/tests/MT.1035](https://maester.dev/docs/tests/MT.1035)

**Tag**: `Maester` `CA` `Security` `MT.1035`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1036: All excluded objects should have a fallback include in another policy.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

All excluded objects should have a fallback include in another policy

#### Test Results

The following user objects did not have a fallback:


    User: ADM Break Glass01 | Giraffe IT
        > Excluded in policy 'Block Legacy Authentication'
        > Excluded in policy 'Require password change users with High Risk'
        > Excluded in policy 'Block High risk sign ins'
        > Excluded in policy 'Require multifactor authentication for all users'
        > Excluded in policy 'Block authentication flows'
The following role objects did not have a fallback:


    Role: d29b2b05-8046-44ba-8758-1e26182fcf32 (Unable to resolve GUID)


**Learn more**: [https://maester.dev/docs/tests/MT.1036](https://maester.dev/docs/tests/MT.1036)

**Tag**: `Maester` `CA` `Security` `MT.1036`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1037: Only users with Presenter role are allowed to present in Teams meetings

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks the Org-wide default meeting policy is configured to only allow users in the **Presenter** role to request control and share content during meetings.

Restricting who can present limits meeting disruptions and reduces the risk of unwanted or inappropriate content being shared.

#### Remediation action:

To prevent standard attendees from sharing content during Teams meetings:

1. Click here to open [**Org-wide default settings > Meetings**](https://admin.teams.microsoft.com/one-policy/settings/meeting)
   * Or navigate to [Teams Admin Center](https://admin.teams.microsoft.com).
   * Click **Settings & policies > Org-wide default settings > Meetings**.
1. Scroll to the **Content sharing** section.
1. Set **Participants can give or request control** to **Off**.
1. Click Save.

#### Related links

* [Manage meeting policies for content sharing](https://learn.microsoft.com/en-us/microsoftteams/meeting-policies-content-sharing)
* [7 tips for safe online meetings and collaboration with Microsoft Teams - Tip 3: Determine who can present content or share their screen in your Teams meeting](https://techcommunity.microsoft.com/blog/microsoftteamsblog/7-tips-for-safe-online-meetings-and-collaboration-with-microsoft-teams/2072303)



#### Test Results



Well done. Only users in the **Presenter** role are configured to share content during Teams meetings.



**Tag**: `Maester` `Teams` `MeetingPolicy` `MT.1037`

**Category**: `Maester/Teams`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Teams\Test-TeamsMeeting.Tests.ps1`

---

### ‚úÖ MT.1038: Conditional Access policies should not include or exclude deleted groups.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks if there are any Conditional Access policies that target deleted security groups.

This usually happens when a group is deleted but is still referenced in a Conditional Access policy.

Deleted groups in your policy can lead to unexpected gaps. This may result in Conditional Access policies not being applied to the users you intended or the policy not being applied at all.

To fix this issue:

* Open the impacted Conditional access policy.
* If the group is no longer needed, click Save to remove the referenced group from the policy.
* If the group is still needed, update the policy to target a valid group.



#### Test Results



Well done! All Conditional Access policies are targeting active groups.

Note: Names are not available for deleted groups. If the group was deleted in the last 30 days it may be available under [Entra admin centre - Deleted groups](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/GroupsManagementMenuBlade/~/DeletedGroups/menuId/DeletedGroups).



**Learn more**: [https://maester.dev/docs/tests/MT.1038](https://maester.dev/docs/tests/MT.1038)

**Tag**: `Maester` `CA` `Security` `MT.1038`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1039: Ensure MailTips are enabled for end users

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

MailTips SHOULD be enabled for end users

Rationale: MailTips assist end users with identifying strange patterns in emails they send, helping prevent accidental data leakage and improving overall email security awareness.

#### Remediation action:

1. Connect to Exchange Online:
```powershell
Connect-ExchangeOnline
```

2. Enable MailTips for external recipients:
```powershell
Set-OrganizationConfig -MailTipsExternalRecipientsTipsEnabled $true
```

3. Verify the setting:
```powershell
(Get-OrganizationConfig).MailTipsExternalRecipientsTipsEnabled
```
The result should be `True`.

#### Related links

* [MailTips in Exchange Online](https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/mailtips/mailtips)
* [Microsoft Secure Score - Enable MailTips](https://security.microsoft.com/securescore)



#### Test Results


Well done. `MailTipsExternalRecipientsTipsEnabled` is `True`



**Tag**: `Maester` `Exchange` `MT.1039` `MailTipsExternalRecipientsTipsEnabled` `SecureScore`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### ‚úÖ MT.1040: Ensure additional storage providers are restricted in Outlook on the web

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Additional storage providers in Outlook on the web SHOULD be restricted

Rationale: When additional storage providers are enabled, users can connect to third-party cloud storage services directly from Outlook on the web, potentially bypassing your organization's security controls and data protection policies.

#### Remediation action:

1. Connect to Exchange Online:
```powershell
Connect-ExchangeOnline
```

2. List the current OWA mailbox policies:
```powershell
Get-OwaMailboxPolicy | Select-Object Identity, AdditionalStorageProvidersAvailable
```

3. Disable additional storage providers for the default policy:
```powershell
Set-OwaMailboxPolicy -Identity "OwaMailboxPolicy-Default" -AdditionalStorageProvidersAvailable $false
```

4. Verify the setting:
```powershell
(Get-OwaMailboxPolicy -Identity "OwaMailboxPolicy-Default").AdditionalStorageProvidersAvailable
```
The result should be `False`.

#### Related links

* [OWA Mailbox Policy settings in Exchange Online](https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/outlook-on-the-web/mailbox-policies)
* [CIS Microsoft 365 Benchmark - 1.3.7 (L2) Ensure 'third-party storage services' are restricted in 'Microsoft 365 on the web'](https://www.cisecurity.org/benchmark/microsoft_365)
* [Microsoft Secure Score - Restrict third-party storage services](https://security.microsoft.com/securescore)



#### Test Results


Well done. AdditionalStorageProvidersAvailable is `False`



**Tag**: `Maester` `Exchange` `MT.1040` `AdditionalStorageProvidersAvailable` `SecureScore`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### ‚úÖ MT.1041: Ensure users installing Outlook add-ins is not allowed

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Users SHOULD NOT be allowed to install Outlook add-ins

Rationale: When users can install their own Outlook add-ins, it creates security risks. Malicious add-ins could access email content, exploit vulnerabilities, or facilitate data exfiltration through legitimate-looking add-ins.

#### Remediation action:

1. Connect to Exchange Online:
```powershell
Connect-ExchangeOnline
```

2. Get the current role assignment policy:
```powershell
Get-RoleAssignmentPolicy | Where-Object { # <img src="https://maester.dev/img/logo.svg" alt="Maester logo" height="40" width="40" /> Maester Test Results

This is a summary of the test results from the Maester test run.

**Tenant:** Giraffe-it B.V.

**Date:** 12/30/2025 15:59:14

| üî• <br/> Total Tests | ‚úÖ <br/> Passed  | ‚ùå <br/> Failed | üîç <br/> Investigate | ‚ùî <br/> Skipped | ‚ùî <br/> Not Run |
|:-:|:-:|:-:|:-:|:-:|:-:|
| **313** | **208** | **54** | **0** | **29** |**20** |


## Test summary

|Test|Status|
|-|:-:|
| CIS.M365.1.1.1: Ensure Administrative accounts are cloud-only | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.1: Ensure that only organizationally managed/approved public groups exist | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.2: Ensure sign-in to shared mailboxes is blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.1: Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)' | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.3: Ensure 'External sharing' of calendars is not available | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.6: Ensure the customer lockbox feature is enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.2.1.1: Ensure Safe Links for Office Applications is Enabled (Only Checks Priority 0 Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.11: Ensure comprehensive attachment filtering is applied | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.12: Ensure the connection filter IP allow list is not used (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.13: Ensure the connection filter safe list is off (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.2: Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.3: Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.4: Ensure Safe Attachments policy is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.5: Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.6: Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.7: Ensure that an anti-phishing policy has been created (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.9: Ensure that DKIM is enabled for all Exchange Online Domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.4.4: Ensure Zero-hour auto purge for Microsoft Teams is on (Only Checks ZAP is enabled) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.3.1.1: Ensure Microsoft 365 audit log search is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.1.1: Ensure external file sharing in Teams is enabled for only approved cloud storage services | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.2.2: Ensure communication with unmanaged Teams users is disabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.4.1: Ensure all or a majority of third-party and custom apps are blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.5.3: Ensure only people in my org can bypass the lobby | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.8.6.1: Ensure users can report security concerns in Teams to internal destination | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.1.1: Legacy authentication SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.1: Users detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.3: If Microsoft Authenticator is enabled, it SHALL be configured to show login context information. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.7: Managed devices SHOULD be required for authentication. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.8: Managed Devices SHOULD be required to register MFA. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.4.1: Security logs SHALL be sent to the agency's security operations center for monitoring. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.5.1: Only administrators SHALL be allowed to register applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.3: An admin consent workflow SHALL be configured for applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.6.1: User passwords SHALL NOT expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Entra ID directory objects. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.1.1: Automatic forwarding to external domains SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.1: Emails SHALL be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.1: Impersonation protection checks SHOULD be used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.1: IP allow lists SHOULD NOT be created. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.2: Safe lists SHOULD NOT be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.13.1: Mailbox auditing SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.1: A spam filter SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.2: Direct download links SHOULD be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.3: User click tracking SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.16.1: Alerts SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.1: A list of approved IP addresses for sending mail SHALL be maintained. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.3.1: DKIM SHOULD be enabled for all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.1: A DMARC policy SHALL be published for every second-level domain. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.2: The DMARC message rejection option SHALL be p=reject. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.5.1: SMTP AUTH SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.1: Contact folders SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.2: Calendar details SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.7.1: External sender warnings SHALL be implemented. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.8.1: A DLP solution SHALL be used. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.9.1: Emails SHALL be filtered by attachment file types. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.3: Disallowed file types SHALL be determined and enforced. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF01: Authentication Method - FIDO2 security key - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AG01: Authentication Method - General Settings - Manage migration. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP07: Default Authorization Settings - Guest user access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP09: Default Authorization Settings - Allow user consent on risk-based apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT01: Authentication Method - Temporary Access Pass - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AV01: Authentication Method - Voice call - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1001: At least one Conditional Access policy is configured with device compliance. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1002: App management restrictions on applications and service principals is configured and enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1003: At least one Conditional Access policy is configured with All Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1004: At least one Conditional Access policy is configured with All Apps and All Users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1006: At least one Conditional Access policy is configured to require MFA for admins. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1007: At least one Conditional Access policy is configured to require MFA for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1009: At least one Conditional Access policy is configured to block other legacy authentication. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1016: At least one Conditional Access policy is configured to require MFA for guest access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1022: All users utilizing a P1 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1023: All users utilizing a P2 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1024.: . | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1025: No external user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1026: No hybrid user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1028: No user with mailbox and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1029: Stale accounts are not assigned to privileged roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1030: Eligible role assignments on Control Plane are in use by administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1031: Privileged role on Control Plane are managed by PIM only. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1032: Limited number of Global Admins are assigned. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1036: All excluded objects should have a fallback include in another policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1037: Only users with Presenter role are allowed to present in Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1038: Conditional Access policies should not include or exclude deleted groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1039: Ensure MailTips are enabled for end users | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1040: Ensure additional storage providers are restricted in Outlook on the web | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1041: Ensure users installing Outlook add-ins is not allowed | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1042: Restrict dial-in users from bypassing a meeting lobby  | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1043: Ensure Spam confidence level (SCL) is configured in mail transport rules with specific domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1044: Ensure modern authentication for Exchange Online is enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1045: Only invited users should be automatically admitted to Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1046: Restrict anonymous users from joining meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1047: Restrict anonymous users from starting Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1048: Limit external participants from having control in a Teams meeting | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1049: Conditional Access policies for User Risk and Sign-in Risk should be configured separately. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1052: At least one Conditional Access policy is targeting the Device Code authentication flow. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1053: Ensure intune device clean-up rule is configured | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1054: Ensure built-in Device Compliance Policy marks devices with no compliance policy assigned as 'Not compliant' | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1055: Microsoft 365 Group (and Team) creation should be restricted to approved users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1056: Ensure that no person has permanent access to all Azure subscriptions at the root scope | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1061: Device registration MFA control conflicts with Conditional Access policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1062: Ensure Direct Send is set to be rejected | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1065: Ensure all Recovery Services Vaults have soft delete enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1066: Conditional Access policies should not reference non-existent users, groups, or roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1067: Authentication method policies should not reference non-existent groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1068: Restrict non-admin users from creating tenants. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1069: Restrict non-admin users from creating security groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1070: Restrict device join to selected users/groups or none. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1071: At least one Conditional Access policy explicitly includes Azure DevOps. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1072: Conditional access policies should not use the deprecated Approved Client App grant. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1085: Pending approvals for Critical Asset Management should not be present. |  |
| MT.1090: Global administrator role should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1091: Registering user should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1096: Ensure at least one Intune Multi Admin Approval policy is configured | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1098: Mobile Threat Defense Connectors should be healthy | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1099: Windows Diagnostic Data Processing should be enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1100: Intune Diagnostic Settings should include Audit Logs | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1101: Default Branding Profile should be customized | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1102: Windows Feature Update Policy Settings should not reference end of support builds | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1103: Ensure Intune RBAC groups are protected by Restricted Management Administrative Units or Role Assignable groups | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1105: Ensure MDM Authority is set to Intune | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.100: Bulk Complaint Level threshold is between 4 and 6. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.101: Bulk is marked as spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.102: Advanced Spam filter options are turned off. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.103: Outbound spam filter policy settings configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.104: High Confidence Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.105: Safe Links Synchronous URL detonation is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.106: Quarantine retention period is 30 days. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.107: End-user spam notification is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108: DKIM signing is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108.1: DNS Records have been set up to support DKIM. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.109: Senders are not being allow listed in an unsafe manner. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.110: Internal Sender notifications are disabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.111: Anti-phishing policy exists and EnableUnauthenticatedSender is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.112: Anti-spoofing protection action is configured to Move message to the recipients' Junk Email folders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.113: AllowClickThrough is disabled in Safe Links policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.114: No IP Allow Lists have been configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.115: Mailbox intelligence based impersonation protection is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.116: Mailbox intelligence based impersonation protection action set to move message to junk mail folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.1: Domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.2: Domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.3: Your own domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.4: Your own domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.119: Similar Domains Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.1: Zero Hour Autopurge Enabled for Phish. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.2: Zero Hour Autopurge Enabled for Malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.3: Zero Hour Autopurge Enabled for Spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.121: Supported filter policy action used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.123: Unusual Characters Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.124: Safe attachments unknown malware response set to block messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.139: Spam action set to move message to junk mail folder or quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.140: High Confidence Spam action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.141: Bulk action set to Move message to Junk Email Folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.142: Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.156: Safe Links Policies are tracking when user clicks on safe links. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.158: Safe Attachments is enabled for SharePoint and Teams. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.179: Safe Links is enabled intra-organization. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.180: Anti-phishing policy exists and EnableSpoofIntelligence is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189: Safe Attachments is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189.2: Safe Links is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.205: Common attachment type filter is enabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.220: Advanced Phish filter Threshold level is adequate. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.221: Mailbox intelligence is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.222: Domain Impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.223: User impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.224: Similar Users Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.225: Safe Documents is enabled for Office clients. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.226: Each domain has a Safe Link policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.227: Each domain has a Safe Attachments policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.228: No trusted senders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.229: No trusted domains in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.230: Each domain has a Anti-phishing policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.231: Each domain has a anti-spam policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.232: Each domain has a malware filter policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233: Domains are pointed directly at EOP or enhanced filtering is used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233.1: Domains are pointed directly at EOP or enhanced filtering is configured on all default connectors. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.234: Click through is disabled for Safe Documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.235: SPF records is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.236: Safe Links is enabled for emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.237: Safe Links is enabled for teams messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.238: Safe Links is enabled for office documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.239: No exclusions for the built-in protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.240: Outlook is configured to display external tags for external emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.241: Anti-phishing policy exists and EnableFirstContactSafetyTips is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.242: Important protection alerts responsible for AIR activities are enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.243: Authenticated Receive Chain is set up for domains not pointing to EOP/MDO, or all domains point to EOP/MDO. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.244: Policies are configured to honor sending domains DMARC. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.1.3: Ensure that between two and four global admins are designated | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C). | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.4.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.8.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.9.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AS04: Authentication Method - SMS - Use for sign-in. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1021: Security Defaults are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1033.0: User should be blocked from using legacy authentication (Sander.breijer@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.1: User should be blocked from using legacy authentication (Adriaan.de.koning@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.2: User should be blocked from using legacy authentication (Michel.Melk@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.3: User should be blocked from using legacy authentication (Website@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.4: User should be blocked from using legacy authentication (Info@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1050: Apps with high-risk permissions having a direct path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1051: Apps with high-risk permissions having an indirect path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1057: App registrations should no longer use secrets. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1058: Exchange application access policies must be configured. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1063: All App registration owners should have MFA registered | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1064: Ensure that write permissions are required to create new management groups | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1073: Soft- and hard-matching of synchronized objects should be blocked. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1074: Ensure no more then 100 outbound mails per day are send using the .onmicrosoft.com domain |  |
| MT.1075: Require explicit assignment of Third Party Entra Apps. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1076: MOERA SHOULD NOT be used for sent mail | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1077: App registrations with privileged API permissions should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1078: App registrations with highly privileged directory roles should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1079: Privileged API permissions on service principals should not remain unused. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1080: Credentials, tokens, or cookies from highly privileged users should not be exposed on vulnerable endpoints. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1081: Hybrid users should not be assigned Entra ID role assignments. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1083: Ensure Delicensing Resiliency is enabled | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1084: Microsoft Entra seamless single sign-on should be disabled for all domains in EntraID Connect servers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1086: Devices should not share both critical and non-critical user credentials. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1087: Devices should not be publicly exposed with remotely exploitable, highly likely to be exploited, high or critical severity CVE's. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1088: Devices with critical credentials should be protected by TPM. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1089: Devices with critical credentials should be protected by Credential Guard. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1092: Intune APNS certificate should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1093: Apple Automated Device Enrollment Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1094: Apple Volume Purchase Program Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1095: Android Enterprise account connection should be healthy | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1097: Ensure all Intune Certificate Connectors are healthy and running supported versions | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| ORCA.143: Safety Tips are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |


## Test details

%TestDetails%

___
Maester 2.0.0
.IsDefault }
```

3. Check which app-related roles are assigned:
```powershell
Get-ManagementRoleAssignment -RoleAssignee "Default Role Assignment Policy" | Where-Object { # <img src="https://maester.dev/img/logo.svg" alt="Maester logo" height="40" width="40" /> Maester Test Results

This is a summary of the test results from the Maester test run.

**Tenant:** Giraffe-it B.V.

**Date:** 12/30/2025 15:59:14

| üî• <br/> Total Tests | ‚úÖ <br/> Passed  | ‚ùå <br/> Failed | üîç <br/> Investigate | ‚ùî <br/> Skipped | ‚ùî <br/> Not Run |
|:-:|:-:|:-:|:-:|:-:|:-:|
| **313** | **208** | **54** | **0** | **29** |**20** |


## Test summary

|Test|Status|
|-|:-:|
| CIS.M365.1.1.1: Ensure Administrative accounts are cloud-only | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.1: Ensure that only organizationally managed/approved public groups exist | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.2: Ensure sign-in to shared mailboxes is blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.1: Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)' | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.3: Ensure 'External sharing' of calendars is not available | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.6: Ensure the customer lockbox feature is enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.2.1.1: Ensure Safe Links for Office Applications is Enabled (Only Checks Priority 0 Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.11: Ensure comprehensive attachment filtering is applied | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.12: Ensure the connection filter IP allow list is not used (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.13: Ensure the connection filter safe list is off (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.2: Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.3: Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.4: Ensure Safe Attachments policy is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.5: Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.6: Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.7: Ensure that an anti-phishing policy has been created (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.9: Ensure that DKIM is enabled for all Exchange Online Domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.4.4: Ensure Zero-hour auto purge for Microsoft Teams is on (Only Checks ZAP is enabled) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.3.1.1: Ensure Microsoft 365 audit log search is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.1.1: Ensure external file sharing in Teams is enabled for only approved cloud storage services | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.2.2: Ensure communication with unmanaged Teams users is disabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.4.1: Ensure all or a majority of third-party and custom apps are blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.5.3: Ensure only people in my org can bypass the lobby | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.8.6.1: Ensure users can report security concerns in Teams to internal destination | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.1.1: Legacy authentication SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.1: Users detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.3: If Microsoft Authenticator is enabled, it SHALL be configured to show login context information. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.7: Managed devices SHOULD be required for authentication. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.8: Managed Devices SHOULD be required to register MFA. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.4.1: Security logs SHALL be sent to the agency's security operations center for monitoring. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.5.1: Only administrators SHALL be allowed to register applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.3: An admin consent workflow SHALL be configured for applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.6.1: User passwords SHALL NOT expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Entra ID directory objects. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.1.1: Automatic forwarding to external domains SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.1: Emails SHALL be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.1: Impersonation protection checks SHOULD be used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.1: IP allow lists SHOULD NOT be created. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.2: Safe lists SHOULD NOT be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.13.1: Mailbox auditing SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.1: A spam filter SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.2: Direct download links SHOULD be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.3: User click tracking SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.16.1: Alerts SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.1: A list of approved IP addresses for sending mail SHALL be maintained. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.3.1: DKIM SHOULD be enabled for all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.1: A DMARC policy SHALL be published for every second-level domain. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.2: The DMARC message rejection option SHALL be p=reject. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.5.1: SMTP AUTH SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.1: Contact folders SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.2: Calendar details SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.7.1: External sender warnings SHALL be implemented. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.8.1: A DLP solution SHALL be used. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.9.1: Emails SHALL be filtered by attachment file types. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.3: Disallowed file types SHALL be determined and enforced. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF01: Authentication Method - FIDO2 security key - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AG01: Authentication Method - General Settings - Manage migration. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP07: Default Authorization Settings - Guest user access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP09: Default Authorization Settings - Allow user consent on risk-based apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT01: Authentication Method - Temporary Access Pass - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AV01: Authentication Method - Voice call - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1001: At least one Conditional Access policy is configured with device compliance. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1002: App management restrictions on applications and service principals is configured and enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1003: At least one Conditional Access policy is configured with All Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1004: At least one Conditional Access policy is configured with All Apps and All Users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1006: At least one Conditional Access policy is configured to require MFA for admins. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1007: At least one Conditional Access policy is configured to require MFA for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1009: At least one Conditional Access policy is configured to block other legacy authentication. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1016: At least one Conditional Access policy is configured to require MFA for guest access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1022: All users utilizing a P1 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1023: All users utilizing a P2 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1024.: . | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1025: No external user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1026: No hybrid user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1028: No user with mailbox and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1029: Stale accounts are not assigned to privileged roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1030: Eligible role assignments on Control Plane are in use by administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1031: Privileged role on Control Plane are managed by PIM only. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1032: Limited number of Global Admins are assigned. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1036: All excluded objects should have a fallback include in another policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1037: Only users with Presenter role are allowed to present in Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1038: Conditional Access policies should not include or exclude deleted groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1039: Ensure MailTips are enabled for end users | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1040: Ensure additional storage providers are restricted in Outlook on the web | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1041: Ensure users installing Outlook add-ins is not allowed | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1042: Restrict dial-in users from bypassing a meeting lobby  | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1043: Ensure Spam confidence level (SCL) is configured in mail transport rules with specific domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1044: Ensure modern authentication for Exchange Online is enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1045: Only invited users should be automatically admitted to Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1046: Restrict anonymous users from joining meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1047: Restrict anonymous users from starting Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1048: Limit external participants from having control in a Teams meeting | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1049: Conditional Access policies for User Risk and Sign-in Risk should be configured separately. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1052: At least one Conditional Access policy is targeting the Device Code authentication flow. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1053: Ensure intune device clean-up rule is configured | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1054: Ensure built-in Device Compliance Policy marks devices with no compliance policy assigned as 'Not compliant' | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1055: Microsoft 365 Group (and Team) creation should be restricted to approved users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1056: Ensure that no person has permanent access to all Azure subscriptions at the root scope | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1061: Device registration MFA control conflicts with Conditional Access policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1062: Ensure Direct Send is set to be rejected | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1065: Ensure all Recovery Services Vaults have soft delete enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1066: Conditional Access policies should not reference non-existent users, groups, or roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1067: Authentication method policies should not reference non-existent groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1068: Restrict non-admin users from creating tenants. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1069: Restrict non-admin users from creating security groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1070: Restrict device join to selected users/groups or none. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1071: At least one Conditional Access policy explicitly includes Azure DevOps. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1072: Conditional access policies should not use the deprecated Approved Client App grant. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1085: Pending approvals for Critical Asset Management should not be present. |  |
| MT.1090: Global administrator role should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1091: Registering user should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1096: Ensure at least one Intune Multi Admin Approval policy is configured | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1098: Mobile Threat Defense Connectors should be healthy | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1099: Windows Diagnostic Data Processing should be enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1100: Intune Diagnostic Settings should include Audit Logs | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1101: Default Branding Profile should be customized | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1102: Windows Feature Update Policy Settings should not reference end of support builds | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1103: Ensure Intune RBAC groups are protected by Restricted Management Administrative Units or Role Assignable groups | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1105: Ensure MDM Authority is set to Intune | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.100: Bulk Complaint Level threshold is between 4 and 6. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.101: Bulk is marked as spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.102: Advanced Spam filter options are turned off. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.103: Outbound spam filter policy settings configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.104: High Confidence Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.105: Safe Links Synchronous URL detonation is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.106: Quarantine retention period is 30 days. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.107: End-user spam notification is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108: DKIM signing is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108.1: DNS Records have been set up to support DKIM. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.109: Senders are not being allow listed in an unsafe manner. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.110: Internal Sender notifications are disabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.111: Anti-phishing policy exists and EnableUnauthenticatedSender is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.112: Anti-spoofing protection action is configured to Move message to the recipients' Junk Email folders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.113: AllowClickThrough is disabled in Safe Links policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.114: No IP Allow Lists have been configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.115: Mailbox intelligence based impersonation protection is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.116: Mailbox intelligence based impersonation protection action set to move message to junk mail folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.1: Domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.2: Domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.3: Your own domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.4: Your own domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.119: Similar Domains Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.1: Zero Hour Autopurge Enabled for Phish. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.2: Zero Hour Autopurge Enabled for Malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.3: Zero Hour Autopurge Enabled for Spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.121: Supported filter policy action used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.123: Unusual Characters Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.124: Safe attachments unknown malware response set to block messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.139: Spam action set to move message to junk mail folder or quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.140: High Confidence Spam action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.141: Bulk action set to Move message to Junk Email Folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.142: Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.156: Safe Links Policies are tracking when user clicks on safe links. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.158: Safe Attachments is enabled for SharePoint and Teams. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.179: Safe Links is enabled intra-organization. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.180: Anti-phishing policy exists and EnableSpoofIntelligence is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189: Safe Attachments is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189.2: Safe Links is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.205: Common attachment type filter is enabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.220: Advanced Phish filter Threshold level is adequate. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.221: Mailbox intelligence is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.222: Domain Impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.223: User impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.224: Similar Users Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.225: Safe Documents is enabled for Office clients. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.226: Each domain has a Safe Link policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.227: Each domain has a Safe Attachments policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.228: No trusted senders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.229: No trusted domains in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.230: Each domain has a Anti-phishing policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.231: Each domain has a anti-spam policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.232: Each domain has a malware filter policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233: Domains are pointed directly at EOP or enhanced filtering is used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233.1: Domains are pointed directly at EOP or enhanced filtering is configured on all default connectors. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.234: Click through is disabled for Safe Documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.235: SPF records is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.236: Safe Links is enabled for emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.237: Safe Links is enabled for teams messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.238: Safe Links is enabled for office documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.239: No exclusions for the built-in protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.240: Outlook is configured to display external tags for external emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.241: Anti-phishing policy exists and EnableFirstContactSafetyTips is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.242: Important protection alerts responsible for AIR activities are enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.243: Authenticated Receive Chain is set up for domains not pointing to EOP/MDO, or all domains point to EOP/MDO. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.244: Policies are configured to honor sending domains DMARC. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.1.3: Ensure that between two and four global admins are designated | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C). | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.4.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.8.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.9.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AS04: Authentication Method - SMS - Use for sign-in. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1021: Security Defaults are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1033.0: User should be blocked from using legacy authentication (Sander.breijer@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.1: User should be blocked from using legacy authentication (Adriaan.de.koning@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.2: User should be blocked from using legacy authentication (Michel.Melk@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.3: User should be blocked from using legacy authentication (Website@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.4: User should be blocked from using legacy authentication (Info@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1050: Apps with high-risk permissions having a direct path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1051: Apps with high-risk permissions having an indirect path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1057: App registrations should no longer use secrets. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1058: Exchange application access policies must be configured. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1063: All App registration owners should have MFA registered | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1064: Ensure that write permissions are required to create new management groups | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1073: Soft- and hard-matching of synchronized objects should be blocked. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1074: Ensure no more then 100 outbound mails per day are send using the .onmicrosoft.com domain |  |
| MT.1075: Require explicit assignment of Third Party Entra Apps. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1076: MOERA SHOULD NOT be used for sent mail | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1077: App registrations with privileged API permissions should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1078: App registrations with highly privileged directory roles should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1079: Privileged API permissions on service principals should not remain unused. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1080: Credentials, tokens, or cookies from highly privileged users should not be exposed on vulnerable endpoints. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1081: Hybrid users should not be assigned Entra ID role assignments. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1083: Ensure Delicensing Resiliency is enabled | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1084: Microsoft Entra seamless single sign-on should be disabled for all domains in EntraID Connect servers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1086: Devices should not share both critical and non-critical user credentials. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1087: Devices should not be publicly exposed with remotely exploitable, highly likely to be exploited, high or critical severity CVE's. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1088: Devices with critical credentials should be protected by TPM. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1089: Devices with critical credentials should be protected by Credential Guard. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1092: Intune APNS certificate should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1093: Apple Automated Device Enrollment Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1094: Apple Volume Purchase Program Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1095: Android Enterprise account connection should be healthy | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1097: Ensure all Intune Certificate Connectors are healthy and running supported versions | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| ORCA.143: Safety Tips are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |


## Test details

%TestDetails%

___
Maester 2.0.0
.Role -like "My*Apps" }
```

4. Remove the app installation permissions from the default policy:
```powershell
Get-ManagementRoleAssignment -RoleAssignee "Default Role Assignment Policy" | Where-Object { # <img src="https://maester.dev/img/logo.svg" alt="Maester logo" height="40" width="40" /> Maester Test Results

This is a summary of the test results from the Maester test run.

**Tenant:** Giraffe-it B.V.

**Date:** 12/30/2025 15:59:14

| üî• <br/> Total Tests | ‚úÖ <br/> Passed  | ‚ùå <br/> Failed | üîç <br/> Investigate | ‚ùî <br/> Skipped | ‚ùî <br/> Not Run |
|:-:|:-:|:-:|:-:|:-:|:-:|
| **313** | **208** | **54** | **0** | **29** |**20** |


## Test summary

|Test|Status|
|-|:-:|
| CIS.M365.1.1.1: Ensure Administrative accounts are cloud-only | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.1: Ensure that only organizationally managed/approved public groups exist | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.2: Ensure sign-in to shared mailboxes is blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.1: Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)' | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.3: Ensure 'External sharing' of calendars is not available | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.6: Ensure the customer lockbox feature is enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.2.1.1: Ensure Safe Links for Office Applications is Enabled (Only Checks Priority 0 Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.11: Ensure comprehensive attachment filtering is applied | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.12: Ensure the connection filter IP allow list is not used (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.13: Ensure the connection filter safe list is off (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.2: Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.3: Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.4: Ensure Safe Attachments policy is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.5: Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.6: Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.7: Ensure that an anti-phishing policy has been created (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.9: Ensure that DKIM is enabled for all Exchange Online Domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.4.4: Ensure Zero-hour auto purge for Microsoft Teams is on (Only Checks ZAP is enabled) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.3.1.1: Ensure Microsoft 365 audit log search is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.1.1: Ensure external file sharing in Teams is enabled for only approved cloud storage services | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.2.2: Ensure communication with unmanaged Teams users is disabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.4.1: Ensure all or a majority of third-party and custom apps are blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.5.3: Ensure only people in my org can bypass the lobby | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.8.6.1: Ensure users can report security concerns in Teams to internal destination | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.1.1: Legacy authentication SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.1: Users detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.3: If Microsoft Authenticator is enabled, it SHALL be configured to show login context information. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.7: Managed devices SHOULD be required for authentication. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.8: Managed Devices SHOULD be required to register MFA. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.4.1: Security logs SHALL be sent to the agency's security operations center for monitoring. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.5.1: Only administrators SHALL be allowed to register applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.3: An admin consent workflow SHALL be configured for applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.6.1: User passwords SHALL NOT expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Entra ID directory objects. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.1.1: Automatic forwarding to external domains SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.1: Emails SHALL be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.1: Impersonation protection checks SHOULD be used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.1: IP allow lists SHOULD NOT be created. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.2: Safe lists SHOULD NOT be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.13.1: Mailbox auditing SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.1: A spam filter SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.2: Direct download links SHOULD be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.3: User click tracking SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.16.1: Alerts SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.1: A list of approved IP addresses for sending mail SHALL be maintained. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.3.1: DKIM SHOULD be enabled for all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.1: A DMARC policy SHALL be published for every second-level domain. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.2: The DMARC message rejection option SHALL be p=reject. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.5.1: SMTP AUTH SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.1: Contact folders SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.2: Calendar details SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.7.1: External sender warnings SHALL be implemented. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.8.1: A DLP solution SHALL be used. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.9.1: Emails SHALL be filtered by attachment file types. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.3: Disallowed file types SHALL be determined and enforced. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF01: Authentication Method - FIDO2 security key - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AG01: Authentication Method - General Settings - Manage migration. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP07: Default Authorization Settings - Guest user access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP09: Default Authorization Settings - Allow user consent on risk-based apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT01: Authentication Method - Temporary Access Pass - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AV01: Authentication Method - Voice call - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1001: At least one Conditional Access policy is configured with device compliance. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1002: App management restrictions on applications and service principals is configured and enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1003: At least one Conditional Access policy is configured with All Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1004: At least one Conditional Access policy is configured with All Apps and All Users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1006: At least one Conditional Access policy is configured to require MFA for admins. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1007: At least one Conditional Access policy is configured to require MFA for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1009: At least one Conditional Access policy is configured to block other legacy authentication. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1016: At least one Conditional Access policy is configured to require MFA for guest access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1022: All users utilizing a P1 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1023: All users utilizing a P2 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1024.: . | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1025: No external user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1026: No hybrid user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1028: No user with mailbox and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1029: Stale accounts are not assigned to privileged roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1030: Eligible role assignments on Control Plane are in use by administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1031: Privileged role on Control Plane are managed by PIM only. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1032: Limited number of Global Admins are assigned. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1036: All excluded objects should have a fallback include in another policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1037: Only users with Presenter role are allowed to present in Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1038: Conditional Access policies should not include or exclude deleted groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1039: Ensure MailTips are enabled for end users | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1040: Ensure additional storage providers are restricted in Outlook on the web | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1041: Ensure users installing Outlook add-ins is not allowed | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1042: Restrict dial-in users from bypassing a meeting lobby  | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1043: Ensure Spam confidence level (SCL) is configured in mail transport rules with specific domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1044: Ensure modern authentication for Exchange Online is enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1045: Only invited users should be automatically admitted to Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1046: Restrict anonymous users from joining meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1047: Restrict anonymous users from starting Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1048: Limit external participants from having control in a Teams meeting | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1049: Conditional Access policies for User Risk and Sign-in Risk should be configured separately. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1052: At least one Conditional Access policy is targeting the Device Code authentication flow. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1053: Ensure intune device clean-up rule is configured | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1054: Ensure built-in Device Compliance Policy marks devices with no compliance policy assigned as 'Not compliant' | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1055: Microsoft 365 Group (and Team) creation should be restricted to approved users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1056: Ensure that no person has permanent access to all Azure subscriptions at the root scope | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1061: Device registration MFA control conflicts with Conditional Access policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1062: Ensure Direct Send is set to be rejected | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1065: Ensure all Recovery Services Vaults have soft delete enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1066: Conditional Access policies should not reference non-existent users, groups, or roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1067: Authentication method policies should not reference non-existent groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1068: Restrict non-admin users from creating tenants. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1069: Restrict non-admin users from creating security groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1070: Restrict device join to selected users/groups or none. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1071: At least one Conditional Access policy explicitly includes Azure DevOps. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1072: Conditional access policies should not use the deprecated Approved Client App grant. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1085: Pending approvals for Critical Asset Management should not be present. |  |
| MT.1090: Global administrator role should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1091: Registering user should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1096: Ensure at least one Intune Multi Admin Approval policy is configured | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1098: Mobile Threat Defense Connectors should be healthy | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1099: Windows Diagnostic Data Processing should be enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1100: Intune Diagnostic Settings should include Audit Logs | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1101: Default Branding Profile should be customized | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1102: Windows Feature Update Policy Settings should not reference end of support builds | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1103: Ensure Intune RBAC groups are protected by Restricted Management Administrative Units or Role Assignable groups | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1105: Ensure MDM Authority is set to Intune | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.100: Bulk Complaint Level threshold is between 4 and 6. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.101: Bulk is marked as spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.102: Advanced Spam filter options are turned off. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.103: Outbound spam filter policy settings configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.104: High Confidence Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.105: Safe Links Synchronous URL detonation is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.106: Quarantine retention period is 30 days. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.107: End-user spam notification is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108: DKIM signing is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108.1: DNS Records have been set up to support DKIM. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.109: Senders are not being allow listed in an unsafe manner. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.110: Internal Sender notifications are disabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.111: Anti-phishing policy exists and EnableUnauthenticatedSender is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.112: Anti-spoofing protection action is configured to Move message to the recipients' Junk Email folders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.113: AllowClickThrough is disabled in Safe Links policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.114: No IP Allow Lists have been configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.115: Mailbox intelligence based impersonation protection is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.116: Mailbox intelligence based impersonation protection action set to move message to junk mail folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.1: Domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.2: Domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.3: Your own domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.4: Your own domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.119: Similar Domains Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.1: Zero Hour Autopurge Enabled for Phish. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.2: Zero Hour Autopurge Enabled for Malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.3: Zero Hour Autopurge Enabled for Spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.121: Supported filter policy action used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.123: Unusual Characters Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.124: Safe attachments unknown malware response set to block messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.139: Spam action set to move message to junk mail folder or quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.140: High Confidence Spam action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.141: Bulk action set to Move message to Junk Email Folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.142: Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.156: Safe Links Policies are tracking when user clicks on safe links. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.158: Safe Attachments is enabled for SharePoint and Teams. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.179: Safe Links is enabled intra-organization. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.180: Anti-phishing policy exists and EnableSpoofIntelligence is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189: Safe Attachments is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189.2: Safe Links is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.205: Common attachment type filter is enabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.220: Advanced Phish filter Threshold level is adequate. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.221: Mailbox intelligence is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.222: Domain Impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.223: User impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.224: Similar Users Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.225: Safe Documents is enabled for Office clients. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.226: Each domain has a Safe Link policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.227: Each domain has a Safe Attachments policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.228: No trusted senders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.229: No trusted domains in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.230: Each domain has a Anti-phishing policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.231: Each domain has a anti-spam policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.232: Each domain has a malware filter policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233: Domains are pointed directly at EOP or enhanced filtering is used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233.1: Domains are pointed directly at EOP or enhanced filtering is configured on all default connectors. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.234: Click through is disabled for Safe Documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.235: SPF records is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.236: Safe Links is enabled for emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.237: Safe Links is enabled for teams messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.238: Safe Links is enabled for office documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.239: No exclusions for the built-in protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.240: Outlook is configured to display external tags for external emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.241: Anti-phishing policy exists and EnableFirstContactSafetyTips is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.242: Important protection alerts responsible for AIR activities are enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.243: Authenticated Receive Chain is set up for domains not pointing to EOP/MDO, or all domains point to EOP/MDO. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.244: Policies are configured to honor sending domains DMARC. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.1.3: Ensure that between two and four global admins are designated | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C). | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.4.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.8.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.9.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AS04: Authentication Method - SMS - Use for sign-in. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1021: Security Defaults are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1033.0: User should be blocked from using legacy authentication (Sander.breijer@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.1: User should be blocked from using legacy authentication (Adriaan.de.koning@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.2: User should be blocked from using legacy authentication (Michel.Melk@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.3: User should be blocked from using legacy authentication (Website@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.4: User should be blocked from using legacy authentication (Info@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1050: Apps with high-risk permissions having a direct path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1051: Apps with high-risk permissions having an indirect path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1057: App registrations should no longer use secrets. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1058: Exchange application access policies must be configured. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1063: All App registration owners should have MFA registered | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1064: Ensure that write permissions are required to create new management groups | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1073: Soft- and hard-matching of synchronized objects should be blocked. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1074: Ensure no more then 100 outbound mails per day are send using the .onmicrosoft.com domain |  |
| MT.1075: Require explicit assignment of Third Party Entra Apps. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1076: MOERA SHOULD NOT be used for sent mail | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1077: App registrations with privileged API permissions should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1078: App registrations with highly privileged directory roles should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1079: Privileged API permissions on service principals should not remain unused. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1080: Credentials, tokens, or cookies from highly privileged users should not be exposed on vulnerable endpoints. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1081: Hybrid users should not be assigned Entra ID role assignments. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1083: Ensure Delicensing Resiliency is enabled | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1084: Microsoft Entra seamless single sign-on should be disabled for all domains in EntraID Connect servers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1086: Devices should not share both critical and non-critical user credentials. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1087: Devices should not be publicly exposed with remotely exploitable, highly likely to be exploited, high or critical severity CVE's. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1088: Devices with critical credentials should be protected by TPM. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1089: Devices with critical credentials should be protected by Credential Guard. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1092: Intune APNS certificate should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1093: Apple Automated Device Enrollment Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1094: Apple Volume Purchase Program Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1095: Android Enterprise account connection should be healthy | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1097: Ensure all Intune Certificate Connectors are healthy and running supported versions | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| ORCA.143: Safety Tips are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |


## Test details

%TestDetails%

___
Maester 2.0.0
.Role -like "My*Apps" } | Remove-ManagementRoleAssignment -Confirm:$false
```

5. Verify the changes:
```powershell
Get-ManagementRoleAssignment -RoleAssignee "Default Role Assignment Policy" | Where-Object { # <img src="https://maester.dev/img/logo.svg" alt="Maester logo" height="40" width="40" /> Maester Test Results

This is a summary of the test results from the Maester test run.

**Tenant:** Giraffe-it B.V.

**Date:** 12/30/2025 15:59:14

| üî• <br/> Total Tests | ‚úÖ <br/> Passed  | ‚ùå <br/> Failed | üîç <br/> Investigate | ‚ùî <br/> Skipped | ‚ùî <br/> Not Run |
|:-:|:-:|:-:|:-:|:-:|:-:|
| **313** | **208** | **54** | **0** | **29** |**20** |


## Test summary

|Test|Status|
|-|:-:|
| CIS.M365.1.1.1: Ensure Administrative accounts are cloud-only | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.1: Ensure that only organizationally managed/approved public groups exist | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.2: Ensure sign-in to shared mailboxes is blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.1: Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)' | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.3: Ensure 'External sharing' of calendars is not available | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.6: Ensure the customer lockbox feature is enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.2.1.1: Ensure Safe Links for Office Applications is Enabled (Only Checks Priority 0 Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.11: Ensure comprehensive attachment filtering is applied | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.12: Ensure the connection filter IP allow list is not used (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.13: Ensure the connection filter safe list is off (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.2: Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.3: Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.4: Ensure Safe Attachments policy is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.5: Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.6: Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.7: Ensure that an anti-phishing policy has been created (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.9: Ensure that DKIM is enabled for all Exchange Online Domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.4.4: Ensure Zero-hour auto purge for Microsoft Teams is on (Only Checks ZAP is enabled) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.3.1.1: Ensure Microsoft 365 audit log search is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.1.1: Ensure external file sharing in Teams is enabled for only approved cloud storage services | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.2.2: Ensure communication with unmanaged Teams users is disabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.4.1: Ensure all or a majority of third-party and custom apps are blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.5.3: Ensure only people in my org can bypass the lobby | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.8.6.1: Ensure users can report security concerns in Teams to internal destination | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.1.1: Legacy authentication SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.1: Users detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.3: If Microsoft Authenticator is enabled, it SHALL be configured to show login context information. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.7: Managed devices SHOULD be required for authentication. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.8: Managed Devices SHOULD be required to register MFA. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.4.1: Security logs SHALL be sent to the agency's security operations center for monitoring. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.5.1: Only administrators SHALL be allowed to register applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.3: An admin consent workflow SHALL be configured for applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.6.1: User passwords SHALL NOT expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Entra ID directory objects. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.1.1: Automatic forwarding to external domains SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.1: Emails SHALL be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.1: Impersonation protection checks SHOULD be used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.1: IP allow lists SHOULD NOT be created. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.2: Safe lists SHOULD NOT be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.13.1: Mailbox auditing SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.1: A spam filter SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.2: Direct download links SHOULD be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.3: User click tracking SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.16.1: Alerts SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.1: A list of approved IP addresses for sending mail SHALL be maintained. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.3.1: DKIM SHOULD be enabled for all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.1: A DMARC policy SHALL be published for every second-level domain. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.2: The DMARC message rejection option SHALL be p=reject. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.5.1: SMTP AUTH SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.1: Contact folders SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.2: Calendar details SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.7.1: External sender warnings SHALL be implemented. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.8.1: A DLP solution SHALL be used. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.9.1: Emails SHALL be filtered by attachment file types. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.3: Disallowed file types SHALL be determined and enforced. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF01: Authentication Method - FIDO2 security key - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AG01: Authentication Method - General Settings - Manage migration. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP07: Default Authorization Settings - Guest user access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP09: Default Authorization Settings - Allow user consent on risk-based apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT01: Authentication Method - Temporary Access Pass - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AV01: Authentication Method - Voice call - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1001: At least one Conditional Access policy is configured with device compliance. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1002: App management restrictions on applications and service principals is configured and enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1003: At least one Conditional Access policy is configured with All Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1004: At least one Conditional Access policy is configured with All Apps and All Users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1006: At least one Conditional Access policy is configured to require MFA for admins. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1007: At least one Conditional Access policy is configured to require MFA for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1009: At least one Conditional Access policy is configured to block other legacy authentication. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1016: At least one Conditional Access policy is configured to require MFA for guest access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1022: All users utilizing a P1 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1023: All users utilizing a P2 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1024.: . | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1025: No external user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1026: No hybrid user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1028: No user with mailbox and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1029: Stale accounts are not assigned to privileged roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1030: Eligible role assignments on Control Plane are in use by administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1031: Privileged role on Control Plane are managed by PIM only. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1032: Limited number of Global Admins are assigned. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1036: All excluded objects should have a fallback include in another policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1037: Only users with Presenter role are allowed to present in Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1038: Conditional Access policies should not include or exclude deleted groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1039: Ensure MailTips are enabled for end users | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1040: Ensure additional storage providers are restricted in Outlook on the web | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1041: Ensure users installing Outlook add-ins is not allowed | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1042: Restrict dial-in users from bypassing a meeting lobby  | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1043: Ensure Spam confidence level (SCL) is configured in mail transport rules with specific domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1044: Ensure modern authentication for Exchange Online is enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1045: Only invited users should be automatically admitted to Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1046: Restrict anonymous users from joining meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1047: Restrict anonymous users from starting Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1048: Limit external participants from having control in a Teams meeting | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1049: Conditional Access policies for User Risk and Sign-in Risk should be configured separately. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1052: At least one Conditional Access policy is targeting the Device Code authentication flow. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1053: Ensure intune device clean-up rule is configured | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1054: Ensure built-in Device Compliance Policy marks devices with no compliance policy assigned as 'Not compliant' | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1055: Microsoft 365 Group (and Team) creation should be restricted to approved users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1056: Ensure that no person has permanent access to all Azure subscriptions at the root scope | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1061: Device registration MFA control conflicts with Conditional Access policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1062: Ensure Direct Send is set to be rejected | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1065: Ensure all Recovery Services Vaults have soft delete enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1066: Conditional Access policies should not reference non-existent users, groups, or roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1067: Authentication method policies should not reference non-existent groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1068: Restrict non-admin users from creating tenants. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1069: Restrict non-admin users from creating security groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1070: Restrict device join to selected users/groups or none. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1071: At least one Conditional Access policy explicitly includes Azure DevOps. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1072: Conditional access policies should not use the deprecated Approved Client App grant. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1085: Pending approvals for Critical Asset Management should not be present. |  |
| MT.1090: Global administrator role should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1091: Registering user should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1096: Ensure at least one Intune Multi Admin Approval policy is configured | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1098: Mobile Threat Defense Connectors should be healthy | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1099: Windows Diagnostic Data Processing should be enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1100: Intune Diagnostic Settings should include Audit Logs | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1101: Default Branding Profile should be customized | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1102: Windows Feature Update Policy Settings should not reference end of support builds | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1103: Ensure Intune RBAC groups are protected by Restricted Management Administrative Units or Role Assignable groups | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1105: Ensure MDM Authority is set to Intune | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.100: Bulk Complaint Level threshold is between 4 and 6. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.101: Bulk is marked as spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.102: Advanced Spam filter options are turned off. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.103: Outbound spam filter policy settings configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.104: High Confidence Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.105: Safe Links Synchronous URL detonation is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.106: Quarantine retention period is 30 days. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.107: End-user spam notification is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108: DKIM signing is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108.1: DNS Records have been set up to support DKIM. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.109: Senders are not being allow listed in an unsafe manner. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.110: Internal Sender notifications are disabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.111: Anti-phishing policy exists and EnableUnauthenticatedSender is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.112: Anti-spoofing protection action is configured to Move message to the recipients' Junk Email folders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.113: AllowClickThrough is disabled in Safe Links policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.114: No IP Allow Lists have been configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.115: Mailbox intelligence based impersonation protection is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.116: Mailbox intelligence based impersonation protection action set to move message to junk mail folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.1: Domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.2: Domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.3: Your own domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.4: Your own domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.119: Similar Domains Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.1: Zero Hour Autopurge Enabled for Phish. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.2: Zero Hour Autopurge Enabled for Malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.3: Zero Hour Autopurge Enabled for Spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.121: Supported filter policy action used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.123: Unusual Characters Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.124: Safe attachments unknown malware response set to block messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.139: Spam action set to move message to junk mail folder or quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.140: High Confidence Spam action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.141: Bulk action set to Move message to Junk Email Folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.142: Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.156: Safe Links Policies are tracking when user clicks on safe links. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.158: Safe Attachments is enabled for SharePoint and Teams. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.179: Safe Links is enabled intra-organization. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.180: Anti-phishing policy exists and EnableSpoofIntelligence is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189: Safe Attachments is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189.2: Safe Links is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.205: Common attachment type filter is enabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.220: Advanced Phish filter Threshold level is adequate. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.221: Mailbox intelligence is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.222: Domain Impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.223: User impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.224: Similar Users Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.225: Safe Documents is enabled for Office clients. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.226: Each domain has a Safe Link policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.227: Each domain has a Safe Attachments policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.228: No trusted senders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.229: No trusted domains in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.230: Each domain has a Anti-phishing policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.231: Each domain has a anti-spam policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.232: Each domain has a malware filter policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233: Domains are pointed directly at EOP or enhanced filtering is used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233.1: Domains are pointed directly at EOP or enhanced filtering is configured on all default connectors. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.234: Click through is disabled for Safe Documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.235: SPF records is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.236: Safe Links is enabled for emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.237: Safe Links is enabled for teams messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.238: Safe Links is enabled for office documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.239: No exclusions for the built-in protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.240: Outlook is configured to display external tags for external emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.241: Anti-phishing policy exists and EnableFirstContactSafetyTips is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.242: Important protection alerts responsible for AIR activities are enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.243: Authenticated Receive Chain is set up for domains not pointing to EOP/MDO, or all domains point to EOP/MDO. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.244: Policies are configured to honor sending domains DMARC. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.1.3: Ensure that between two and four global admins are designated | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C). | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.4.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.8.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.9.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AS04: Authentication Method - SMS - Use for sign-in. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1021: Security Defaults are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1033.0: User should be blocked from using legacy authentication (Sander.breijer@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.1: User should be blocked from using legacy authentication (Adriaan.de.koning@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.2: User should be blocked from using legacy authentication (Michel.Melk@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.3: User should be blocked from using legacy authentication (Website@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.4: User should be blocked from using legacy authentication (Info@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1050: Apps with high-risk permissions having a direct path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1051: Apps with high-risk permissions having an indirect path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1057: App registrations should no longer use secrets. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1058: Exchange application access policies must be configured. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1063: All App registration owners should have MFA registered | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1064: Ensure that write permissions are required to create new management groups | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1073: Soft- and hard-matching of synchronized objects should be blocked. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1074: Ensure no more then 100 outbound mails per day are send using the .onmicrosoft.com domain |  |
| MT.1075: Require explicit assignment of Third Party Entra Apps. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1076: MOERA SHOULD NOT be used for sent mail | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1077: App registrations with privileged API permissions should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1078: App registrations with highly privileged directory roles should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1079: Privileged API permissions on service principals should not remain unused. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1080: Credentials, tokens, or cookies from highly privileged users should not be exposed on vulnerable endpoints. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1081: Hybrid users should not be assigned Entra ID role assignments. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1083: Ensure Delicensing Resiliency is enabled | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1084: Microsoft Entra seamless single sign-on should be disabled for all domains in EntraID Connect servers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1086: Devices should not share both critical and non-critical user credentials. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1087: Devices should not be publicly exposed with remotely exploitable, highly likely to be exploited, high or critical severity CVE's. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1088: Devices with critical credentials should be protected by TPM. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1089: Devices with critical credentials should be protected by Credential Guard. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1092: Intune APNS certificate should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1093: Apple Automated Device Enrollment Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1094: Apple Volume Purchase Program Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1095: Android Enterprise account connection should be healthy | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1097: Ensure all Intune Certificate Connectors are healthy and running supported versions | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| ORCA.143: Safety Tips are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |


## Test details

%TestDetails%

___
Maester 2.0.0
.Role -like "My*Apps" }
```
The result should return no assignments.

#### Related links

* [Role-based access control in Exchange Online](https://learn.microsoft.com/en-us/exchange/permissions-exo/permissions-exo)
* [CIS Microsoft 365 Benchmark - 1.3.4 (L1) Ensure 'User owned apps and services' is restricted](https://www.cisecurity.org/benchmark/microsoft_365)
* [Microsoft Secure Score - Restrict user consent to applications](https://security.microsoft.com/securescore)



#### Test Results


Well done. Apps in 'Default Role Assignment Policy' is `False`



**Tag**: `Maester` `Exchange` `MT.1041` `MyCustomApps` `MyMarketplaceApps` `MyReadWriteMailboxApps` `SecureScore`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### ‚úÖ MT.1042: Restrict dial-in users from bypassing a meeting lobby 

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Dial-in users aren‚Äôt authenticated though the Teams app. Increase the security of your meetings by preventing these unknown users from bypassing the lobby and immediately joining the meeting.

#### Test Results

Well done. AllowPSTNUsersToBypassLobby is False



**Tag**: `Maester` `Teams` `MeetingPolicy` `MT.1042`

**Category**: `Maester/Teams`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Teams\Test-TeamsMeeting.Tests.ps1`

---

### ‚úÖ MT.1043: Ensure Spam confidence level (SCL) is configured in mail transport rules with specific domains

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Spam confidence level (SCL) SHOULD NOT be set to -1 in mail transport rules with specific domains

Rationale: Allow-listing domains in transport rules bypasses regular malware and phishing scanning, which can enable an attacker to launch attacks against your users from a safe haven domain.

#### Remediation action:

1. Connect to Exchange Online:
```powershell
Connect-ExchangeOnline
```

2. View your current transport rules:
```powershell
Get-TransportRule | Select-Object Name, SetScl
```

3. For each transport rule that uses `SetScl -1`, modify it to set SCL to 0 or higher:
```powershell
Set-TransportRule -Identity "RuleName" -SetSCL 0
```

4. Verify the changes:
```powershell
Get-TransportRule | Where-Object { # <img src="https://maester.dev/img/logo.svg" alt="Maester logo" height="40" width="40" /> Maester Test Results

This is a summary of the test results from the Maester test run.

**Tenant:** Giraffe-it B.V.

**Date:** 12/30/2025 15:59:14

| üî• <br/> Total Tests | ‚úÖ <br/> Passed  | ‚ùå <br/> Failed | üîç <br/> Investigate | ‚ùî <br/> Skipped | ‚ùî <br/> Not Run |
|:-:|:-:|:-:|:-:|:-:|:-:|
| **313** | **208** | **54** | **0** | **29** |**20** |


## Test summary

|Test|Status|
|-|:-:|
| CIS.M365.1.1.1: Ensure Administrative accounts are cloud-only | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.1: Ensure that only organizationally managed/approved public groups exist | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.2.2: Ensure sign-in to shared mailboxes is blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.1: Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)' | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.3: Ensure 'External sharing' of calendars is not available | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.3.6: Ensure the customer lockbox feature is enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.2.1.1: Ensure Safe Links for Office Applications is Enabled (Only Checks Priority 0 Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.11: Ensure comprehensive attachment filtering is applied | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.12: Ensure the connection filter IP allow list is not used (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.13: Ensure the connection filter safe list is off (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.2: Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.3: Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.4: Ensure Safe Attachments policy is enabled (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.5: Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.6: Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.7: Ensure that an anti-phishing policy has been created (Only Checks Default Policy) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.1.9: Ensure that DKIM is enabled for all Exchange Online Domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.2.4.4: Ensure Zero-hour auto purge for Microsoft Teams is on (Only Checks ZAP is enabled) | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.3.1.1: Ensure Microsoft 365 audit log search is Enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.1.1: Ensure external file sharing in Teams is enabled for only approved cloud storage services | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.2.2: Ensure communication with unmanaged Teams users is disabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.4.1: Ensure all or a majority of third-party and custom apps are blocked | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.8.5.3: Ensure only people in my org can bypass the lobby | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CIS.M365.8.6.1: Ensure users can report security concerns in Teams to internal destination | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.1.1: Legacy authentication SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.1: Users detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.3: If Microsoft Authenticator is enabled, it SHALL be configured to show login context information. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.7: Managed devices SHOULD be required for authentication. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.3.8: Managed Devices SHOULD be required to register MFA. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.4.1: Security logs SHALL be sent to the agency's security operations center for monitoring. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.5.1: Only administrators SHALL be allowed to register applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.5.3: An admin consent workflow SHALL be configured for applications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.6.1: User passwords SHALL NOT expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Entra ID directory objects. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.1.1: Automatic forwarding to external domains SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.1: Emails SHALL be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.1: Impersonation protection checks SHOULD be used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.1: IP allow lists SHOULD NOT be created. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.12.2: Safe lists SHOULD NOT be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.13.1: Mailbox auditing SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.1: A spam filter SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.2: Direct download links SHOULD be scanned for malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.15.3: User click tracking SHOULD be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.16.1: Alerts SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.1: A list of approved IP addresses for sending mail SHALL be maintained. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.2.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.3.1: DKIM SHOULD be enabled for all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.1: A DMARC policy SHALL be published for every second-level domain. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.4.2: The DMARC message rejection option SHALL be p=reject. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.5.1: SMTP AUTH SHALL be disabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.1: Contact folders SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.6.2: Calendar details SHALL NOT be shared with all domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.7.1: External sender warnings SHALL be implemented. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.8.1: A DLP solution SHALL be used. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.8.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.EXO.9.1: Emails SHALL be filtered by attachment file types. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.3: Disallowed file types SHALL be determined and enforced. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.EXO.9.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CISA.MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| CISA.MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF01: Authentication Method - FIDO2 security key - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AG01: Authentication Method - General Settings - Manage migration. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP07: Default Authorization Settings - Guest user access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP09: Default Authorization Settings - Allow user consent on risk-based apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT01: Authentication Method - Temporary Access Pass - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.AV01: Authentication Method - Voice call - State. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days). | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1001: At least one Conditional Access policy is configured with device compliance. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1002: App management restrictions on applications and service principals is configured and enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1003: At least one Conditional Access policy is configured with All Apps. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1004: At least one Conditional Access policy is configured with All Apps and All Users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1006: At least one Conditional Access policy is configured to require MFA for admins. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1007: At least one Conditional Access policy is configured to require MFA for all users. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1009: At least one Conditional Access policy is configured to block other legacy authentication. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1016: At least one Conditional Access policy is configured to require MFA for guest access. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1022: All users utilizing a P1 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1023: All users utilizing a P2 license should be licensed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1024.: . | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1025: No external user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1026: No hybrid user with permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1028: No user with mailbox and permanent role assignment on Control Plane. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1029: Stale accounts are not assigned to privileged roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1030: Eligible role assignments on Control Plane are in use by administrators. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1031: Privileged role on Control Plane are managed by PIM only. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1032: Limited number of Global Admins are assigned. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1036: All excluded objects should have a fallback include in another policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1037: Only users with Presenter role are allowed to present in Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1038: Conditional Access policies should not include or exclude deleted groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1039: Ensure MailTips are enabled for end users | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1040: Ensure additional storage providers are restricted in Outlook on the web | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1041: Ensure users installing Outlook add-ins is not allowed | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1042: Restrict dial-in users from bypassing a meeting lobby  | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1043: Ensure Spam confidence level (SCL) is configured in mail transport rules with specific domains | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1044: Ensure modern authentication for Exchange Online is enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1045: Only invited users should be automatically admitted to Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1046: Restrict anonymous users from joining meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1047: Restrict anonymous users from starting Teams meetings | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1048: Limit external participants from having control in a Teams meeting | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1049: Conditional Access policies for User Risk and Sign-in Risk should be configured separately. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1052: At least one Conditional Access policy is targeting the Device Code authentication flow. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1053: Ensure intune device clean-up rule is configured | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1054: Ensure built-in Device Compliance Policy marks devices with no compliance policy assigned as 'Not compliant' | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1055: Microsoft 365 Group (and Team) creation should be restricted to approved users. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1056: Ensure that no person has permanent access to all Azure subscriptions at the root scope | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1061: Device registration MFA control conflicts with Conditional Access policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1062: Ensure Direct Send is set to be rejected | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1065: Ensure all Recovery Services Vaults have soft delete enabled | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1066: Conditional Access policies should not reference non-existent users, groups, or roles. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1067: Authentication method policies should not reference non-existent groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1068: Restrict non-admin users from creating tenants. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1069: Restrict non-admin users from creating security groups. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1070: Restrict device join to selected users/groups or none. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1071: At least one Conditional Access policy explicitly includes Azure DevOps. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1072: Conditional access policies should not use the deprecated Approved Client App grant. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1085: Pending approvals for Critical Asset Management should not be present. |  |
| MT.1090: Global administrator role should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1091: Registering user should not be added as local administrator on the device during Microsoft Entra join | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1096: Ensure at least one Intune Multi Admin Approval policy is configured | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1098: Mobile Threat Defense Connectors should be healthy | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1099: Windows Diagnostic Data Processing should be enabled | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1100: Intune Diagnostic Settings should include Audit Logs | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| MT.1101: Default Branding Profile should be customized | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1102: Windows Feature Update Policy Settings should not reference end of support builds | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1103: Ensure Intune RBAC groups are protected by Restricted Management Administrative Units or Role Assignable groups | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| MT.1105: Ensure MDM Authority is set to Intune | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.100: Bulk Complaint Level threshold is between 4 and 6. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.101: Bulk is marked as spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.102: Advanced Spam filter options are turned off. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.103: Outbound spam filter policy settings configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.104: High Confidence Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.105: Safe Links Synchronous URL detonation is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.106: Quarantine retention period is 30 days. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.107: End-user spam notification is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108: DKIM signing is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.108.1: DNS Records have been set up to support DKIM. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.109: Senders are not being allow listed in an unsafe manner. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.110: Internal Sender notifications are disabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.111: Anti-phishing policy exists and EnableUnauthenticatedSender is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.112: Anti-spoofing protection action is configured to Move message to the recipients' Junk Email folders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.113: AllowClickThrough is disabled in Safe Links policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.114: No IP Allow Lists have been configured. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.115: Mailbox intelligence based impersonation protection is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.116: Mailbox intelligence based impersonation protection action set to move message to junk mail folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.1: Domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.2: Domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.3: Your own domains are not being allow listed in an unsafe manner in Anti-Spam Policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.118.4: Your own domains are not being allow listed in an unsafe manner in Transport Rules. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.119: Similar Domains Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.1: Zero Hour Autopurge Enabled for Phish. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.2: Zero Hour Autopurge Enabled for Malware. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.120.3: Zero Hour Autopurge Enabled for Spam. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.121: Supported filter policy action used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.123: Unusual Characters Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.124: Safe attachments unknown malware response set to block messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.139: Spam action set to move message to junk mail folder or quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.140: High Confidence Spam action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.141: Bulk action set to Move message to Junk Email Folder. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.142: Phish action set to Quarantine message. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.156: Safe Links Policies are tracking when user clicks on safe links. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.158: Safe Attachments is enabled for SharePoint and Teams. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.179: Safe Links is enabled intra-organization. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.180: Anti-phishing policy exists and EnableSpoofIntelligence is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189: Safe Attachments is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.189.2: Safe Links is not bypassed. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.205: Common attachment type filter is enabled. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.220: Advanced Phish filter Threshold level is adequate. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.221: Mailbox intelligence is enabled in anti-phishing policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.222: Domain Impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.223: User impersonation action is set to move to Quarantine. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.224: Similar Users Safety Tips is enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.225: Safe Documents is enabled for Office clients. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.226: Each domain has a Safe Link policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.227: Each domain has a Safe Attachments policy applied to it. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.228: No trusted senders in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.229: No trusted domains in Anti-phishing policy. | <img src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/> |
| ORCA.230: Each domain has a Anti-phishing policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.231: Each domain has a anti-spam policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.232: Each domain has a malware filter policy applied to it, or the default policy is being used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233: Domains are pointed directly at EOP or enhanced filtering is used. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.233.1: Domains are pointed directly at EOP or enhanced filtering is configured on all default connectors. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.234: Click through is disabled for Safe Documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.235: SPF records is set up for all your custom domains. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.236: Safe Links is enabled for emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.237: Safe Links is enabled for teams messages. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.238: Safe Links is enabled for office documents. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.239: No exclusions for the built-in protection policies. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.240: Outlook is configured to display external tags for external emails. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.241: Anti-phishing policy exists and EnableFirstContactSafetyTips is true. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.242: Important protection alerts responsible for AIR activities are enabled. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.243: Authenticated Receive Chain is set up for domains not pointing to EOP/MDO, or all domains point to EOP/MDO. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| ORCA.244: Policies are configured to honor sending domains DMARC. | <img src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/> |
| CIS.M365.1.1.3: Ensure that between two and four global admins are designated | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C). | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.4.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.8.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| CISA.MS.EXO.9.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.AS04: Authentication Method - SMS - Use for sign-in. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1021: Security Defaults are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1033.0: User should be blocked from using legacy authentication (Sander.breijer@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.1: User should be blocked from using legacy authentication (Adriaan.de.koning@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.2: User should be blocked from using legacy authentication (Michel.Melk@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.3: User should be blocked from using legacy authentication (Website@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1033.4: User should be blocked from using legacy authentication (Info@giraffe-it.com) | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1050: Apps with high-risk permissions having a direct path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1051: Apps with high-risk permissions having an indirect path to Global Admin | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1057: App registrations should no longer use secrets. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1058: Exchange application access policies must be configured. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1063: All App registration owners should have MFA registered | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1064: Ensure that write permissions are required to create new management groups | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1073: Soft- and hard-matching of synchronized objects should be blocked. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1074: Ensure no more then 100 outbound mails per day are send using the .onmicrosoft.com domain |  |
| MT.1075: Require explicit assignment of Third Party Entra Apps. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1076: MOERA SHOULD NOT be used for sent mail | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1077: App registrations with privileged API permissions should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1078: App registrations with highly privileged directory roles should not have owners. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1079: Privileged API permissions on service principals should not remain unused. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1080: Credentials, tokens, or cookies from highly privileged users should not be exposed on vulnerable endpoints. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1081: Hybrid users should not be assigned Entra ID role assignments. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1083: Ensure Delicensing Resiliency is enabled | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1084: Microsoft Entra seamless single sign-on should be disabled for all domains in EntraID Connect servers. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1086: Devices should not share both critical and non-critical user credentials. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1087: Devices should not be publicly exposed with remotely exploitable, highly likely to be exploited, high or critical severity CVE's. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1088: Devices with critical credentials should be protected by TPM. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1089: Devices with critical credentials should be protected by Credential Guard. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/> |
| MT.1092: Intune APNS certificate should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1093: Apple Automated Device Enrollment Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1094: Apple Volume Purchase Program Tokens should be valid for more than 30 days | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1095: Android Enterprise account connection should be healthy | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| MT.1097: Ensure all Intune Certificate Connectors are healthy and running supported versions | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |
| ORCA.143: Safety Tips are enabled. | <img src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/> |


## Test details

%TestDetails%

___
Maester 2.0.0
.SetScl -eq -1 }
```
The result should return no rules.

#### Related links

* [Exchange Transport Rules and SCL values](https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)
* [Spam Confidence Levels (SCL) in Exchange Online](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spam-message-headers)
* [Microsoft Secure Score - Set SCL to 0 or higher for domains](https://security.microsoft.com/securescore)



#### Test Results


Well done. SetScl is not in use



**Tag**: `Maester` `Exchange` `MT.1043` `SetScl` `TransportRule` `SecureScore`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### ‚úÖ MT.1044: Ensure modern authentication for Exchange Online is enabled

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Modern authentication for Exchange Online MUST be enabled

Rationale: Modern authentication enables enhanced security features like multifactor authentication (MFA), certificate-based authentication (CBA), and third-party SAML identity providers. Without modern authentication, users are more vulnerable to password-based attacks.

#### Remediation action:

1. Connect to Exchange Online:
```powershell
Connect-ExchangeOnline
```

2. Enable modern authentication:
```powershell
Set-OrganizationConfig -OAuth2ClientProfileEnabled $true
```

3. Verify the setting:
```powershell
(Get-OrganizationConfig).OAuth2ClientProfileEnabled
```
The result should be `True`.

#### Related links

* [Enable or disable modern authentication in Exchange Online](https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/enable-or-disable-modern-authentication-in-exchange-online)
* [Modern authentication overview](https://learn.microsoft.com/en-us/microsoft-365/enterprise/modern-auth-for-office-2013-and-2016)
* [Microsoft Secure Score - Enable modern authentication](https://security.microsoft.com/securescore)



#### Test Results


Well done. `OAuth2ClientProfileEnabled` is `True`



**Tag**: `Maester` `Exchange` `MT.1044` `OAuth2ClientProfileEnabled` `SecureScore`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### ‚úÖ MT.1045: Only invited users should be automatically admitted to Teams meetings

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Users who aren‚Äôt invited to a meeting shouldn‚Äôt be let in automatically, because it increases the risk of data leaks, inappropriate content being shared, or malicious actors joining. If only invited users are automatically admitted, then users who weren‚Äôt invited will be sent to a meeting lobby. The host can then decide whether or not to let them in.

#### Test Results

Well done. AutoAdmittedUsers is InvitedUsers



**Tag**: `Maester` `Teams` `MeetingPolicy` `MT.1045`

**Category**: `Maester/Teams`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Teams\Test-TeamsMeeting.Tests.ps1`

---

### ‚úÖ MT.1046: Restrict anonymous users from joining meetings

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

By restricting anonymous users from joining Microsoft Teams meetings, you have full control over meeting access. Anonymous users may not be from your organization and could have joined for malicious purposes, such as gaining information about your organization through conversations.

#### Test Results

Well done. AllowAnonymousUsersToJoinMeeting is False



**Tag**: `Maester` `Teams` `MeetingPolicy` `MT.1046`

**Category**: `Maester/Teams`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Teams\Test-TeamsMeeting.Tests.ps1`

---

### ‚úÖ MT.1047: Restrict anonymous users from starting Teams meetings

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

If anonymous users are allowed to start meetings, they can admit any users from the lobbies, authenticated or otherwise. Anonymous users haven‚Äôt been authenticated, which can increase the risk of data leakage.

#### Test Results

Well done. AllowAnonymousUsersToStartMeeting is False



**Tag**: `Maester` `Teams` `MeetingPolicy` `MT.1047`

**Category**: `Maester/Teams`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Teams\Test-TeamsMeeting.Tests.ps1`

---

### ‚úÖ MT.1048: Limit external participants from having control in a Teams meeting

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

External participants are users that are outside your organization. Limiting their permission to share content, add new users, and more protects your organization‚Äôs information from data leaks, inappropriate content being shared, or malicious actors joining the meeting.

#### Test Results

Well done. AllowExternalParticipantGiveRequestControl is False



**Tag**: `Maester` `Teams` `MeetingPolicy` `MT.1048`

**Category**: `Maester/Teams`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Teams\Test-TeamsMeeting.Tests.ps1`

---

### ‚úÖ MT.1049: Conditional Access policies for User Risk and Sign-in Risk should be configured separately.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Checks if both user risk and sign-in risk are configured in one conditional access policy.

Combining sign in risk and user risk in one policy will only block access if both types of risk are flagged for a given sign in.

This means if only one type of risk is present (eg Sign-in risk = High, User risk = None), the sign-in will be allowed to proceed. This could create a security gap since risky activities might slip through.


See [Sign-in risk-based multifactor authentication - Microsoft Learn](https://learn.microsoft.com/entra/identity/conditional-access/howto-conditional-access-policy-risk)


#### Test Results


Well done! No conditional access policies detected where sign-in risk and user risk are combined.

**Learn more**: [https://maester.dev/docs/tests/MT.1049](https://maester.dev/docs/tests/MT.1049)

**Tag**: `Maester` `CA` `Security` `MT.1049`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1052: At least one Conditional Access policy is targeting the Device Code authentication flow.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Checks if at least one policy is targeting the Device Code condition.

Organizations should block or limit device code flow because it can be exploited in phishing attacks, such as those conducted by the Storm-2372 group.
Attackers leverage this authentication method to trick users into entering device codes on malicious websites, granting unauthorized access to accounts.
Blocking or limiting this flow helps prevent exploitation by minimizing attack vectors, improving overall security posture, and safeguarding against compromised credentials through phishing techniques.

## How to fix

Configure a Conditional Access policy to block the Device Code authentication flow and limit access to only trusted users and devices or to specific named locations.

## Learn more
  - [Block authentication flows with Conditional Access policy](https://learn.microsoft.com/entra/identity/conditional-access/policy-block-authentication-flows)
  - [Microsoft Threat Intelligence | Storm-2372 conducts device code phishing campaign](https://www.microsoft.com/security/blog/2025/02/13/storm-2372-conducts-device-code-phishing-campaign/)
  - [Jeffrey Appel | How to protect against Device Code Flow abuse (Storm-2372 attacks) and block the authentication flow](https://jeffreyappel.nl/how-to-protect-against-device-code-flow-abuse-storm-2372-attacks-and-block-the-authentication-flow/)




#### Test Results


Well done! The following conditional access policies sufficiently cover Device Code authentication flow:

  - [Block authentication flows](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/PolicyBlade/policyId/43b6ebc2-aa39-4557-9818-79ab8250deb9)


**Learn more**: [https://maester.dev/docs/tests/MT.1052](https://maester.dev/docs/tests/MT.1052)

**Tag**: `Maester` `CA` `Security` `MT.1052`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùå MT.1053: Ensure intune device clean-up rule is configured

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Ensure device clean-up rule is configured

This test checks if the device clean-up rule is configured.

Set your Intune device cleanup rules to delete Intune MDM enrolled devices that appear inactive, stale, or unresponsive. Intune applies cleanup rules immediately and continuously so that your device records remain current.

#### Remediation action:

To enable device clean-up rules:

- Open [Microsoft Intune - Device clean-up rules](https://intune.microsoft.com/?ref=AdminCenter#view/Microsoft_Intune_DeviceSettings/DevicesMenu/~/deviceCleanUp)
  - Or navigate to [Microsoft Intune admin center](https://intune.microsoft.com) > **Devices** > **Organize devices** > **Device clean-up rules**.
- Select **Create**.
- Set **Name** and **Platform**.
- Enter **30 days or more** depending on your organizational needs.
- Click **Next**.
- Click **Create**.

#### Related links

- [Automatically hide devices with cleanup rules](https://learn.microsoft.com/en-us/intune/intune-service/remote-actions/devices-wipe#automatically-hide-devices-with-cleanup-rules)



#### Test Results


No Intune device clean-up rule is configured.

**Tag**: `Maester` `Intune` `MT.1053`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚ùå MT.1054: Ensure built-in Device Compliance Policy marks devices with no compliance policy assigned as 'Not compliant'

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Ensure the built-in Device Compliance Policy marks devices with no compliance policy assigned as 'Not compliant'.

Set your Intune built-in Device Compliance Policy to mark devices with no compliance policy assigned as 'Not compliant'.
This ensures that new devices that do not have any policies assigned are not compliant per default.

#### Remediation action:

To change the built-in device compliance policy:
1. Navigate to [Microsoft Intune admin center](https://intune.microsoft.com).
2. Click **Devices** scroll down to **Manage devices**.
3. Select **Compliance** and Select **Compliance settings**.
4. Set **Mark devices with no compliance policy assigned as** to **Not compliant**
5. Click **Save**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [Microsoft Intune - Compliance](https://intune.microsoft.com/?ref=AdminCenter#view/Microsoft_Intune_DeviceSettings/DevicesMenu/~/compliance)
* [Compliance policy settings](https://learn.microsoft.com/de-de/mem/intune/protect/device-compliance-get-started#compliance-policy-settings)



#### Test Results


Your Intune built-in Device Compliance Policy **incorrectly** marks devices with no compliance policy assigned as 'Compliant'.

**Tag**: `Maester` `Intune` `MT.1054`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚ùå MT.1055: Microsoft 365 Group (and Team) creation should be restricted to approved users.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

This test checks if Microsoft 365 Group creation is restricted to approved users.

By default, all users in the tenant can create Microsoft 365 Groups. This can lead to group sprawl, security risks and compliance issues.

Creating groups should be restricted to users who have undergone training and understand the responsibilities of group ownership, governance and compliance requirements.

#### Remediation action

Unfortunately, Microsoft 365 does not provide a user interface to restrict group creation. However, you can restrict group creation to approved users by using PowerShell.

Follow the link below to restrict Microsoft 365 Group creation to approved users:.

#### Related links

- [Manage who can create Microsoft 365 Groups](https://learn.microsoft.com/en-us/microsoft-365/solutions/manage-creation-of-groups?view=o365-worldwide)



#### Test Results



Microsoft 365 Group creation is not restricted and any user can create groups.


**Learn more**: [https://maester.dev/docs/tests/MT.1055](https://maester.dev/docs/tests/MT.1055)

**Tag**: `Maester` `Group` `Security` `MT.1055`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-Groups.Tests.ps1`

---

### ‚úÖ MT.1056: Ensure that no person has permanent access to all Azure subscriptions at the root scope

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Ensure that no person has permanent access to Azure Subscriptions.

User Access Administrator is a role that allows an Administrator to perform everything on an Azure Subscription. Global Administrators can gain this permission on the Root Scope in Entra ID, in the properties of the Entra ID tenant. These permissions should only be used in case of emergency and should not be assigned permanently.

Ensure that no User Access Administrator permissions at the Root Scope are applied.

#### Remediation action:

To remove all Admins with Root Scope permissions, as a Global Admin:
1. Navigate to Microsoft Azure Portal [https://portal.azure.com](https://portal.azure.com).
2. Search for **Microsoft Entra ID** and select **Microsoft Entra ID**.
3. Expand the **Manage** menu and select **Properties**.
3. On the **Properties** page, go to the **Access management for Azure resources** section.
4. In the information bar, click **Manage elevated access users**.
5. Select all User Access Administrators and click **Remove**.
6. Also check other role assignments, as they need to be removed to pass the tests.

To remove the admins through CLI:
```powershell
az role assignment delete --role "User Access Administrator" --assignee adminname@yourdomain.com --scope "/"
```

#### Related links

* [Manage who can create Microsoft 365 Groups](https://learn.microsoft.com/en-us/microsoft-365/solutions/manage-creation-of-groups?view=o365-worldwide)




#### Test Results


Well done. Your tenant has no User Access Administrators.


**Tag**: `Privileged` `Azure` `MT.1056`

**Category**: `AzureConfig`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Azure\UserAccessAdmin.Tests.ps1`

---

### ‚úÖ MT.1061: Device registration MFA control conflicts with Conditional Access policies.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When MFA is required during device registration in Conditional Access policies, it must be disabled in the Entra ID Device settings.

When both are enabled, the conditional access policy with the "Register device" user action will not work as expected.

#### Remediation action:

When a Conditional Access policy is configured with the **Register or join devices user action** you must disable tenant-wide multifactor requirement for device registration. Otherwise, Conditional Access policies with this user action are not properly enforced.

1. Open **[Entra - Device Settings](https://entra.microsoft.com/#view/Microsoft_AAD_Devices/DevicesMenuBlade/~/DeviceSettings/menuId/Devices)**.
2. Set **Require Multifactor Authentication to register or join devices with Microsoft Entra** to **No**.

#### Related links

- [Require multifactor authentication for device registration](https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-all-users-device-registration#create-a-conditional-access-policy)
- [Conflicting conditional access policies and Entra Device Settings](https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-all-users-device-registration#create-a-conditional-access-policy:~:text=When%20a%20Conditional%20Access%20policy%20is%20configured%20with%20the%20Register%20or%20join%20devices%20user%20action)



#### Test Results



No conditional access policies nor device registration settings were found that conflict with each other. However it is recommended to enforce MFA for device registration.


**Learn more**: [https://maester.dev/docs/tests/MT.1061](https://maester.dev/docs/tests/MT.1061)

**Tag**: `Maester` `CA` `Security` `MT.1061`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1062: Ensure Direct Send is set to be rejected

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Direct Send SHOULD be configured to `Reject` in Exchange Online

Rationale: Attackers can exploit direct send to send spam or phishing emails without authentication. Direct Send covers anonymous messages (unauthenticated messages) sent from your own domain to your organization's mailboxes using the tenant MX.

#### Remediation action:

1. Connect to Exchange Online:
```powershell
Connect-ExchangeOnline
```

2. Configure the setting to reject direct send:
```powershell
Set-OrganizationConfig -RejectDirectSend $true
```

3. Verify the policy:
```powershell
(Get-OrganizationConfig).RejectDirectSend
```
The result should be `True`.

#### Related links

* [Introducing more control over Direct Send in Exchange Online](https://techcommunity.microsoft.com/blog/exchange/introducing-more-control-over-direct-send-in-exchange-online/4408790)
* [Direct Send: Send mail directly from your device or application to Microsoft 365](https://learn.microsoft.com/en-us/exchange/mail-flow-best-practices/how-to-set-up-a-multifunction-device-or-application-to-send-email-using-microsoft-365-or-office-365#direct-send-send-mail-directly-from-your-device-or-application-to-microsoft-365-or-office-365)



#### Test Results


Well done. RejectDirectSend is `True`.



**Tag**: `Maester` `Exchange` `MT.1062` `RejectDirectSend`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### ‚úÖ MT.1065: Ensure all Recovery Services Vaults have soft delete enabled

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Soft delete ensures that backup items and recovery points are retained for a period after deletion. This protects against accidental or malicious deletion of backups.

Ensure that all Recovery Services Vaults across all subscriptions have soft delete enabled.

### Remediation action:

To enable soft delete on a Recovery Services Vault:
1. Go to the Azure portal: https://portal.azure.com
2. Navigate to **Recovery Services Vaults**
3. Select the vault and go to **Properties**
4. Under **Soft Delete**, ensure it is set to **Enabled**

Note: New vaults typically have soft delete enabled by default.

### Related links

* [Soft delete for Recovery Services vaults](https://learn.microsoft.com/en-us/azure/backup/backup-azure-security-feature-cloud)



#### Test Results


No Recovery Services Vaults found


**Tag**: `Backup` `Azure` `MT.1065`

**Category**: `AzureConfig`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Azure\Test-MtVaultSoftDelete.Tests.ps1`

---

### ‚úÖ MT.1066: Conditional Access policies should not reference non-existent users, groups, or roles.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

# Conditional Access policies should not reference non-existent users, groups, or roles

This test checks if there are any Conditional Access policies that reference non-existent users, groups, or roles.

This usually happens when a user, group, or role is deleted but is still referenced in a Conditional Access policy.

Non-existent objects in your policy can lead to unexpected gaps or behavior. This may result in Conditional Access policies not being applied to the intended users or the policy not functioning as expected.

## How to fix

To fix this issue:

* Open the impacted Conditional Access policy.
* Remove the non-existent user, group, or role from the policy.
* If the object is still needed, recreate it or replace it with a valid alternative.
* Click Save to apply the changes.

## Learn more

* [Conditional Access: Users and groups](https://learn.microsoft.com/entra/identity/conditional-access/concept-conditional-access-users-groups)
* [Manage Conditional Access policies](https://learn.microsoft.com/entra/identity/conditional-access/manage-conditional-access-policies)



#### Test Results


Well done! All users, groups, and roles referenced in Conditional Access policies exist in the tenant.


**Learn more**: [https://maester.dev/docs/tests/MT.1066](https://maester.dev/docs/tests/MT.1066)

**Tag**: `Maester` `CA` `Security` `MT.1066`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1067: Authentication method policies should not reference non-existent groups.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

# Authentication method policies should not reference non-existent groups

This test checks if all groups referenced in authentication method policies still exist in the tenant.

Authentication method policies can reference groups in their includeTargets configuration. If a group is deleted but still referenced in an authentication method policy, it may cause the policy to not apply as expected or result in unexpected behavior.

The test examines includeTargets for all authentication method configurations and validates that any group references are valid and the groups still exist in the tenant.

## How to fix

If this test fails, you need to:

1. **Review the failed authentication method policies** - Check which policies are referencing non-existent groups
2. **Remove invalid group references** - Edit the authentication method policy to remove references to deleted groups
3. **Replace with valid groups** - If needed, replace the deleted group reference with a valid existing group

To fix the issue:

1. Go to the [Microsoft Entra admin center](https://entra.microsoft.com)
2. Navigate to **Protection** > **Authentication methods**
3. Select the impacted authentication method
4. In the **Include** section, remove the invalid group references
5. If needed, add valid replacement groups
6. Save the changes

## Learn more

- [Authentication methods in Microsoft Entra ID](https://learn.microsoft.com/entra/identity/authentication/concept-authentication-methods)
- [Manage authentication methods](https://learn.microsoft.com/entra/identity/authentication/concept-authentication-methods-manage)
- [Authentication method policies](https://learn.microsoft.com/entra/identity/authentication/concept-authentication-methods-activities)

## Related links

- [Entra admin center - Authentication methods](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods/fromNav/Identity)
- [Entra admin center - Groups](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/GroupsManagementMenuBlade/~/AllGroups/menuId/AllGroups)



#### Test Results


No groups are referenced in authentication method policies.


**Learn more**: [https://maester.dev/docs/tests/MT.1067](https://maester.dev/docs/tests/MT.1067)

**Tag**: `Maester` `Authentication` `Security` `MT.1067`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-AuthenticationMethodBaseline.Tests.ps1`

---

### ‚úÖ MT.1068: Restrict non-admin users from creating tenants.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks if tenant creation is restricted to admin users only.

"Yes" restricts the creation of Microsoft Entra ID tenants to the global administrator or tenant creator roles. "No" allows non-admin users to create Microsoft Entra ID tenants. Anyone who creates a tenant will become the global administrator for that tenant.

Tenant creation should be restricted to admin users who have undergone proper training and understand the responsibilities of tenant management, security governance, and compliance requirements.

#### Remediation action

This setting can be changed via user settings in the Microsoft Entra or Azure portal or via Microsoft Graph API / Graph PowerShell Module.

Admin Portal:

1. Go to [Entra Admin Center](https://entra.microsoft.com)
2. Navigate to Users ‚Üí [User settings](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/)
3. Set **Restrict non-admin users from creating tenants** to **Yes**
4. Click **Save**

Use the following PowerShell commands to restrict tenant creation:

```powershell
# Connect to Microsoft Graph with appropriate permissions
Connect-MgGraph -Scopes "Policy.ReadWrite.Authorization"

# Get the current authorization policy
$authPolicy = Get-MgPolicyAuthorizationPolicy

# Update the policy to restrict tenant creation
$params = @{
    defaultUserRolePermissions = @{
        allowedToCreateTenants = $false
    }
}

Update-MgPolicyAuthorizationPolicy -AuthorizationPolicyId $authPolicy.Id -BodyParameter $params
```

#### Related links

- [Manage default user permissions in Entra ID](https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/users-default-permissions)
- [Authorization policy in Entra ID](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)


#### Test Results

Well done. Entra ID tenant creation is restricted to admin users.

| Setting | Value | Status |
|---------|-------|-------|
| [Restrict non-admin users from creating tenants](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/) | Yes | ‚úÖ |


**Tag**: `Governance` `Entra` `Security` `MT.1068`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtTenantCreationRestricted.Tests.ps1`

---

### ‚úÖ MT.1069: Restrict non-admin users from creating security groups.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

## Description

Verifies that security group creation is restricted to admin users only in the Entra ID tenant.

## Why This Matters

Restricting security group creation to administrators ensures proper governance, maintains the principle of least privilege, and supports regulatory compliance requirements.

#### Remediation action

This setting can be changed via user settings in the Microsoft Entra or Azure portal or via Microsoft Graph API / Graph PowerShell Module.

Admin Portal:

1. Go to [Entra Admin Center](https://entra.microsoft.com)
2. Navigate to Users ‚Üí [User settings](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/)
3. Set **Users can create security groups** to **No**
4. Click **Save**

Use the following PowerShell commands to restrict security group creation:

```powershell
# Connect to Microsoft Graph with appropriate permissions
Connect-MgGraph -Scopes "Policy.ReadWrite.Authorization"

# Get the current authorization policy
$authPolicy = Get-MgPolicyAuthorizationPolicy

# Update the policy to restrict security group creation
$params = @{
    defaultUserRolePermissions = @{
        allowedToCreateSecurityGroups = $false
    }
}

Update-MgPolicyAuthorizationPolicy -AuthorizationPolicyId $authPolicy.Id -BodyParameter $params
```

#### Related links

- [Manage default user permissions in Entra ID](https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/users-default-permissions)
- [Authorization policy in Entra ID](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)

#### Test Results

Well done. Security group creation is restricted to admin users.

|Setting|Value|Status|
|---|---|---|
|[Users can create security groups](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings/menuId/)|No|‚úÖ|

**Tag**: `Governance` `Entra` `Security` `MT.1069`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtSecurityGroupCreationRestricted.Tests.ps1`

---

### ‚ùå MT.1070: Restrict device join to selected users/groups or none.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

## Description

Verifies that device join to Entra ID is restricted to selected users/groups or disabled entirely.

## Why This Matters

Device join should be restricted because:

- **Unauthorized Access**: Unrestricted device join allows any user to connect personal or unmanaged devices to corporate resources.
- **Data Leakage**: Uncontrolled devices may not have proper security controls, increasing risk of data exposure.
- **Compliance**: Many regulatory frameworks require controlled device access to organizational resources.
- **Shadow IT**: Unmanaged devices bypass security policies and monitoring capabilities.
- **Attack Surface**: Each joined device represents a potential entry point for attackers.

Restricting device join to selected users/groups ensures only authorized devices with proper security controls can access organizational resources.

#### Remediation action

This setting can be changed via device settings in the Microsoft Entra or Azure portal or via Microsoft Graph API / Graph PowerShell Module.

Admin Portal:

1. Go to [Entra Admin Center](https://entra.microsoft.com)
2. Navigate to Devices ‚Üí [Device settings](https://entra.microsoft.com/#view/Microsoft_AAD_Devices/DevicesMenuBlade/~/DeviceSettings/menuId/Overview)
3. Set **Users may join devices to Microsoft Entra** to **Selected** or **None**
   - If **Selected**, configure the specific users/groups that can join devices
   - If **None**, disable device join entirely
4. Click **Save**

Use the following PowerShell commands to restrict device join:

```powershell
# Connect to Microsoft Graph with appropriate permissions
Connect-MgGraph -Scopes "Policy.ReadWrite.DeviceConfiguration"

# Option 1: Disable device join completely
$params = @{
    azureADJoin = @{
        allowedToJoin = @{
            "@odata.type" = "#microsoft.graph.noDeviceRegistrationMembership"
        }
    }
}

# Option 2: Restrict to selected users/groups
$params = @{
    azureADJoin = @{
        allowedToJoin = @{
            "@odata.type" = "#microsoft.graph.enumeratedDeviceRegistrationMembership"
            users = @("user1@domain.com", "user2@domain.com")
            groups = @("group-id-1", "group-id-2")
        }
    }
}

# Apply the policy
Update-MgPolicyDeviceRegistrationPolicy -BodyParameter $params
```

#### Related links

- [Manage device identities in Entra ID](https://learn.microsoft.com/en-us/azure/active-directory/devices/overview)
- [Device registration policy in Entra ID](https://learn.microsoft.com/en-us/graph/api/resources/deviceregistrationpolicy)

#### Test Results

Device join is not restricted and all users may be able to join devices to Entra ID. Configuration: Unrestricted (all users can join)

|Setting|Value|Status|
|---|---|---|
|[Users may join devices to Microsoft Entra](https://entra.microsoft.com/#view/Microsoft_AAD_Devices/DevicesMenuBlade/~/DeviceSettings/menuId/Overview)|All users can join devices.|‚ùå|



**Tag**: `Governance` `Entra` `Security` `MT.1070`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtEntraDeviceRegistrationPolicy.Tests.ps1`

---

### ‚ùå MT.1071: At least one Conditional Access policy explicitly includes Azure DevOps.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Checks if any conditional access policy explicitly includes Azure DevOps

## Description
If your organization has Conditional Access policies targeting the Windows Azure Service Management API (App ID: 797f4846-ba00-4fd7-ba43-dac1f8f63013), those policies will no longer apply to Azure DevOps sign-ins. This may result in unprotected access unless these policies are updated to include Azure DevOps (App ID: 499b84ac-1321-427f-aa17-267ca6975798).

Access controls such as MFA or compliant device requirements may not be enforced unless policies are updated.
If you already have a policy that targets all users and all cloud apps and does not explicitly exclude Azure DevOps, no action is required‚ÄîAzure DevOps sign-ins will continue to be protected.
This change does not introduce any new user-facing experience or UI changes.
Sign-in activity can be monitored using Microsoft Entra ID sign-in logs.
Licensing requirement: Microsoft Entra ID P1 or P2 is required. There are no functional differences by license type. This is a feature change, not a new feature, so trial or preview options are not applicable.
Unlicensed users may also be impacted.
Existing Conditional Access policies will be affected, specifically those targeting the Windows Azure Service Management API.
A small subset of tenants may see the app name as "Microsoft Visual Studio Team Services" instead of "Azure DevOps"‚Äîthe App ID remains the same.

## Remediate
To ensure continued protection of Azure DevOps sign-ins, administrators should:

Update policies to include Azure DevOps:
1. Review existing Conditional Access policies - Identify any policies that target the Windows Azure Service Management API.
2. Go to the Entra admin center.
3. Navigate to Entra ID > Conditional Access > Policies.
4. Select the relevant policy.
5. Under Target resources, choose Select resources and add Azure DevOps (App ID: 499b84ac-1321-427f-aa17-267ca6975798).
    - If Azure DevOps is missing from available resources:
```
Connect-MgGraph -Scopes "Directory.ReadWrite.All", "Application.ReadWrite.All"
$params = @{
	appId = "499b84ac-1321-427f-aa17-267ca6975798"
}
Invoke-MgGraphRequest -Uri "https://graph.microsoft.com/v1.0/servicePrincipals" -Method POST -Body $params
```
6. Save the policy.

## Learn more
- [Removing Azure Resource Manager reliance on Azure DevOps sign-ins | Azure DevOps Blog](https://devblogs.microsoft.com/devops/removing-azure-resource-manager-reliance-on-azure-devops-sign-ins/)
- [What is Conditional Access? | Conditional Access | Microsoft Entra ID | Microsoft Learn](https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview)



#### Test Results


There are no conditional access policies that explicitly target Azure DevOps.

**Learn more**: [https://maester.dev/docs/tests/MT.1071](https://maester.dev/docs/tests/MT.1071)

**Tag**: `Maester` `CA` `Security` `MT.1071`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚úÖ MT.1072: Conditional access policies should not use the deprecated Approved Client App grant.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Checks if the tenant has no conditional access policy that requires an approved client app.

The approved client app grant is retiring in early March 2026. Organizations must transition all current Conditional Access policies that use only the Require Approved Client App grant control to Require Approved Client App or Application Protection Policy by March 2026. Additionally, for any new Conditional Access policy, only apply the Require application protection policy grant.

After March 2026, Microsoft will stop enforcing require approved client app control, and it will be as if this grant isn't selected. Use the following steps before March 2026 to protect your organization‚Äôs data.

## Learn more
- [Migrate approved client app to application protection policy in Conditional Access](https://learn.microsoft.com/en-us/entra/identity/conditional-access/migrate-approved-client-app)



#### Test Results


Well done! No conditional access use the deprecated Approved Client App grant.

**Learn more**: [https://maester.dev/docs/tests/MT.1072](https://maester.dev/docs/tests/MT.1072)

**Tag**: `Maester` `CA` `Security` `MT.1072`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

###  MT.1085: Pending approvals for Critical Asset Management should not be present.



#### Overview

```ps1

        Test-MtXspmPendingApprovalCriticalAssetManagement | Should -Be $true -Because "no pending approvals for Critical Asset Management should be present, as pending approvals may lead into limited visibility in Defender XDR and potential security risks if critical assets are not properly identified."
    
```

#### Reason for failure

The request was canceled due to the configured HttpClient.Timeout of 300 seconds elapsing.

**Learn more**: [https://maester.dev/docs/tests/MT.1085](https://maester.dev/docs/tests/MT.1085)

**Tag**: `Entra` `Graph` `Security` `XSPM` `MT.1085`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmCriticalAssetManagement.Tests.ps1`

---

### ‚ùå MT.1090: Global administrator role should not be added as local administrator on the device during Microsoft Entra join

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

The 'Global administrator role is added as local administrator on the device during Microsoft Entra join' setting determines if Microsoft Entra Global Administrator role is added to the local administrators group. This setting applies only once during the actual registration of the device as Microsoft Entra join.

#### Remediation action

Within the [Entra Portal - Device Settings](https://entra.microsoft.com/#view/Microsoft_AAD_Devices/DevicesMenuBlade/~/DeviceSettings/menuId/Overview) set _'Global administrator role is added as local administrator on the device during Microsoft Entra join'_ to *No*.
To remediate existing devices, you need to create an Intune account policy, overriding the built-in Windows Administrators group.

#### Related links

* [Intune - Manage local groups on Windows devices](https://learn.microsoft.com/intune/intune-service/protect/endpoint-security-account-protection-policy#manage-local-groups-on-windows-devices)
* [Microsoft Learn - Device Settings](https://learn.microsoft.com/entra/identity/devices/manage-device-identities#configure-device-settings)



#### Test Results


```
{
  "enableGlobalAdmins": true,
  "registeringUsers": {
    "@odata.type": "#microsoft.graph.allDeviceRegistrationMembership"
  }
}
```

**Tag**: `Governance` `Entra` `Security` `MT.1090`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtEntraDeviceRegistrationPolicy.Tests.ps1`

---

### ‚ùå MT.1091: Registering user should not be added as local administrator on the device during Microsoft Entra join

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

The 'Registering user is added as local administrator on the device during Microsoft Entra join' setting determines if the registering user is added to the local administrators group. This setting applies only once during the actual registration of the device as Microsoft Entra join.

#### Remediation action

Within the [Entra Portal - Device Settings](https://entra.microsoft.com/#view/Microsoft_AAD_Devices/DevicesMenuBlade/~/DeviceSettings/menuId/Overview) set _'Registering user is added as local administrator on the device during Microsoft Entra join'_ to *None*.
To remediate existing devices, you need to create an Intune account policy, overriding the built-in Windows Administrators group.

#### Related links

* [Intune - Manage local groups on Windows devices](https://learn.microsoft.com/intune/intune-service/protect/endpoint-security-account-protection-policy#manage-local-groups-on-windows-devices)
* [Microsoft Learn - Device Settings](https://learn.microsoft.com/entra/identity/devices/manage-device-identities#configure-device-settings)



#### Test Results


```
{
  "enableGlobalAdmins": true,
  "registeringUsers": {
    "@odata.type": "#microsoft.graph.allDeviceRegistrationMembership"
  }
}
```

**Tag**: `Governance` `Entra` `Security` `MT.1091`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtEntraDeviceRegistrationPolicy.Tests.ps1`

---

### ‚úÖ MT.1096: Ensure at least one Intune Multi Admin Approval policy is configured

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Ensure at least one Intune Multi Admin Approval Policy is configured. Microsoft Intune Multi Admin Approval helps to limit the impact of compromised administrators by requiring approval for sensitive activities.

#### Remediation action:

To create a multi admin approval policy:
1. Navigate to [Microsoft Intune admin center](https://intune.microsoft.com).
2. Click **Tenant Administration** and select **Multi Admin Approval** or use the [Microsoft Intune Portal - Multi Admin Approval direct link](https://intune.microsoft.com/#view/Microsoft_Intune_DeviceSettings/TenantAdminMenu/~/multiAdminApproval).
3. Select **Access policies** and create a new access policy, e.g. for Scripts
4. Let another Intune Administrator approve your request to create the access policy
5. Re-visit the access policies section and complete the policy creation.

Additional information:

* [Use Access policies to require Multi Admin Approval](https://learn.microsoft.com/intune/intune-service/fundamentals/multi-admin-approval)



#### Test Results


Well done. At least one Intune Multi Admin Approval Policy is configured.
| Name | Type |
| --- | --- |


**Tag**: `Maester` `Intune` `MT.1096`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚úÖ MT.1098: Mobile Threat Defense Connectors should be healthy

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test verifies the health of Intune Mobile Threat Defense Connectors, including Microsoft Defender for Endpoint.

#### Remediation action

For Microsoft Defender for Endpoint visit the [Microsoft Defender for Endpoint Tenant Settings](https://intune.microsoft.com/#view/Microsoft_Intune_DeviceSettings/TenantAdminConnectorsMenu/~/windowsDefenderATP) and ensure that the connector is also enabled from the Microsoft Defender XDR Settings as part of the [Microsoft Intune connection](https://security.microsoft.com/securitysettings/endpoints/integration).

Additional information:

* [Integrate Microsoft Defender for Endpoint with Intune and Onboard Devices](https://learn.microsoft.com/intune/intune-service/protect/microsoft-defender-integrate)

* If you have a third party connector, consult your third party MTD solution. More information can be found on the [Mobile Threat Defense integration with Intune](https://learn.microsoft.com/intune/intune-service/protect/mobile-threat-defense#connector-status) learn page.



#### Test Results


Mobile Threat Defense Connector Status:
| Name | LastHeartbeatDateTime | PartnerState |
| --- | --- | --- |
| Microsoft Defender for Endpoint | 12/30/2025 06:52:39 | enabled |


**Tag**: `Maester` `Intune` `MT.1098`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntuneConnectorHealth.Tests.ps1`

---

### ‚ùå MT.1099: Windows Diagnostic Data Processing should be enabled

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Test whether Windows diagnostic data processor configuration is enabled. Before you can use some Intune features, you must enable Windows diagnostic data in processor configuration for your tenant. Doing so enables you as the controller of Windows diagnostic data collected from your devices to then allow its use by Intune when it's required by features that are dependent on that data.

In addition, several of the features that require Windows diagnostic data also require you to have Windows E3 (or equivalent) licenses, and you must attest to having these licenses to enable use of those features.

#### Remediation action

1. To manage Windows data configurations for your tenant, open the Microsoft Intune admin center visit the [Windows data blade](https://intune.microsoft.com/#view/Microsoft_Intune_DeviceSettings/TenantAdminConnectorsMenu/~/windowsDataConnector) under the Tenant Administration.

2. On the Windows data page, you can configure your tenant to support Windows diagnostic data in processor configuration, and to attest ownership of the required Windows E3 or equivalent licenses. It's possible that some features require only one of the available configurations to be enabled, while other features could require both.

Additional information:

* [Enable use of Windows diagnostic data by Intune](https://learn.microsoft.com/intune/intune-service/protect/data-enable-windows-data)
* [Enable Windows diagnostic data processor configuration](https://learn.microsoft.com/windows/privacy/configure-windows-diagnostic-data-in-your-organization#enable-windows-diagnostic-data-processor-configuration)



#### Test Results


Windows data processor status:
* Enable features that require Windows diagnostic data in processor configuration: False 
* Windows license verification status: False 


**Tag**: `Maester` `Intune` `MT.1099`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚ùå MT.1100: Intune Diagnostic Settings should include Audit Logs

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

This test checks for the existence of Intune Diagnostic settings collecting Intune Audit Logs.



#### Remediation action

* Check the following Microsoft learn article to [Send Intune log data to Azure Storage, Event Hubs, or Log Analytics](https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/review-logs-using-azure-monitor).

* Existing diagnostic settings can be viewed within the [Intune Diagnostics settings blade](https://intune.microsoft.com/#view/Microsoft_Intune_DeviceSettings/TenantAdminMenu/~/diagnostics).




#### Test Results


No Intune Diagnostic Settings found.

**Tag**: `Maester` `Intune` `MT.1100`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚úÖ MT.1101: Default Branding Profile should be customized

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Test whether the Intune built-in tenant customization settings are configured.

#### Remediation action

1. Visit the [Tenant Administration - Customization blade](https://intune.microsoft.com/#view/Microsoft_Intune_DeviceSettings/TenantAdminMenu/~/companyPortalBranding) in the Intune Portal
2. Choose the `Default` customization profile or create a new one and supply at least the company name and a logo to have your company portal customized.

Additional information:

* [How to Configure the Intune Company Portal Apps, Company Portal Website, and Intune App](https://learn.microsoft.com/intune/intune-service/apps/company-portal-app)



#### Test Results


The Default Branding Profile is not customized.

**Tag**: `Maester` `Intune` `MT.1101`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚úÖ MT.1102: Windows Feature Update Policy Settings should not reference end of support builds

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks for Windows Feature Update policies referencing unsupported Windows build versions.
Additional information about Feature Update Policies: [Microsoft learn - Feature updates for Windows 10 and later policy in Intune](https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-10-feature-updates).


#### Remediation action

1. Visit the Intune Portal [Windows updates blade for feature updates](https://intune.microsoft.com/#view/Microsoft_Intune_DeviceSettings/DevicesMenu/~/windows10Update)
2. Edit the affected feature update policy and select a supported Windows 11 OS version, save the policy.



#### Test Results


No unsupported Windows Feature Update Profiles found.

**Tag**: `Maester` `Intune` `MT.1102`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚úÖ MT.1103: Ensure Intune RBAC groups are protected by Restricted Management Administrative Units or Role Assignable groups

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test checks whether Intune RBAC groups are protected either via Entra Restricted Management Administrative Unit or Role Assignable group.

#### Remediation action

* Add unprotected Entra security groups to a Restricted Management Administrative Unit

Additional information:

* See [Restricted management administrative units in Microsoft Entra ID - Microsoft Learn](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-restricted-management)



#### Test Results


All security groups with Intune RBAC role assignments are protected.

**Tag**: `Maester` `Intune` `MT.1103`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚úÖ MT.1105: Ensure MDM Authority is set to Intune

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

This test verifies whether Microsoft Intune is set as MDM authority. In tenants where Intune is used to provision and manage devices, this should be automatically the case.

#### Remediation action

1. In the Microsoft Intune admin center, select the orange banner to open the Mobile Device Management Authority setting. The orange banner is only displayed if you haven't yet set the MDM authority. If the orange banner is not visible, you can navigate directly to the [MDM Authority settings](https://intune.microsoft.com/#view/Microsoft_Intune_Enrollment/ChooseMDMAuthorityBlade) to configure the MDM authority.

2. Under Mobile Device Management Authority, choose your MDM authority to: Intune MDM Authority

Additional information:

* [Set the mobile device management authority](https://learn.microsoft.com/intune/intune-service/fundamentals/mdm-authority-set)



#### Test Results


MDM Authority is set to: intune

**Tag**: `Maester` `Intune` `MT.1105`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntunePlatform.Tests.ps1`

---

### ‚úÖ ORCA.100: Bulk Complaint Level threshold is between 4 and 6.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The differentiation between bulk and spam can sometimes be subjective. The bulk complaint level is based on the number of complaints from the sender. Decreasing the threshold can decrease the amount of perceived spam received, however, too low may be considered too strict.

#### Remediation action
Set the Bulk Complaint Level threshold to be 6.

#### Related Links

* [Bulk Complaint Level values](https://aka.ms/orca-antispam-docs-1) 
* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Bulk Complaint Level threshold is between 4 and 6.



|Anti-Spam Policy|Bulk Complaint Level Threshold|Result|
|-|-|-|
|Default|7|üóÑ Skip|
|Strict Preset Security Policy|5|‚úÖ Pass|
|Standard Preset Security Policy|6|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.100` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA100.Tests.ps1`

---

### ‚úÖ ORCA.101: Bulk is marked as spam.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The differentiation between bulk and spam can sometimes be subjective. The bulk complaint level is based on the number of complaints from the sender. Marking bulk as spam can decrease the amount of perceived spam received. This setting is only available in PowerShell.

#### Remediation action
Set the anti-spam policy to mark bulk mail as spam.

#### Related Links

* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6) 
* [Set-HostedContentFilterPolicy](https://aka.ms/orca-antispam-docs-9)


#### Test Results

Well done! Bulk is marked as spam.



|Anti-Spam Policy|Mark as Spam Bulk Mail Setting (MarkAsSpamBulkMail)|Result|
|-|-|-|
|Default|On|üóÑ Skip|
|Strict Preset Security Policy|On|‚úÖ Pass|
|Standard Preset Security Policy|On|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.101` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA101.Tests.ps1`

---

### ‚úÖ ORCA.102: Advanced Spam filter options are turned off.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Enabling one or more of the ASF settings is an aggressive approach to spam filtering that can often cause false positives. The effectiveness of these settings in reducing spam has severely declined over the years. Use them with caution.

#### Remediation action
Turn off Advanced Spam filter (ASF) options in Anti-Spam filter policies.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Advanced Spam filter options are turned off.



|Policy|Setting|Current Value|Result|
|-|-|-|-|
|Default|ASF Options|Disabled|üóÑ Skip|
|Strict Preset Security Policy|ASF Options|Disabled|‚úÖ Pass|
|Standard Preset Security Policy|ASF Options|Disabled|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.102` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA102.Tests.ps1`

---

### ‚úÖ ORCA.103: Outbound spam filter policy settings configured.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Configure the maximum number of recipients that a user can send to, per hour for internal (RecipientLimitInternalPerHour) and external recipients (RecipientLimitExternalPerHour) and maximum number per day for outbound email. It is common, after an account compromise incident, for an attacker to use the account to generate spam and phish. Configuring the recommended values can reduce the impact, but also allows you to receive notifications when these thresholds have been reached.

#### Remediation action
Set RecipientLimitExternalPerHour to 500, RecipientLimitInternalPerHour to 1000, and ActionWhenThresholdReached to block.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Outbound spam filter policy settings configured.



|Outbound Spam Policy|Setting|Current Value|Result|
|-|-|-|-|
|Default|RecipientLimitExternalPerHour|500|‚úÖ Pass|
|Default|RecipientLimitInternalPerHour|1000|‚úÖ Pass|
|Default|RecipientLimitPerDay|1000|‚úÖ Pass|
|Default|ActionWhenThresholdReached|BlockUser|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.103` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA103.Tests.ps1`

---

### ‚úÖ ORCA.104: High Confidence Phish action set to Quarantine message.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

It is recommended to configure the High Confidence Phish detection action to Quarantine so that these emails are not visible to the end user from within Outlook. As Phishing emails are designed to look legitimate, users may mistakenly think that a phishing email in Junk is false-positive.

#### Remediation action
Change High Confidence Phish action to Quarantine message.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! High Confidence Phish action set to Quarantine message.



|Spam Policy|Action|Result|
|-|-|-|
|Default|Quarantine|üóÑ Skip|
|Strict Preset Security Policy|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|Quarantine|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.104` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA104.Tests.ps1`

---

### ‚úÖ ORCA.105: Safe Links Synchronous URL detonation is enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When the 'Wait for URL scanning to complete before delivering the message' option is configured, messages that contain URLs to be scanned will be held until the URLs finish scanning and are confirmed to be safe before the messages are delivered.

#### Remediation action
Enable Safe Links Synchronous URL detonation.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Recommended settings for EOP and Office 365 Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-7) 
* [Set up Microsoft Defender for Office 365 Safe Links policies](https://aka.ms/orca-atpp-docs-10)


#### Test Results

Well done! Safe Links Synchronous URL detonation is enabled.



|Policy|Setting|Current Value|Result|
|-|-|-|-|
|Built-In Protection Policy|DeliverMessageAfterScan|True|üóÑ Skip|
|Built-In Protection Policy|ScanUrls|True|üóÑ Skip|
|Strict Preset Security Policy|DeliverMessageAfterScan|True|‚úÖ Pass|
|Strict Preset Security Policy|ScanUrls|True|‚úÖ Pass|
|Standard Preset Security Policy|DeliverMessageAfterScan|True|‚úÖ Pass|
|Standard Preset Security Policy|ScanUrls|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.105` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA105.Tests.ps1`

---

### ‚úÖ ORCA.106: Quarantine retention period is 30 days.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

You can view, release, download, delete and report false positive quarantined email messages or files captured by Microsoft Defender for Office 365 (MDO) for SharePoint Online, OneDrive for Business, and Microsoft Teams in Office 365. Keep messages in the quarantine for 30 days to allow enough time for further investigation. This is the default value and also the maximum.

#### Remediation action
Configure the Quarantine retention period to 30 days.

#### Related Links

* [Manage quarantined messages and files as an administrator in Office 365](https://aka.ms/orca-antispam-docs-6) 
* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Office 365 Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Quarantine retention period is 30 days.



|Anti-Spam Filter Policy|Quarantine Retention Period|Result|
|-|-|-|
|Default|15|üóÑ Skip|
|Strict Preset Security Policy|30|‚úÖ Pass|
|Standard Preset Security Policy|30|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.106` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA106.Tests.ps1`

---

### ‚úÖ ORCA.107: End-user spam notification is enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Enable End-user Spam notifications to let users manage their own spam-quarantined messages (Release, Block sender, Review). End-user spam notifications contain a list of all spam-quarantined messages that the end-user has received during a time period. Policies that do not apply to a spam policy as either a spam, or bulk action, will appear disabled below.

#### Remediation action
Enable End-user Spam notifications on a quarantine policy.

#### Related Links

* [Configure end-user spam notifications in Exchange Online](https://aka.ms/orca-antispam-docs-2) 
* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Office 365 Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! End-user spam notification is enabled.



|Quarantine Policy|Setting|Current Value|Result|
|-|-|-|-|
|DefaultFullAccessPolicy|ESNEnabled|False|üóÑ Skip|
|AdminOnlyAccessPolicy|ESNEnabled|False|üóÑ Skip|
|DefaultFullAccessWithNotificationPolicy|ESNEnabled|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.107` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA107.Tests.ps1`

---

### ‚úÖ ORCA.108: DKIM signing is set up for all your custom domains.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

DKIM signing can help protect the authenticity of your messages in transit and can assist with deliverability of your email messages.

#### Remediation action
Set up DKIM signing to sign your emails.

#### Related Links

* [Microsoft 365 Defender Portal - DKIM](https://security.microsoft.com/authentication?viewid=DKIM) 
* [Use DKIM to validate outbound email sent from your custom domain in Office 365](https://aka.ms/orca-dkim-docs-1)


#### Test Results

Well done! DKIM signing is set up for all your custom domains.



|Domain|Signing Setting|Result|
|-|-|-|
|giraffe-it.cloud|True|‚úÖ Pass|
|Giraffe-it.eu|True|‚úÖ Pass|
|giraffe-it.com|True|‚úÖ Pass|
|Giraffe-it.nl|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.108` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA108.Tests.ps1`

---

### ‚úÖ ORCA.108.1: DNS Records have been set up to support DKIM.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

DKIM signing can help protect the authenticity of your messages in transit and can assist with deliverability of your email messages.

#### Remediation action
Set up the required selector DNS records in order to support DKIM.

#### Related Links

* [Use DKIM to validate outbound email sent from your custom domain in Office 365](https://aka.ms/orca-dkim-docs-1)


#### Test Results

Well done! DNS Records have been set up to support DKIM.



|Domain|DNS Record|Result|
|-|-|-|
|giraffe-it.cloud|Selector1 CNAME selector1-giraffeit-cloud01i._domainkey.Giraffeit.d-v1.dkim.mail.microsoft|‚úÖ Pass|
|giraffe-it.cloud|Selector2 CNAME selector2-giraffeit-cloud01i._domainkey.Giraffeit.d-v1.dkim.mail.microsoft|‚úÖ Pass|
|Giraffe-it.eu|Selector1 CNAME selector1-Giraffeit-eu01i._domainkey.Giraffeit.e-v1.dkim.mail.microsoft|‚úÖ Pass|
|Giraffe-it.eu|Selector2 CNAME selector2-Giraffeit-eu01i._domainkey.Giraffeit.e-v1.dkim.mail.microsoft|‚úÖ Pass|
|giraffe-it.com|Selector1 CNAME selector1-giraffeit-com01i._domainkey.Giraffeit.d-v1.dkim.mail.microsoft|‚úÖ Pass|
|giraffe-it.com|Selector2 CNAME selector2-giraffeit-com01i._domainkey.Giraffeit.d-v1.dkim.mail.microsoft|‚úÖ Pass|
|Giraffe-it.nl|Selector1 CNAME selector1-Giraffeit-nl01i._domainkey.Giraffeit.e-v1.dkim.mail.microsoft|‚úÖ Pass|
|Giraffe-it.nl|Selector2 CNAME selector2-Giraffeit-nl01i._domainkey.Giraffeit.e-v1.dkim.mail.microsoft|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.108.1` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA108_1.Tests.ps1`

---

### ‚úÖ ORCA.109: Senders are not being allow listed in an unsafe manner.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Emails coming from allow listed senders bypass several layers of protection within Exchange Online Protection. If senders are allow listed, they are open to being spoofed from malicious actors.

#### Remediation action
Remove allow listing on senders.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Office 365 Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6) 
* [Use Anti-Spam Policy Sender/Domain Allow lists](https://aka.ms/orca-antispam-docs-4)


#### Test Results

Well done! Senders are not being allow listed in an unsafe manner.



|Anti-Spam Policy|Allowed Senders|Result|
|-|-|-|
|Default|No Sender Detected|üóÑ Skip|
|Strict Preset Security Policy|No Sender Detected|‚úÖ Pass|
|Standard Preset Security Policy|No Sender Detected|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.109` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA109.Tests.ps1`

---

### ‚ùå ORCA.110: Internal Sender notifications are disabled.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Notifying internal senders about malware detected in email messages could have negative impact. An adversary with access to an already compromised mailbox may use this information to verify effectiveness of malware detection.

#### Remediation action
Disable notifying internal senders of malware detection.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-malware](https://security.microsoft.com/antimalwarev2) 
* [Recommended settings for EOP and Office 365 Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

The configured settings are not set as recommended.



|Malware Policy|EnableInternalSenderAdminNotifications|Result|
|-|-|-|
|Default|True|üóÑ Skip|
|Strict Preset Security Policy|False|‚úÖ Pass|
|Standard Preset Security Policy|False|‚úÖ Pass|
|CIS L2 Attachment Policy|True|‚ùå Fail|


**Tag**: `ORCA` `ORCA.110` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA110.Tests.ps1`

---

### ‚úÖ ORCA.111: Anti-phishing policy exists and EnableUnauthenticatedSender is true.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When the sender email address is spoofed, the message appears to originate from someone or somewhere other than the actual source. It is recommended to enable unauthenticated sender tagging in Office 365 Anti-phishing policies. The feature apply a '?' symbol in Outlook's sender card if the sender fails authentication checks.

#### Remediation action
Enable unauthenticated sender tagging in Anti-phishing policy.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Office 365 Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6) 
* [Unverified Sender](https://aka.ms/orca-atpp-docs-12)


#### Test Results

Well done! Anti-phishing policy exists and EnableUnauthenticatedSender is true.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableUnauthenticatedSender|True|üóÑ Skip|
|Strict Preset Security Policy|EnableUnauthenticatedSender|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableUnauthenticatedSender|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.111` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA111.Tests.ps1`

---

### ‚úÖ ORCA.112: Anti-spoofing protection action is configured to Move message to the recipients' Junk Email folders in Anti-phishing policy.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When the sender email address is spoofed, the message appears to originate from someone or somewhere other than the actual source. With Standard security settings it is recommended to configure Anti-spoofing protection action to Move message to the recipients' Junk Email folders in Office 365 Anti-phishing policies.

#### Remediation action
Configure Anti-spoofing protection action to Move message to the recipients' Junk Email folders in Anti-phishing policy.

#### Related Links

* [Configuring the anti-spoofing policy](https://aka.ms/orca-atpp-docs-5) 
* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Office 365 Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Anti-spoofing protection action is configured to Move message to the recipients' Junk Email folders in Anti-phishing policy.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|AuthenticationFailAction|MoveToJmf|üóÑ Skip|
|Strict Preset Security Policy|AuthenticationFailAction|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|AuthenticationFailAction|MoveToJmf|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.112` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA112.Tests.ps1`

---

### ‚úÖ ORCA.113: AllowClickThrough is disabled in Safe Links policies.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Microsoft Defender for Office 365 Safe Links can help protect your organization by providing time-of-click verification of  web addresses (URLs) in email messages and Office documents. It is possible to allow users click through Safe Links to the original URL. It is recommended to configure Safe Links policies to not let users click through safe links. 

#### Remediation action
Do not let users click through safe links to original URL.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Microsoft Defender for Office 365 Safe Links policies](https://aka.ms/orca-atpp-docs-11) 
* [Recommended settings for EOP and Office 365 Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-8)


#### Test Results

Well done! AllowClickThrough is disabled in Safe Links policies.



|Policy|Setting|Current Value|Result|
|-|-|-|-|
|Built-In Protection Policy|AllowClickThrough|True|üóÑ Skip|
|Strict Preset Security Policy|AllowClickThrough|False|‚úÖ Pass|
|Standard Preset Security Policy|AllowClickThrough|False|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.113` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA113.Tests.ps1`

---

### ‚úÖ ORCA.114: No IP Allow Lists have been configured.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

IP addresses contained in the IP allow list are able to bypass spam, phishing and spoofing checks, potentially resulting in more spam. Ensure that the IP list is kept to a minimum.

#### Remediation action
Remove IP addresses from IP allow list.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Use Anti-Spam Policy IP Allow lists](https://aka.ms/orca-antispam-docs-3)


#### Test Results

Well done! No IP Allow Lists have been configured.



|Anti-Spam Policy|Allowed IP|Result|
|-|-|-|
|Default|No IP detected|üóÑ Skip|


**Tag**: `ORCA` `ORCA.114` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA114.Tests.ps1`

---

### ‚úÖ ORCA.115: Mailbox intelligence based impersonation protection is enabled in anti-phishing policies.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Mailbox Intelligence Protection enhances impersonation protection for users based on each user's individual sender graph.

#### Remediation action
Enable Mailbox intelligence based impersonation protection in anti-phishing policies.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-7) 
* [Set up Microsoft Defender for Office 365 anti-phishing and anti-phishing policies](https://aka.ms/orca-atpp-docs-9)


#### Test Results

Well done! Mailbox intelligence based impersonation protection is enabled in anti-phishing policies.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableMailboxIntelligenceProtection|True|üóÑ Skip|
|Strict Preset Security Policy|EnableMailboxIntelligenceProtection|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableMailboxIntelligenceProtection|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.115` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA115.Tests.ps1`

---

### ‚úÖ ORCA.116: Mailbox intelligence based impersonation protection action set to move message to junk mail folder.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Mailbox intelligence protection enhances impersonation protection for users based on each user's individual sender graph. Move messages that are caught to junk mail folder.

#### Remediation action
Change Mailbox intelligence based impersonation protection action to move message to junk mail folder.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-7) 
* [Set up Microsoft Defender for Office 365 anti-phishing and anti-phishing policies](https://aka.ms/orca-atpp-docs-9)


#### Test Results

Well done! Mailbox intelligence based impersonation protection action set to move message to junk mail folder.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|MailboxIntelligenceProtectionAction|NoAction|üóÑ Skip|
|Strict Preset Security Policy|MailboxIntelligenceProtectionAction|Quarantine|üóÑ Skip|
|Standard Preset Security Policy|MailboxIntelligenceProtectionAction|MoveToJmf|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.116` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA116.Tests.ps1`

---

### ‚úÖ ORCA.118.1: Domains are not being allow listed in an unsafe manner in Anti-Spam Policies.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Emails coming from allow listed domains bypass several layers of protection within Exchange Online Protection. If domains are allow listed, they are open to being spoofed from malicious actors.

#### Remediation action
Remove allow listing on domains.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Use Anti-Spam Policy Sender/Domain Allow lists](https://aka.ms/orca-antispam-docs-4)


#### Test Results

Well done! Domains are not being allow listed in an unsafe manner in Anti-Spam Policies.



|Anti-Spam Policy|Allowlisted Domain|Result|
|-|-|-|
|Default|No domain available|üóÑ Skip|
|Strict Preset Security Policy|No domain available|‚úÖ Pass|
|Standard Preset Security Policy|No domain available|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.118.1` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA118_1.Tests.ps1`

---

### ‚úÖ ORCA.118.2: Domains are not being allow listed in an unsafe manner in Transport Rules.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Emails coming from allow listed domains bypass several layers of protection within Exchange Online Protection. If domains are allow listed, they are open to being spoofed from malicious actors.

#### Remediation action
Remove allow listed domains.

#### Related Links

* [Exchange admin center in Exchange Online](https://outlook.office365.com/ecp/) 
* [Using Exchange Transport Rules (ETRs) to allow specific senders](https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/create-safe-sender-lists-in-office-365#using-exchange-transport-rules-etrs-to-allow-specific-senders-recommended)


#### Test Results

Well done! Domains are not being allow listed in an unsafe manner in Transport Rules.



**Tag**: `ORCA` `ORCA.118.2` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA118_2.Tests.ps1`

---

### ‚úÖ ORCA.118.3: Your own domains are not being allow listed in an unsafe manner in Anti-Spam Policies.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Emails coming from allow listed domains bypass several layers of protection within Exchange Online Protection. When allow listing your own domains, an attacker can spoof any account in your organisation that has this domain. This is a significant phishing attack vector.

#### Remediation action
Remove allow listing on domains belonging to your organisation.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Use Anti-Spam Policy Sender/Domain Allow lists](https://aka.ms/orca-antispam-docs-4)


#### Test Results

Well done! Your own domains are not being allow listed in an unsafe manner in Anti-Spam Policies.



|Anti-Spam Policy|Organisation Domain Allow Listed|Result|
|-|-|-|
|Default|Allowed sender domains empty|üóÑ Skip|
|Strict Preset Security Policy|Allowed sender domains empty|‚úÖ Pass|
|Standard Preset Security Policy|Allowed sender domains empty|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.118.3` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA118_3.Tests.ps1`

---

### ‚úÖ ORCA.118.4: Your own domains are not being allow listed in an unsafe manner in Transport Rules.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Emails coming from allow listed domains bypass several layers of protection within Exchange Online Protection. When allow listing your own domains, an attacker can spoof any account in your organisation that has this domain. This is a significant phishing attack vector.

#### Remediation action
Remove allow listing on domains belonging to your organisation.

#### Related Links

* [Exchange admin center in Exchange Online](https://outlook.office365.com/ecp/) 
* [Using Exchange Transport Rules (ETRs) to allow specific senders](https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/create-safe-sender-lists-in-office-365#using-exchange-transport-rules-etrs-to-allow-specific-senders-recommended)


#### Test Results

Well done! Your own domains are not being allow listed in an unsafe manner in Transport Rules.



**Tag**: `ORCA` `ORCA.118.4` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA118_4.Tests.ps1`

---

### ‚úÖ ORCA.119: Similar Domains Safety Tips is enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Microsoft Defender for Office 365 can show a warning tip to recipients in messages that might be from an impersonated domain.

#### Remediation action
Enable Similar Domains Safety Tips so that users can receive visible indication on incoming messages.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Similar Domains Safety Tips is enabled.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableSimilarDomainsSafetyTips|False|üóÑ Skip|
|Strict Preset Security Policy|EnableSimilarDomainsSafetyTips|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableSimilarDomainsSafetyTips|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.119` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA119.Tests.ps1`

---

### ‚úÖ ORCA.120.1: Zero Hour Autopurge Enabled for Phish.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Zero Hour Autopurge can assist removing false-negatives post detection from mailboxes. By default, it is enabled.

#### Remediation action
Enable Zero Hour Autopurge.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6) 
* [Zero-hour auto purge - protection against spam and malware](https://aka.ms/orca-zha-docs-2)


#### Test Results

Well done! Zero Hour Autopurge Enabled for Phish.



|Policy|ZapEnabled Setting|Result|
|-|-|-|
|Default|True|üóÑ Skip|
|Strict Preset Security Policy|True|‚úÖ Pass|
|Standard Preset Security Policy|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.120.1` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA120_phish.Tests.ps1`

---

### ‚úÖ ORCA.120.2: Zero Hour Autopurge Enabled for Malware.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Zero Hour Autopurge can assist removing false-negatives post detection from mailboxes. By default, it is enabled.

#### Remediation action
Enable Zero Hour Autopurge.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-malware](https://security.microsoft.com/antimalwarev2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Zero Hour Autopurge Enabled for Malware.



|Policy|ZapEnabled Setting|Result|
|-|-|-|
|Default|True|üóÑ Skip|
|Strict Preset Security Policy|True|‚úÖ Pass|
|Standard Preset Security Policy|True|‚úÖ Pass|
|CIS L2 Attachment Policy|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.120.2` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA120_malware.Tests.ps1`

---

### ‚úÖ ORCA.120.3: Zero Hour Autopurge Enabled for Spam.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Zero Hour Autopurge can assist removing false-negatives post detection from mailboxes. By default, it is enabled.

#### Remediation action
Enable Zero Hour Autopurge.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6) 
* [Zero-hour auto purge - protection against spam and malware](https://aka.ms/orca-zha-docs-2)


#### Test Results

Well done! Zero Hour Autopurge Enabled for Spam.



|Policy|ZapEnabled Setting|Result|
|-|-|-|
|Default|True|üóÑ Skip|
|Strict Preset Security Policy|True|‚úÖ Pass|
|Standard Preset Security Policy|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.120.3` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA120_spam.Tests.ps1`

---

### ‚úÖ ORCA.121: Supported filter policy action used.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Zero Hour Autopurge can assist removing false-negatives post detection from mailboxes. It requires a supported action in the spam filter policy.

#### Remediation action
Change filter policy action to support Zero Hour Auto Purge.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Zero-hour auto purge - protection against spam and malware](https://aka.ms/orca-zha-docs-2)


#### Test Results

Well done! Supported filter policy action used.



|Policy|Setting|Action|Result|
|-|-|-|-|
|Default|SpamAction|MoveToJmf|üóÑ Skip|
|Default|PhishSpamAction|MoveToJmf|üóÑ Skip|
|Strict Preset Security Policy|SpamAction|Quarantine|‚úÖ Pass|
|Strict Preset Security Policy|PhishSpamAction|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|SpamAction|MoveToJmf|‚úÖ Pass|
|Standard Preset Security Policy|PhishSpamAction|Quarantine|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.121` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA121.Tests.ps1`

---

### ‚úÖ ORCA.123: Unusual Characters Safety Tips is enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Microsoft Defender for Office 365 can show a warning tip to recipients where the sender name or email address contains character sets that aren't usually used together.

#### Remediation action
Enable Unusual Characters Safety Tips so that users can receive visible indication on incoming messages.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Unusual Characters Safety Tips is enabled.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableUnusualCharactersSafetyTips|False|üóÑ Skip|
|Strict Preset Security Policy|EnableUnusualCharactersSafetyTips|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableUnusualCharactersSafetyTips|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.123` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA123.Tests.ps1`

---

### ‚úÖ ORCA.124: Safe attachments unknown malware response set to block messages.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When Safe attachments unknown malware response set to block, Microsoft Defender for Office 365 prevents current and future messages with detected malware from proceeding and sends messages to quarantine in Office 365.

#### Remediation action
Set Safe attachments unknown malware response to block messages.

#### Related Links

* [Microsoft 365 Defender Portal - Safe attachments](https://security.microsoft.com/safeattachmentv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Safe attachments unknown malware response set to block messages.



|Safe Attachments Policy|Setting|Current Value|Result|
|-|-|-|-|
|Built-In Protection Policy|Action|Block|üóÑ Skip|
|Strict Preset Security Policy|Action|Block|‚úÖ Pass|
|Standard Preset Security Policy|Action|Block|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.124` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA124.Tests.ps1`

---

### ‚úÖ ORCA.139: Spam action set to move message to junk mail folder or quarantine.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

It is recommended to configure Spam detection action to Move messages to Junk Email folder.

#### Remediation action
Change Spam action to move message to Junk Email Folder.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365 security](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Spam action set to move message to junk mail folder or quarantine.



|Anti-Spam Policy|Action|Result|
|-|-|-|
|Default|MoveToJmf|üóÑ Skip|
|Strict Preset Security Policy|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|MoveToJmf|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.139` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA139.Tests.ps1`

---

### ‚úÖ ORCA.140: High Confidence Spam action set to Quarantine message.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

It is recommended to configure High Confidence Spam detection action to Quarantine message.

#### Remediation action
Change High Confidence Spam action to Quarantine message.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! High Confidence Spam action set to Quarantine message.



|Anti-Spam Policy|Action|Result|
|-|-|-|
|Default|MoveToJmf|üóÑ Skip|
|Strict Preset Security Policy|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|Quarantine|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.140` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA140.Tests.ps1`

---

### ‚úÖ ORCA.141: Bulk action set to Move message to Junk Email Folder.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

It is recommended to configure Bulk detection action to Move messages to Junk Email folder.

#### Remediation action
Change bulk action to move messages to junk mail folder.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Bulk action set to Move message to Junk Email Folder.



|Anti-Spam Policy|Action|Result|
|-|-|-|
|Default|MoveToJmf|üóÑ Skip|
|Strict Preset Security Policy|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|MoveToJmf|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.141` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA141.Tests.ps1`

---

### ‚úÖ ORCA.142: Phish action set to Quarantine message.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

It is recommended to configure the Phish detection action to Quarantine so that these emails are not visible to the end user from within Outlook. As Phishing emails are designed to look legitimate, users may mistakenly think that a phishing email in Junk is false-positive.

#### Remediation action
Change Phish action to Quarantine message.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-6)


#### Test Results

Well done! Phish action set to Quarantine message.



|Anti-Spam Policy|Action|Result|
|-|-|-|
|Default|MoveToJmf|üóÑ Skip|
|Strict Preset Security Policy|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|Quarantine|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.142` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA142.Tests.ps1`

---

### ‚úÖ ORCA.156: Safe Links Policies are tracking when user clicks on safe links.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When these options are configured, click data for URLs in Word, Excel, PowerPoint, Visio documents and in emails is stored by Safe Links. This information can help dealing with phishing, suspicious email messages and URLs.

#### Remediation action
Enable tracking of user clicks in Safe Links Policies.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Safe Links Policies are tracking when user clicks on safe links.



|Policy|Setting|Current Value|Result|
|-|-|-|-|
|Built-In Protection Policy|TrackClicks|True|üóÑ Skip|
|Strict Preset Security Policy|TrackClicks|True|‚úÖ Pass|
|Standard Preset Security Policy|TrackClicks|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.156` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA156.Tests.ps1`

---

### ‚úÖ ORCA.158: Safe Attachments is enabled for SharePoint and Teams.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Safe Attachments can assist by scanning for zero day malware by using behavioural analysis and sandboxing techniques. These checks suppliment signature definitions.

#### Remediation action
Enable Safe Attachments for SharePoint and Teams.

#### Related Links

* [Microsoft 365 Defender Portal - Safe attachments](https://security.microsoft.com/safeattachmentv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Safe Attachments is enabled for SharePoint and Teams.



|Safe Attachments Policy|Setting|Current Value|Result|
|-|-|-|-|
|Default|EnableATPForSPOTeamsODB|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.158` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA158.Tests.ps1`

---

### ‚úÖ ORCA.179: Safe Links is enabled intra-organization.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Phishing attacks are not limited from external users. Commonly, when one user is compromised, that user can be used in a process of lateral movement between different accounts in your organization. Configuring Safe Links so that internal messages are also re-written can assist with lateral movement using phishing. The built-in policy is ignored in this check, as it only provides the minimum level of protection.

#### Remediation action
Enable Safe Links between internal users.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Safe Links is enabled intra-organization.



|SafeLinks Policy|Enabled for Internal|Result|
|-|-|-|
|Built-In Protection Policy|False|üóÑ Skip|
|Strict Preset Security Policy|True|‚úÖ Pass|
|Standard Preset Security Policy|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.179` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA179.Tests.ps1`

---

### ‚úÖ ORCA.180: Anti-phishing policy exists and EnableSpoofIntelligence is true.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When the sender email address is spoofed, the message appears to originate from someone or somewhere other than the actual source. Anti-spoofing protection examines forgery of the 'From: header' which is the one that shows up in an email client like Outlook. It is recommended to enable anti-spoofing protection in Office 365 Anti-phishing policies.

#### Remediation action
Enable anti-spoofing protection in Anti-phishing policy.

#### Related Links

* [Anti-spoofing protection in Office 365](https:/aka.ms/orca-atpp-docs-3) 
* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Anti-phishing policy exists and EnableSpoofIntelligence is true.



|Policy|Setting|Antispoof Enforced|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableSpoofIntelligence|True|üóÑ Skip|
|Strict Preset Security Policy|EnableSpoofIntelligence|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableSpoofIntelligence|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.180` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA180.Tests.ps1`

---

### ‚úÖ ORCA.189: Safe Attachments is not bypassed.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Microsoft Defender for Office 365 Safe Attachments assists scanning for zero day malware by using behavioural analysis and sandboxing, supplementing signature definitions. The protection can be bypassed using mail flow rules which set the X-MS-Exchange-Organization-SkipSafeAttachmentProcessing header for email messages.

#### Remediation action
Remove mail flow rules which bypass Safe Attachments.

#### Related Links

* [Exchange admin center in Exchange Online](https://outlook.office365.com/ecp/)


#### Test Results

Well done! Safe Attachments is not bypassed.



**Tag**: `ORCA` `ORCA.189` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA189.Tests.ps1`

---

### ‚úÖ ORCA.189.2: Safe Links is not bypassed.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Microsoft Defender for Office 365 Safe Links can help protect against phishing attacks by providing time-of-click verification of web addresses (URLs) in email messages and Office documents. The protection can be bypassed using mail flow rules which set the X-MS-Exchange-Organization-SkipSafeLinksProcessing header for email messages.

#### Remediation action
Remove mail flow rules which bypass Safe Links.

#### Related Links

* [Exchange admin center in Exchange Online](https://outlook.office365.com/ecp/)


#### Test Results

Well done! Safe Links is not bypassed.



**Tag**: `ORCA` `ORCA.189.2` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA189_2.Tests.ps1`

---

### ‚ùå ORCA.205: Common attachment type filter is enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

The common attachment type filter can block file types that commonly contain malware, including in internal emails.

#### Remediation action
Enable common attachment type filter.

#### Related Links

* [Configure anti-malware policies](https://aka.ms/orca-mfp-docs-1) 
* [Microsoft 365 Defender Portal - Anti-malware](https://security.microsoft.com/antimalwarev2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-6)


#### Test Results

The configured settings are not set as recommended.



|Policy|Setting|Missing Default File Type|Result|
|-|-|-|-|
|Default|FileFilter|Enabled with all default file types|üóÑ Skip|
|Strict Preset Security Policy|FileFilter|Enabled with all default file types|‚úÖ Pass|
|Standard Preset Security Policy|FileFilter|Enabled with all default file types|‚úÖ Pass|
|CIS L2 Attachment Policy|FileFilter|apk,library|‚ùå Fail|


**Tag**: `ORCA` `ORCA.205` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA205.Tests.ps1`

---

### ‚úÖ ORCA.220: Advanced Phish filter Threshold level is adequate.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

The higher the Advanced Phishing Threshold Level, the stricter the mechanisms are that detect phishing attempts against your users.

#### Remediation action
Set Advanced Phish filter Threshold to 3 or 4.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Advanced Phish filter Threshold level is adequate.



|Antiphishing Policy|Advanced Phishing Threshold Level|Result|
|-|-|-|
|Office365 AntiPhish Default|2|üóÑ Skip|
|Strict Preset Security Policy|4|‚úÖ Pass|
|Standard Preset Security Policy|3|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.220` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA220.Tests.ps1`

---

### ‚úÖ ORCA.221: Mailbox intelligence is enabled in anti-phishing policies.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Mailbox Intelligence checks can provide your users with intelligence on suspicious incoming emails that appear to be from users that they normally communicate with based on their graph.

#### Remediation action
Enable mailbox intelligence in anti-phishing policies.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Mailbox intelligence is enabled in anti-phishing policies.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableMailboxIntelligence|True|üóÑ Skip|
|Strict Preset Security Policy|EnableMailboxIntelligence|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableMailboxIntelligence|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.221` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA221.Tests.ps1`

---

### ‚úÖ ORCA.222: Domain Impersonation action is set to move to Quarantine.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Domain Impersonation can detect impersonation attempts against your domains or domains that look very similiar to your domains. Move messages that are caught using this impersonation protection to Quarantine.

#### Remediation action
Configure domain impersonation action to Quarantine.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Domain Impersonation action is set to move to Quarantine.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableTargetedDomainsProtection|False|üóÑ Skip|
|Office365 AntiPhish Default|EnableOrganizationDomainsProtection|False|üóÑ Skip|
|Office365 AntiPhish Default|TargetedDomainProtectionAction|NoAction|üóÑ Skip|
|Strict Preset Security Policy|EnableTargetedDomainsProtection|True|‚úÖ Pass|
|Strict Preset Security Policy|EnableOrganizationDomainsProtection|True|‚úÖ Pass|
|Strict Preset Security Policy|TargetedDomainProtectionAction|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|EnableTargetedDomainsProtection|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableOrganizationDomainsProtection|True|‚úÖ Pass|
|Standard Preset Security Policy|TargetedDomainProtectionAction|Quarantine|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.222` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA222.Tests.ps1`

---

### ‚úÖ ORCA.223: User impersonation action is set to move to Quarantine.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

User impersonation protection can detect spoofing of your sensitive users. Move messages that are caught using user impersonation detection to Quarantine.

#### Remediation action
Configure user impersonation action to Quarantine.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! User impersonation action is set to move to Quarantine.



|Antiphishing Policy|Setting|Action|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableTargetedUserProtection|False|üóÑ Skip|
|Office365 AntiPhish Default|TargetedUserProtectionAction|NoAction|üóÑ Skip|
|Strict Preset Security Policy|EnableTargetedUserProtection|True|‚úÖ Pass|
|Strict Preset Security Policy|TargetedUserProtectionAction|Quarantine|‚úÖ Pass|
|Standard Preset Security Policy|EnableTargetedUserProtection|True|‚úÖ Pass|
|Standard Preset Security Policy|TargetedUserProtectionAction|Quarantine|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.223` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA223.Tests.ps1`

---

### ‚úÖ ORCA.224: Similar Users Safety Tips is enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Microsoft Defender for Office 365 can show a warning tip to recipients in messages that might be from an impersonated user.

#### Remediation action
Enable Similar Users Safety Tips so that users can receive visible indication on incoming messages.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Similar Users Safety Tips is enabled.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableSimilarUsersSafetyTips|False|üóÑ Skip|
|Strict Preset Security Policy|EnableSimilarUsersSafetyTips|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableSimilarUsersSafetyTips|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.224` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA224.Tests.ps1`

---

### ‚úÖ ORCA.225: Safe Documents is enabled for Office clients.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Safe Documents can assist protecting files opened in Office appplications. Before a user is allowed to trust a file opened in Office 365 ProPlus using Protected View, the file will be verified by Microsoft Defender for Office 365.

#### Remediation action
Enable Safe Documents for Office clients.

#### Related Links

* [Microsoft 365 Defender Portal - Safe attachments](https://security.microsoft.com/safeattachmentv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7) 
* [Safe Documents in Microsoft 365 E5](https://aka.ms/orca-atpp-docs-1)


#### Test Results

Well done! Safe Documents is enabled for Office clients.



|Safe Attachments Policy|Setting|Current Value|Result|
|-|-|-|-|
|Default|EnableSafeDocs|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.225` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA225.Tests.ps1`

---

### ‚ùå ORCA.226: Each domain has a Safe Link policy applied to it.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Microsoft Defender for Office 365 Safe Links policies are applied using rules. The recipient domain condition is the most effective way of applying the Safe Links policy, ensuring no users are left without protection. If polices are applied using group membership make sure you cover all users through this method. Applying polices this way can be challenging, users may left unprotected if group memberships are not accurate and up to date. It is important not to rely on the 'built-in' Safe Links policy, as this policy only applies the minimum level of protections and should serve as a catch-all.

#### Remediation action
Apply a Safe Links policy to every domain.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Order and precedence of email protection](https://aka.ms/orca-atpp-docs-4) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

The configured settings are not set as recommended.



|Domain|Policy|Priority|Result|
|-|-|-|-|
|giraffe-it.cloud|No Policy Applying||‚ùå Fail|
|Giraffe-it.eu|No Policy Applying||‚ùå Fail|
|Giraffeit.onmicrosoft.com|No Policy Applying||‚ùå Fail|
|giraffe-it.com|No Policy Applying||‚ùå Fail|
|Giraffe-it.nl|No Policy Applying||‚ùå Fail|


**Tag**: `ORCA` `ORCA.226` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA226.Tests.ps1`

---

### ‚ùå ORCA.227: Each domain has a Safe Attachments policy applied to it.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Microsoft Defender for Office 365 Safe Attachments policies are applied using rules. The recipient domain condition is the most effective way of applying the Safe Attachments policy, ensuring no users are left without protection. If polices are applied using group membership make sure you cover all users through this method. Applying polices this way can be challenging, users may left unprotected if group memberships are not accurate and up to date. It is important not to rely on the 'built-in' Safe Links policy, as this policy only applies the minimum level of protections and should serve as a catch-all.

#### Remediation action
Apply a Safe Attachments policy to every domain.

#### Related Links

* [Microsoft 365 Defender Portal - Safe attachments](https://security.microsoft.com/safeattachmentv2) 
* [Order and precedence of email protection](https://aka.ms/orca-atpp-docs-4) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

The configured settings are not set as recommended.



|Domain|Policy|Priority|Result|
|-|-|-|-|
|giraffe-it.cloud|No Policy Applying||‚ùå Fail|
|Giraffe-it.eu|No Policy Applying||‚ùå Fail|
|Giraffeit.onmicrosoft.com|No Policy Applying||‚ùå Fail|
|giraffe-it.com|No Policy Applying||‚ùå Fail|
|Giraffe-it.nl|No Policy Applying||‚ùå Fail|


**Tag**: `ORCA` `ORCA.227` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA227.Tests.ps1`

---

### ‚úÖ ORCA.228: No trusted senders in Anti-phishing policy.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Adding senders as trusted in Anti-phishing policy will result in the action for protected domains, Protected users or mailbox intelligence protection will be not applied to messages coming from these senders. If a trusted sender needs to be added based on organizational requirements it should be reviewed regularly and updated as needed.

#### Remediation action
Remove allow listing on senders in Anti-phishing policy.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! No trusted senders in Anti-phishing policy.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|ExcludedSenders|No Sender Detected|üóÑ Skip|
|Strict Preset Security Policy|ExcludedSenders|No Sender Detected|‚úÖ Pass|
|Standard Preset Security Policy|ExcludedSenders|No Sender Detected|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.228` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA228.Tests.ps1`

---

### ‚ùå ORCA.229: No trusted domains in Anti-phishing policy.

<img align="right" src="https://maester.dev/img/test-result/pill-fail.png" height="25" alt="Failed"/>

#### Overview

Adding domains as trusted in Anti-phishing policy will result in the action for protected domains, protected users or mailbox intelligence protection will be not applied to messages coming from these sender domains. If a trusted domain needs to be added based on organizational requirements it should be reviewed regularly and updated as needed. We also do not recommend adding domains from shared services.

#### Remediation action
Remove allow listing on domains in Anti-phishing policy.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

The configured settings are not set as recommended.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|ExcludedDomains|giraffe-it.tech|üóÑ Skip|
|Strict Preset Security Policy|ExcludedDomains|giraffe-it.tech|‚ùå Fail|
|Standard Preset Security Policy|ExcludedDomains|giraffe-it.tech|‚ùå Fail|


**Tag**: `ORCA` `ORCA.229` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA229.Tests.ps1`

---

### ‚úÖ ORCA.230: Each domain has a Anti-phishing policy applied to it, or the default policy is being used.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Microsoft Defender for Office 365 Anti-phishing policies are applied using rules. The default anti-phishing policy applies in the absence of a custom policy. When creating custom policies, there may be duplication of settings and depending on the rules and priority, some policies or settings may not even apply. It's important in this circumstance to check that the desired settings are applied to the right users.

#### Remediation action
Check your anti-phishing policies for duplicate rules. Some policies and settings may not be applying.

#### Related Links

* [Microsoft 365 Defender Portal - Antiphishing policies](https://security.microsoft.com/antiphishing) 
* [Order and precedence of email protection](https://aka.ms/orca-atpp-docs-4) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7) 
* [Setting up antiphishing policies](https://aka.ms/orca-atpp-docs-2)


#### Test Results

Well done! Each domain has a Anti-phishing policy applied to it, or the default policy is being used.



|Domain|Policy|Priority|Result|
|-|-|-|-|
|giraffe-it.cloud|Default|Default|‚úÖ Pass|
|Giraffe-it.eu|Default|Default|‚úÖ Pass|
|Giraffeit.onmicrosoft.com|Default|Default|‚úÖ Pass|
|giraffe-it.com|Default|Default|‚úÖ Pass|
|Giraffe-it.nl|Default|Default|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.230` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA230.Tests.ps1`

---

### ‚úÖ ORCA.231: Each domain has a anti-spam policy applied to it, or the default policy is being used.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Exchange Online Protection anti-spam policies are applied using rules. The default policy applies in the absence of a custom policy. When creating custom policies, there may be duplication of settings and depending on the rules and priority, some policies or settings may not even apply. It's important in this circumstance to check that the desired settings are applied to the right users.

#### Remediation action
Check your anti-spam policies for duplicate rules. Some policies and settings may not be applying.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam policies](https://security.microsoft.com/antispam) 
* [Order and precedence of email protection](https://aka.ms/orca-antispam-docs-5)


#### Test Results

Well done! Each domain has a anti-spam policy applied to it, or the default policy is being used.



|Domain|Policy|Priority|Result|
|-|-|-|-|
|giraffe-it.cloud|Default|Default|‚úÖ Pass|
|Giraffe-it.eu|Default|Default|‚úÖ Pass|
|Giraffeit.onmicrosoft.com|Default|Default|‚úÖ Pass|
|giraffe-it.com|Default|Default|‚úÖ Pass|
|Giraffe-it.nl|Default|Default|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.231` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA231.Tests.ps1`

---

### ‚úÖ ORCA.232: Each domain has a malware filter policy applied to it, or the default policy is being used.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Exchange Online Protection malware filter policies are applied using rules. The default policy applies in the absence of a custom policy. When creating custom policies, there may be duplication of settings and depending on the rules and priority, some policies or settings may not even apply. It's important in this circumstance to check that the desired settings are applied to the right users.

#### Remediation action
Check your malware filter policies for duplicate rules. Some policies and settings may not be applying.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-malware policies](https://security.microsoft.com/antimalwarev2) 
* [Order and precedence of email protection](https://aka.ms/orca-atpp-docs-4)


#### Test Results

Well done! Each domain has a malware filter policy applied to it, or the default policy is being used.



|Domain|Policy|Priority|Result|
|-|-|-|-|
|giraffe-it.cloud|CIS L2 Attachment Policy|0|‚úÖ Pass|
|Giraffe-it.eu|CIS L2 Attachment Policy|0|‚úÖ Pass|
|Giraffeit.onmicrosoft.com|CIS L2 Attachment Policy|0|‚úÖ Pass|
|giraffe-it.com|CIS L2 Attachment Policy|0|‚úÖ Pass|
|Giraffe-it.nl|CIS L2 Attachment Policy|0|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.232` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA232.Tests.ps1`

---

### ‚úÖ ORCA.233: Domains are pointed directly at EOP or enhanced filtering is used.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Exchange Online Protection (EOP) and Microsoft Defender for Office 365 (MDO) works best when the mail exchange (MX) record is pointed directly at the service. In the event another third-party service is being used, a very important signal (the senders IP address) is obfuscated and hidden from EOP & MDO, generating a larger quantity of false positives and false negatives. By configuring Enhanced Filtering with the IP addresses of these services the true senders IP address can be discovered, reducing the false-positive and false-negative impact.

#### Remediation action
Send mail directly to EOP or configure enhanced filtering.

#### Related Links

* [Enhanced Filtering for Connectors](https://aka.ms/orca-connectors-docs-1) 
* [Microsoft 365 Defender Portal - Enhanced Filtering](https://aka.ms/orca-connectors-action-skiplisting)


#### Test Results

Well done! Domains are pointed directly at EOP or enhanced filtering is used.



|Domain|Points to Service|Enhanced Filtering|Result|
|-|-|-|-|
|giraffe-it.cloud|Yes|Not Required|‚úÖ Pass|
|Giraffe-it.eu|Yes|Not Required|‚úÖ Pass|
|Giraffeit.onmicrosoft.com|Yes|Not Required|‚úÖ Pass|
|giraffe-it.com|Yes|Not Required|‚úÖ Pass|
|Giraffe-it.nl|Yes|Not Required|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.233` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA233.Tests.ps1`

---

### ‚úÖ ORCA.233.1: Domains are pointed directly at EOP or enhanced filtering is configured on all default connectors.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Exchange Online Protection (EOP) and Microsoft Defender for Office 365 works best when the mail exchange (MX) record is pointed directly at the service. In the event another third-party service is being used, a very important signal (the senders IP address) is obfuscated and hidden from EOP & MDO, generating a larger quantity of false positives and false negatives. By configuring Enhanced Filtering with the IP addresses of these services the true senders IP address can be discovered, reducing the false-positive and false-negative impact.

#### Remediation action
Configure enhanced filtering on connectors when email path is not direct to EOP.

#### Related Links

* [Enhanced Filtering for Connectors](https://aka.ms/orca-connectors-docs-1) 
* [Microsoft 365 Defender Portal - Enhanced Filtering](https://aka.ms/orca-connectors-action-skiplisting)


#### Test Results

Well done! Domains are pointed directly at EOP or enhanced filtering is configured on all default connectors.



**Tag**: `ORCA` `ORCA.233.1` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA233_1.Tests.ps1`

---

### ‚úÖ ORCA.234: Click through is disabled for Safe Documents.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Safe Documents can assist protecting files opened in Office appplications. Before a user is allowed to trust a file opened in Office 365 ProPlus using Protected View, the file will be verified by Microsoft Defender for Office 365. It is possible to allow users click through Protected View even if Safe Documents identified the file as malicious. It is recommended to configure Safe Documents to not let users click through Pretected View.

#### Remediation action
Do not let usres click through Protected View if Safe Documents identified the file as malicious.

#### Related Links

* [Microsoft 365 Defender Portal - Safe attachments](https://security.microsoft.com/safeattachmentv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7) 
* [Safe Documents in Microsoft 365 E5](https://aka.ms/orca-atpp-docs-1)


#### Test Results

Well done! Click through is disabled for Safe Documents.



|Safe Attachments Policy|Setting|Current Value|Result|
|-|-|-|-|
|Default|AllowSafeDocsOpen|False|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.234` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA234.Tests.ps1`

---

### ‚úÖ ORCA.235: SPF records is set up for all your custom domains.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

SPF helps validate outbound email sent from your custom domain. Microsoft 365 uses the Sender Policy Framework (SPF) TXT record in DNS to ensure that destination email systems trust messages sent from your custom domain.

#### Remediation action
Set up SPF records to prevent spoofing.

#### Related Links

* [Use SPF to validate outbound email sent from your custom domain in Office 365](https://aka.ms/orca-spf-docs-1)


#### Test Results

Well done! SPF records is set up for all your custom domains.



|Domain|SPF Record Lookup|Is HardFail|Result|
|-|-|-|-|
|giraffe-it.cloud|v=spf1 include:spf.protection.outlook.com -all|Yes|‚úÖ Pass|
|Giraffe-it.eu|v=spf1 include:spf.protection.outlook.com -all|Yes|‚úÖ Pass|
|Giraffeit.onmicrosoft.com|v=spf1 include:spf.protection.outlook.com -all|Yes|‚úÖ Pass|
|giraffe-it.com|v=spf1 include:spf.protection.outlook.com -all|Yes|‚úÖ Pass|
|Giraffe-it.nl|v=spf1 include:spf.protection.outlook.com -all|Yes|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.235` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA235.Tests.ps1`

---

### ‚úÖ ORCA.236: Safe Links is enabled for emails.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When Safe Links for emails is enabled, URLs in emails will be checked when users click on links.

#### Remediation action
Enable Safe Links policy action for unknown potentially malicious URLs in emails.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Safe Links is enabled for emails.



|Safe Links policy|Setting|Current Value|Result|
|-|-|-|-|
|Built-In Protection Policy|EnableSafeLinksForEmail|True|üóÑ Skip|
|Strict Preset Security Policy|EnableSafeLinksForEmail|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableSafeLinksForEmail|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.236` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA236.Tests.ps1`

---

### ‚úÖ ORCA.237: Safe Links is enabled for teams messages.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When Safe Links for teamas messages is enabled, URLs in messages will be checked when users click on them.

#### Remediation action
Enable Safe Links policy action for unknown potentially malicious URLs in teams messages.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Safe Links is enabled for teams messages.



|Safe Links policy|Setting|Current Value|Result|
|-|-|-|-|
|Built-In Protection Policy|EnableSafeLinksForTeams|True|üóÑ Skip|
|Strict Preset Security Policy|EnableSafeLinksForTeams|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableSafeLinksForTeams|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.237` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA237.Tests.ps1`

---

### ‚úÖ ORCA.238: Safe Links is enabled for office documents.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When Safe Links for office documents is enabled, URLs in documents will be checked when users click on them.

#### Remediation action
Enable Safe Links policy action for unknown potentially malicious URLs in office documents.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! Safe Links is enabled for office documents.



|Safe Links policy|Setting|Current Value|Result|
|-|-|-|-|
|Built-In Protection Policy|EnableSafeLinksForOffice|True|üóÑ Skip|
|Strict Preset Security Policy|EnableSafeLinksForOffice|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableSafeLinksForOffice|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.238` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA238.Tests.ps1`

---

### ‚úÖ ORCA.239: No exclusions for the built-in protection policies.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Built-in protection policies provide catch-all protection against users not covered by higher order policies. Excluding users from the built-in protection policies may mean these users have reduced protections. It is important not to rely on the 'built-in' policies, as these policies only apply the minimum level of protections and should serve as a catch-all.

#### Remediation action
Remove exclusions from the built-in protection policies.

#### Related Links

* [Microsoft 365 Defender Portal - Safe links](https://security.microsoft.com/safelinksv2) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-atpp-docs-7)


#### Test Results

Well done! No exclusions for the built-in protection policies.



|Exclusion Type|Exclusion|Result|
|-|-|-|
|None|No exclusions from MDO in-built protections|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.239` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA239.Tests.ps1`

---

### ‚úÖ ORCA.240: Outlook is configured to display external tags for external emails.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

External tags show users email that is coming from external. EOP & MDO works with native client side integration to clearly highlight external emails. This allows you to train users to identify these emails so that they can be more suspicious about the email contents.

#### Remediation action
Configure external tags to highlight emails which are sent from external.

#### Related Links

* [Native external in Outlook](https://techcommunity.microsoft.com/t5/exchange-team-blog/native-external-sender-callouts-on-email-in-outlook/ba-p/2250098) 
* [Set External in Outlook (Set-ExternalInOutlook)](https://learn.microsoft.com/en-us/powershell/module/exchange/set-externalinoutlook?view=exchange-ps)


#### Test Results

Well done! Outlook is configured to display external tags for external emails.



**Tag**: `ORCA` `ORCA.240` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA240.Tests.ps1`

---

### ‚úÖ ORCA.241: Anti-phishing policy exists and EnableFirstContactSafetyTips is true.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Attackers pretend to be other people in order to trick users. By enabling first contact safety tips, users are shown a visual representation on the email that this is the first time that they have received an email from this sender. This can trigger users in to being suspicious of an email if it they believe it is coming from someone they know.

#### Remediation action
Enable first contact safety tips to highlight suspicious messages to users.

#### Related Links

* [First Contact Safety Tip](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-phishing-policies-about?view=o365-worldwide#first-contact-safety-tip) 
* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing)


#### Test Results

Well done! Anti-phishing policy exists and EnableFirstContactSafetyTips is true.



|Antiphishing Policy|Setting|Current Value|Result|
|-|-|-|-|
|Office365 AntiPhish Default|EnableFirstContactSafetyTips|False|üóÑ Skip|
|Strict Preset Security Policy|EnableFirstContactSafetyTips|True|‚úÖ Pass|
|Standard Preset Security Policy|EnableFirstContactSafetyTips|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.241` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA241.Tests.ps1`

---

### ‚úÖ ORCA.242: Important protection alerts responsible for AIR activities are enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Automated Incident Response (AIR) triggers off certain alerts that fire in the environment. AIR is responsible for detecting further anomalies and providing automated remediation actions designed to mitigate threats/attacks. It is important that these alerts are enabled so that AIR can function correctly.

#### Remediation action
Enable important protection alerts that are responsible for AIR activities.

#### Related Links

* [Automated investigation and response in Microsoft 365 Defender](https://learn.microsoft.com/en-us/microsoft-365/security/defender/m365d-autoir)


#### Test Results

Well done! Important protection alerts responsible for AIR activities are enabled.



|Protection Alert|Setting|Current Value|Result|
|-|-|-|-|
|Teams message reported by user as security risk|Disabled|False|‚úÖ Pass|
|Email messages containing phish URLs removed after delivery|Disabled|False|‚úÖ Pass|
|Suspicious Email Forwarding Activity|Disabled|False|‚úÖ Pass|
|Email messages containing malicious file removed after delivery|Disabled|False|‚úÖ Pass|
|Email reported by user as malware or phish|Disabled|False|‚úÖ Pass|
|Email messages containing malicious URL removed after delivery|Disabled|False|‚úÖ Pass|
|Email messages from a campaign removed after delivery|Disabled|False|‚úÖ Pass|
|Email messages removed after delivery|Disabled|False|‚úÖ Pass|
|Suspicious email sending patterns detected|Disabled|False|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.242` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA242.Tests.ps1`

---

### ‚úÖ ORCA.243: Authenticated Receive Chain is set up for domains not pointing to EOP/MDO, or all domains point to EOP/MDO.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

When EOP/MDO is behind a third-party service, sender authentication checks such as DKIM & SPF can fail. This is due to the fact that the service infront may modify the message and break the signature, or send from an IP address that is not a registered sender for the domain. By configuring the third-party to ARC seal the message, and setting up a trusted ARC sealer, the authentication results of the third-party mail relay can be used. IMPORTANT NOTE: This check cannot validate that the third-party service infront of these domains is correctly ARC sealing your emails, nor can it check that the domain portion matches one of the trusted ARC sealers. This check purely validates a trusted ARC sealer exists. Even if this check passes, you should validate your emails are passing ARC seal

#### Remediation action
Enable Authenticated Receive Chain (ARC) trusted sealers for domains not pointed at EOP/MDO.

#### Related Links

* [Configuring trusted ARC sealers](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-arc-configure?view=o365-worldwide) 
* [Improving 'Defense in Depth' with Trusted ARC Sealers for Microsoft Defender for Office 365](https://techcommunity.microsoft.com/t5/microsoft-defender-for-office/improving-defense-in-depth-with-trusted-arc-sealers-for/ba-p/3440707)


#### Test Results

Well done! Authenticated Receive Chain is set up for domains not pointing to EOP/MDO, or all domains point to EOP/MDO.



**Tag**: `ORCA` `ORCA.243` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA243.Tests.ps1`

---

### ‚úÖ ORCA.244: Policies are configured to honor sending domains DMARC.

<img align="right" src="https://maester.dev/img/test-result/pill-pass.png" height="25" alt="Passed"/>

#### Overview

Domain-based Message Authentication, Reporting & Conformance (DMARC) is a standard that helps prevent spoofing by verifying the senders identity. If an email fails DMARC validation, it often means that the sender is not who they claim to be, and the email could be fraudulent. The owner of the sending domain controls the DMARC policy for their domain, and provides recommendations to receivers on what action should be performed when DMARC fails. When the Honor DMARC Policy setting is set to False, the organisations policy is not considered. It is recommended to honor this policy. 

#### Remediation action
Configure anti-phish policy to honor sending domains DMARC configuration.

#### Related Links

* [Announcing New DMARC Policy Handling Defaults for Enhanced Email Security](https://techcommunity.microsoft.com/t5/exchange-team-blog/announcing-new-dmarc-policy-handling-defaults-for-enhanced-email/ba-p/3878883) 
* [Microsoft 365 Defender Portal - Anti-phishing](https://security.microsoft.com/antiphishing)


#### Test Results

Well done! Policies are configured to honor sending domains DMARC.



|Antiphishing Policy|Honor DMARC Policy|Result|
|-|-|-|
|Office365 AntiPhish Default|True|üóÑ Skip|
|Strict Preset Security Policy|True|‚úÖ Pass|
|Standard Preset Security Policy|True|‚úÖ Pass|


**Tag**: `ORCA` `ORCA.244` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA244.Tests.ps1`

---

### üö´ CIS.M365.1.1.3: Ensure that between two and four global admins are designated

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

1.1.3 (L1) Ensure that between two and four global admins are designated

More than one global administrator should be designated so a single admin can be monitored and to provide redundancy should a single admin leave an organization. Additionally, there should be no more than four global admins set for any tenant. Ideally global administrators will have no licenses assigned to them.

#### Remediation action:

To correct the number of global tenant administrators:
1. Navigate to Microsoft 365 admin center [https://admin.microsoft.com](https://admin.microsoft.com).
2. Select **Users** > **Active Users**.
3. In the Search field enter the name of the user to be made a Global Administrator.
4. To create a new Global Admin:
 1. Select the user's name.
 2. A window will appear to the right.
 3. Select **Manage roles**.
 4. Select **Admin center access**.
 5. Check **Global Administrator**.
 6. Click Save changes.

To remove Global Admins:
1. Select **User**.
2. Under Roles select **Manage roles**.
3. De-Select the appropriate role.
4. Click **Save changes**.

#### Related links

* [Microsoft 365 Admin Center](https://admin.microsoft.com)
* [CIS Microsoft 365 Foundations Benchmark v5.0.0 - Page 28](https://www.cisecurity.org/benchmark/microsoft_365)



#### Test Results


Skipped. Missing Scope RoleEligibilitySchedule.ReadWrite.Directory

**Tag**: `CIS.M365.1.1.3` `L1` `CIS E3 Level 1` `CIS E3` `CIS` `Security` `CIS M365 v5.0.0`

**Category**: `CIS`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cis\Test-MtCisGlobalAdminCount.Tests.ps1`

---

### üö´ CISA.MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Group owners SHALL NOT be allowed to consent to applications.

Rationale: In M365, group owners and team owners can consent to applications accessing data in the tenant. By requiring consent requests to go through an approval workflow, risk of exposure to malicious applications is reduced.

#### Remediation action:

1. In **Entra** under **Identity** and **Applications**, select **Enterprise applications**.
2. Under **Security**, select **Consent and permissions**.
3. Under **Manage**, select **[User consent settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings)**.
4. Under **Group owner consent for apps accessing data**, select **Do not allow group owner consent**.
5. Click **Save**.

#### Related links

* [Entra admin center - Consent and permissions | User consent settings](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings)
* [CISA Application Registration & Consent - MS.AAD.5.4v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad54v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L665)



#### Test Results


Skipped. Settings value is not available. This may be due to the change that this API is no longer available for recently created tenants.


**Tag**: `MS.AAD` `MS.AAD.5.4` `CISA.MS.AAD.5.4` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaAppGroupOwnerConsent.Tests.ps1`

---

### üö´ CISA.MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role.

**Rationale:** The Global Administrator role provides unfettered access to the tenant (Azure and Microsoft 365). Limiting the number of users with this level of access makes tenant compromise more challenging. Microsoft recommends fewer than five users in the Global Administrator role. However, additional user accounts, up to eight, may be necessary to support emergency access and some operational scenarios.

#### Remediation action:

When counting the number of users assigned to the Global Administrator role, **count each user only once**.

1. In **Entra** under **Roles & adminis** and **[All roles](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RolesManagementMenuBlade/~/AllRoles)**, search for **Global Administrator** and click on it to go to the role and see who is assiged. Count users that are assigned directly to the role and users assigned via group membership.

    If you have **Entra ID PIM**, count both the **Eligible assignments** and **Active assignments**.

    If any of the groups assigned to Global Administrator are enrolled in **PIM for Groups**, also count the number of group members from the PIM for Groups portal **Eligible** assignments.

2. Validate that there are a total of two to eight users assigned to the Global Administrator role.

#### Related links

* [Entra admin center - Roles and administrators | All roles](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RolesManagementMenuBlade/~/AllRoles)
* [CISA 7.1 Highly Privileged User Access - MS.AAD.7.1v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad71v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L761)



#### Test Results


Skipped. Missing Scope RoleEligibilitySchedule.ReadWrite.Directory


**Tag**: `MS.AAD` `MS.AAD.7.1` `CISA.MS.AAD.7.1` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaGlobalAdminCount.Tests.ps1`

---

### üö´ CISA.MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator.

Rationale: Many privileged administrative users do not need unfettered access to the tenant to perform their duties. By assigning them to roles based on least privilege, the risks associated with having their accounts compromised are reduced.

#### Remediation action:

This policy is based on the ratio below:

`X = (Number of users assigned to the Global Administrator role) / (Number of users assigned to other highly privileged roles)`

1. Follow the instructions for policy MS.AAD.7.1v1 above to get a count of users assigned to the Global Administrator role.
2. Follow the instructions for policy MS.AAD.7.1v1 above but get a count of users assigned to the other highly privileged roles (not Global Administrator). If a user is assigned to both Global Administrator and other roles, only count that user for the Global Administrator assignment.
3. Divide the value from step 2 from the value from step 1 to calculate X. If X is less than or equal to 1 then the tenant is compliant with the policy.

#### Related links

* [CISA 7.2 Highly Privileged User Access - MS.AAD.7.2v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad72v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L792)



#### Test Results


Skipped. Missing Scope RoleEligibilitySchedule.ReadWrite.Directory


**Tag**: `MS.AAD` `MS.AAD.7.2` `CISA.MS.AAD.7.2` `CISA` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaGlobalAdminRatio.Tests.ps1`

---

### üö´ CISA.MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers.

Rationale: Many privileged administrative users do not need unfettered access to the tenant to perform their duties. By assigning them to roles based on least privilege, the risks associated with having their accounts compromised are reduced.

#### Remediation action:

1. Perform the steps below for each [highly privileged role](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RolesManagementMenuBlade/~/AllRoles).
2. Review the users listed that have an **OnPremisesImmutableId** and have **OnPremisesSyncEnabled** set.
3. Create a cloud only user account for that individual and remove their hybrid identity from privileged roles.

#### Related links

* [Entra admin center - Roles and administrators | All roles](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/RolesManagementMenuBlade/~/AllRoles)
* [CISA 7.3 Highly Privileged User Access - MS.AAD.7.3v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/aad.md#msaad73v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/AADConfig.rego#L833)



#### Test Results


Skipped. Missing Scope RoleEligibilitySchedule.ReadWrite.Directory


**Tag**: `MS.AAD` `MS.AAD.7.3` `CISA` `CISA.MS.AAD.7.3` `Security` `Entra ID Free`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\entra\Test-MtCisaCloudGlobalAdmin.Tests.ps1`

---

### üö´ CISA.MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft.

Rationale: Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Filtering out spam reduces user workload burden, prevents junk mail congestion, and reduces potentially malicious content exposure.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select [**Preset Security Policies**](https://security.microsoft.com/presetSecurityPolicies).
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 14 Inbound Anti-Spam Protections - MS.EXO.14.4](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo144v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L794)



#### Test Results


Skipped. Unable to validate 3rd party solutions.

**Tag**: `MS.EXO` `MS.EXO.14.4` `CISA.MS.EXO.14.4` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaSpamAlternative.Tests.ps1`

---

### üö´ CISA.MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system.

Rationale: Suspicious or malicious events, if not resolved promptly, may have a greater impact to users and the agency. Sending alerts to a monitored email address or SIEM system helps ensure these suspicious or malicious events are acted upon in a timely manner to limit overall impact.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. Select [**Settings**](https://security.microsoft.com/securitysettings).
3. Select either:
    - [**Microsoft Sentinel**](https://security.microsoft.com/sentinel/settings).
    - **Defender XDR**, and under **General**, select [**Streaming API**](https://security.microsoft.com/securitysettings/defender/raw_data_export).
4. Ensure a SIEM integration is configured for your organization.

#### Related links

* [Defender admin center - Alert policy](https://security.microsoft.com/alertpoliciesv2)
* [Defender admin center - Streaming API](https://security.microsoft.com/securitysettings/defender/raw_data_export)
* [Defender admin center - Sentinel workspaces](https://security.microsoft.com/sentinel/settings)
* [CISA 16 Alerts - MS.EXO.16.2](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo162v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L878)



#### Test Results


Skipped. Not available for API validation.

**Tag**: `MS.EXO` `MS.EXO.16.2` `CISA.MS.EXO.16.2` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaExoAlertSiem.Tests.ps1`

---

### üö´ CISA.MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

**This is no longer applicable, and is deprecated by CISA. The content below is retained as a historical archive and will be removed in a future version.**

Microsoft Purview Audit (Premium) logging SHALL be enabled.

Rationale: Standard logging may not include relevant details necessary for visibility into user actions during an incident. Enabling Microsoft Purview Audit (Premium) captures additional event types not included with Standard. Furthermore, it is required for government agencies by OMB M-21-13 (referred to therein by its former name, Unified Audit Logs w/Advanced Features).

#### Remediation action:

To set up Microsoft Purview Audit (Premium), see [Set up Microsoft Purview Audit (Premium) | Microsoft Learn](https://learn.microsoft.com/en-us/purview/audit-premium-setup?view=o365-worldwide).

#### Related links

* [Purview portal - Audit search](https://purview.microsoft.com/audit/auditsearch)
* [CISA 17 Audit Logging - MS.EXO.17.2](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo172v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L913)



#### Test Results


Skipped. This test has been deprecated by CISA on March 2025. MS.EXO.17.2v1 was originally included in order to enable auditing of additional user actions not captured under Purview Audit (Standard). In October 2023, Microsoft announced changes to its Purview Audit service that included making audit events in Purview Audit (Premium) available to Purview Audit (Standard) subscribers. Now that the rollout of changes has been completed, Purview (Standard) includes the necessary auditing which is addressed by MS.EXO.17.2v1 See [CISA Gov - GitHub](https://github.com/cisagov/ScubaGear/blob/7cefa12639b4bc36990f8f2849b57ad2fdafec4c/PowerShell/ScubaGear/baselines/removedpolicies.md?plain=1#L56)

**Tag**: `MS.EXO` `MS.EXO.17.2` `CISA.MS.EXO.17.2` `CISA` `Security` `Deprecated`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaAuditLogPremium.Tests.ps1`

---

### üö´ CISA.MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C).

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C).

Rationale: Audit logs may no longer be available when needed if they are not retained for a sufficient time. Increased log retention time gives an agency the necessary visibility to investigate incidents that occurred some time ago. OMB M-21-13, Appendix C, Table 5 specifically calls out Unified Audit Logs in the Cloud Azure log category.

#### Remediation action:

To create one or more custom audit retention policies, if the default retention policy is not sufficient for agency needs, follow [Create an audit log retention policy](https://learn.microsoft.com/en-us/purview/audit-log-retention-policies?view=o365-worldwide&tabs=microsoft-purview-portal#create-an-audit-log-retention-policy) instructions. Ensure the duration selected in the retention policies is at least one year, in accordance with OMB M-21-31.

#### Related links

* [Purview portal - Audit policies](https://purview.microsoft.com/audit/auditpolicies)
* [CISA 17 Audit Logging - MS.EXO.17.3](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo173v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L928)



#### Test Results


Skipped. This test is for tenants that are licensed for Advanced Audit. See [Learn about auditing solutions in Microsoft Purview](https://learn.microsoft.com/en-us/purview/audit-solutions-overview#licensing-requirements)

**Tag**: `MS.EXO` `MS.EXO.17.3` `CISA.MS.EXO.17.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaAuditLogRetention.Tests.ps1`

---

### üö´ CISA.MS.EXO.4.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

The DMARC point of contact for aggregate reports SHALL include `reports@dmarc.cyber.dhs.gov`.

Rationale: Email spoofing attempts are not inherently visible to domain owners. DMARC provides a mechanism to receive reports of spoofing attempts. Including reports@dmarc.cyber.dhs.gov as a point of contact for these reports gives CISA insight into spoofing attempts and is required by BOD 18-01 for FCEB departments and agencies.

**Note: Only federal, executive branch, departments and agencies should include this email address in their DMARC record.**

> For other organization's there are many services that offer managed DMARC analysis and reporting, though ensure you properly align your implementation with your organization's policies for data handling.

#### Remediation action:

* See MS.EXO.4.1v1 Instructions for an overview of how to publish and check a DMARC record.
* Ensure the record published includes reports@dmarc.cyber.dhs.gov as one of the emails for the RUA field.

#### Related links

* [Exchange admin center - Accepted domains](https://admin.exchange.microsoft.com/#/accepteddomains)
* [CISA 4 Domain-Based Message Authentication, Reporting, and Conformance (DMARC) - MS.EXO.4.3v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo43v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L207)



#### Test Results


Skipped. This test is only for federal, executive branch, departments and agencies. To override use [Test-MtCisaDmarcAggregateCisa -Force](https://maester.dev/docs/commands/Test-MtCisaDmarcAggregateCisa)

**Tag**: `MS.EXO` `MS.EXO.4.3` `CISA.MS.EXO.4.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaDmarcAggregateCisa.Tests.ps1`

---

### üö´ CISA.MS.EXO.8.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft.

Rationale: Any alternative DLP solution should be able to detect sensitive information in Exchange Online and block access to unauthorized entities.

> This test will always skip by default.

#### Related links

* [Purview admin center - Data loss prevention policies](https://purview.microsoft.com/datalossprevention/policies)
* [CISA 8 Data Loss Prevention Solutions - MS.EXO.8.3](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo83v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L453)



#### Test Results


Skipped. Unable to validate 3rd party solutions.

**Tag**: `MS.EXO` `MS.EXO.8.3` `CISA.MS.EXO.8.3` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaDlpAlternate.Tests.ps1`

---

### üö´ CISA.MS.EXO.9.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter.

Rationale: Malicious attachments often take the form of click-to-run files. Sharing high risk file types, when necessary, is better left to a means other than email; the dangers of allowing them to be sent over email outweigh any potential benefits. Filtering email attachments based on file types can prevent spread of malware distributed via click-to-run email attachments.

> Note: This test will always result in a skip result.

#### Remediation action:

1. Sign in to **Microsoft 365 Defender**.
2. In the left-hand menu, go to **Email & Collaboration** > **Policies & Rules**.
3. Select **Threat Policies**.
4. From the **Templated policies** section, select **Preset Security Policies**.
5. Under **Standard protection**, slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on**.
6. Under **Strict protection**, slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.

Note: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).

#### Related links

* [Defender admin center - Preset security policies](https://security.microsoft.com/presetSecurityPolicies)
* [CISA 9 Attachment File Type - MS.EXO.9.4v1](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/baselines/exo.md#msexo94v1)
* [CISA ScubaGear Rego Reference](https://github.com/cisagov/ScubaGear/blob/main/PowerShell/ScubaGear/Rego/EXOConfig.rego#L532)



#### Test Results


Skipped. Tenant is licensed for Exchange Online Protection; an alternative mail filter is not needed.

**Tag**: `MS.EXO` `MS.EXO.9.4` `CISA.MS.EXO.9.4` `CISA` `Security`

**Category**: `CISA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\cisa\exchange\Test-MtCisaEmailFilterAlternative.Tests.ps1`

---

### üö´ EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

You can work with your Security key provider to determine the AAGuids of their devices for allowing or blocking usage.



#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')
.keyRestrictions.aaGuids -notcontains $null -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/fido2authenticationmethodconfiguration)




#### Test Results


Skipped. Authentication method of FIDO2 security keys is not enabled and key restriction not enforced.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AF05](https://maester.dev/docs/tests/EIDSCA.AF05)

**Tag**: `EIDSCA` `Security` `EIDSCA.AF05`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### üö´ EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Defines if list of AADGUID will be used to allow or block registration.

You should use Block or Allow as value to allow- or blocklisting of AAGuids.

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')
.keyRestrictions.aaGuids -notcontains $null -and ($result.keyRestrictions.enforcementType -eq 'allow' -or $result.keyRestrictions.enforcementType -eq 'block') -eq 'true'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/fido2authenticationmethodconfiguration)




#### Test Results


Skipped. Authentication method of FIDO2 security keys is not enabled and key restriction not enforced.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AF06](https://maester.dev/docs/tests/EIDSCA.AF06)

**Tag**: `EIDSCA` `Security` `EIDSCA.AF06`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### üö´ EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Defines if user consent to apps is allowed, and if it is, which app consent policy (permissionGrantPolicy) governs the permissions.

Microsoft recommends to allow to user consent for apps from verified publisher for selected permissions. CISA SCuBA 2.7 defines that all Non-Admin Users SHALL Be Prevented From Providing Consent To Third-Party Applications.

#### Test script
```
https://graph.microsoft.com/beta/policies/authorizationPolicy
.permissionGrantPolicyIdsAssignedToDefaultUserRole -clike 'ManagePermissionGrantsForSelf*' -eq 'ManagePermissionGrantsForSelf.microsoft-user-default-low'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authorizationPolicy&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/UserSettings)



#### Test Results


Skipped. User Consent has been disabled or customized using Microsoft Graph or Microsoft Graph PowerShell without any assignment to custom policy.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AP08](https://maester.dev/docs/tests/EIDSCA.AP08)

**Tag**: `EIDSCA` `Security` `EIDSCA.AP08`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### üö´ EIDSCA.AS04: Authentication Method - SMS - Use for sign-in.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Determines if users can use this authentication method to sign in to Microsoft Entra ID. true if users can use this method for primary authentication, otherwise false.

Avoid to use SMS as primary sign in factor (instead of a password) and consider to implement a MFA or passwordless option also for your special user groups, such as front-line workers.

#### Test script
```
https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Sms')
.includeTargets.isUsableForSignIn -eq 'false'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Sms')&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [phoneAuthenticationMethod resource type - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/phoneauthenticationmethod)




#### Test Results


Skipped. Authentication method of Sms is not enabled.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.AS04](https://maester.dev/docs/tests/EIDSCA.AS04)

**Tag**: `EIDSCA` `Security` `EIDSCA.AS04`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### üö´ EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Group and team owners can authorize applications, such as applications published by third-party vendors, to access your organization's data associated with a group. For example, a team owner in Microsoft Teams can allow an app to read all Teams messages in the team, or list the basic profile of a group's members.

CISA SCuBA 2.7: Non-Admin Users SHALL Be Prevented From Providing Consent To Third-Party Applications.

#### Test script
```
https://graph.microsoft.com/beta/settings
.values | where-object name -eq 'EnableGroupSpecificConsent' | select-object -expand value -eq 'False'
```

#### Related links

- [Open in Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer?request=settings&method=GET&version=beta&GraphUrl=https://graph.microsoft.com)
- [directorySetting resource type - Microsoft Graph beta | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/resources/directorysetting)
- [View in Microsoft Entra admin center](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/ConsentPoliciesMenuBlade/~/UserSettings)



#### Test Results


Skipped. Group owner consent settings have been removed and replaced with Team owner consent settings.


**Learn more**: [https://maester.dev/docs/tests/EIDSCA.CP01](https://maester.dev/docs/tests/EIDSCA.CP01)

**Tag**: `EIDSCA` `Security` `EIDSCA.CP01`

**Category**: `EIDSCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\EIDSCA\Test-EIDSCA.Generated.Tests.ps1`

---

### üö´ MT.1021: Security Defaults are enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview



#### Test Results

Skipped. This test is for tenants that are not licensed for any Entra ID Premium license. See [Entra ID licensing](https://learn.microsoft.com/entra/fundamentals/licensing)

**Learn more**: [https://maester.dev/docs/tests/MT.1021](https://maester.dev/docs/tests/MT.1021)

**Tag**: `CA` `Security` `MT.1021`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessBaseline.Tests.ps1`

---

### ‚ùî MT.1033.0: User should be blocked from using legacy authentication (Sander.breijer@giraffe-it.com)

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

            Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true
        
```

**Tag**: `MT.1033`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessWhatIf.Tests.ps1`

---

### ‚ùî MT.1033.1: User should be blocked from using legacy authentication (Adriaan.de.koning@giraffe-it.com)

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

            Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true
        
```

**Tag**: `MT.1033`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessWhatIf.Tests.ps1`

---

### ‚ùî MT.1033.2: User should be blocked from using legacy authentication (Michel.Melk@giraffe-it.com)

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

            Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true
        
```

**Tag**: `MT.1033`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessWhatIf.Tests.ps1`

---

### ‚ùî MT.1033.3: User should be blocked from using legacy authentication (Website@giraffe-it.com)

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

            Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true
        
```

**Tag**: `MT.1033`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessWhatIf.Tests.ps1`

---

### ‚ùî MT.1033.4: User should be blocked from using legacy authentication (Info@giraffe-it.com)

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

            Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true
        
```

**Tag**: `MT.1033`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-ConditionalAccessWhatIf.Tests.ps1`

---

### ‚ùî MT.1050: Apps with high-risk permissions having a direct path to Global Admin

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        $result = Test-MtHighRiskAppPermissions -AttackPath 'Direct'
        if ($null -ne $result) {
            $result | Should -Be $true -Because 'no graph application has permissions with a risk of having a direct path to Global Admin and full tenant takeover.'
        }
    
```

**Tag**: `App` `Entra` `Full` `Graph` `LongRunning` `Preview` `MT.1050`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtHighRiskAppPermissions.Tests.ps1`

---

### ‚ùî MT.1051: Apps with high-risk permissions having an indirect path to Global Admin

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        $result = Test-MtHighRiskAppPermissions -AttackPath 'Indirect'
        if ($null -ne $result) {
            $result | Should -Be $true -Because 'no graph application has permissions with a risk of having an indirect path to Global Admin and full tenant takeover.'
        }
    
```

**Tag**: `App` `Entra` `Full` `Graph` `LongRunning` `Preview` `MT.1051`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtHighRiskAppPermissions.Tests.ps1`

---

### ‚ùî MT.1057: App registrations should no longer use secrets.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtAppRegistrationsWithSecrets | Should -Be $true -Because 'app registrations should not use secrets and instead use workload identities or certificate-based authentication'
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1057](https://maester.dev/docs/tests/MT.1057)

**Tag**: `App` `Entra` `Full` `Graph` `LongRunning` `Maester` `Security` `MT.1057`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-AppRegistrations.Tests.ps1`

---

### ‚ùî MT.1058: Exchange application access policies must be configured.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtSpExchangeAppAccessPolicy | Should -Be $true -Because 'all applications with Exchange permissions should have access policies configured'
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1058](https://maester.dev/docs/tests/MT.1058)

**Tag**: `App` `Entra` `Full` `Graph` `LongRunning` `Maester` `Security` `MT.1058`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-AppRegistrations.Tests.ps1`

---

### ‚ùî MT.1063: All App registration owners should have MFA registered

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        $result = Test-MtAppRegistrationOwnersWithoutMFA
        $result | Should -Be $true -Because 'All App registration owners should have MFA registered.'
    
```

**Tag**: `App` `Entra` `Full` `LongRunning` `Security` `MT.1063`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtAppRegistrationOwnersWithoutMFA.Tests.ps1`

---

### üö´ MT.1064: Ensure that write permissions are required to create new management groups

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

By default, all Entra ID security principals can create new management groups. This introduces governance and security risks, as it allows any user to create a new management group and link subscriptions to it without oversight.

To prevent this, Azure provides a setting that enforces write permission requirements for the creation of new management groups. This ensures that only authorized users can manage the structure of your management group hierarchy.

#### Remediation action:

To enable the requirement for write permissions:
1. Navigate to the Microsoft Azure Portal: [https://portal.azure.com](https://portal.azure.com).
2. In the search bar, type **Management groups** and open the blade.
3. Select **Settings** in the left navigation menu.
4. Under **Permissions for creating new management groups**, enable the switch:
   **Require write permissions for creating new management groups**.

#### Related links

* [Organize your resources with management groups](https://learn.microsoft.com/en-us/azure/governance/management-groups/overview)



#### Test Results


Skipped. Tenant Root Group not found


**Tag**: `Governance` `Azure` `MT.1064`

**Category**: `AzureConfig`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Azure\Test-MtManagementGroupWriteRequirement.Tests.ps1`

---

### üö´ MT.1073: Soft- and hard-matching of synchronized objects should be blocked.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Ensure soft and hard matching for on-premises synchronization objects is blocked

When you start synchronizing with Microsoft Entra Connect, the Microsoft Entra service API checks every new incoming object and tries to find an existing object to match. There are three attributes used for this process: userPrincipalName, proxyAddresses, and sourceAnchor/immutableID. A match on userPrincipalName or proxyAddresses is known as a "soft-match." A match on sourceAnchor is known as "hard-match." For the proxyAddresses attribute, only the value with SMTP:, that is the primary email address, is used for the evaluation.
Both, the hard-match and soft-match, tries to match objects already present and managed in Microsoft Entra ID with the new incoming objects being added that represent the same on-premises entity. If Microsoft Entra ID isn't able to find a hard-match or soft-match for the incoming object, it provisions a new object in Microsoft Entra ID directory.

The match is only evaluated for new objects coming from on-premises AD. If you change an existing object so it matches any of these attributes, then you see an error instead.

If Microsoft Entra ID finds an object where the attribute values are the same as the new incoming object from Microsoft Entra Connect, then it takes over the object in Microsoft Entra ID and the previously cloud-managed object is converted to on-premises managed. All attributes in Microsoft Entra ID with a value in on-premises AD are overwritten with the respective on-premises value.

Matching existing Entra objects with newly synchronized on-premises active directory objects can lead to unintended consequences, such as mismatching user data or allowing users to access data, of for example colleagues with the same name, they should not have access to.

#### Remediation action:

To block soft- and hard-match from on-premises directory synchronization using Graph PowerShell:
1. Connect to Graph using **Connect-MgGraph -Scopes "OnPremDirectorySynchronization.ReadWrite.All"**.
2. Run following PowerShell Command:
```
$onPremisesSynchronization = Invoke-MgGraphRequest -Uri "https://graph.microsoft.com/v1.0/directory/onPremisesSynchronization" -OutputType PSObject | Select-Object -ExpandProperty value
$params = @{
	features = @{
		BlockCloudObjectTakeoverThroughHardMatchEnabled = $true
        BlockSoftMatchEnabled = $true
	}
}
Invoke-MgGraphRequest -Method PATCH -Uri "https://graph.microsoft.com/v1.0/directory/onPremisesSynchronization/$($onPremisesSynchronization.id)" -Body $params
```

#### Related links

* [Microsoft Entra Connect: When you have an existing tenant | Microsoft Learn](https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/how-to-connect-install-existing-tenant)
* [Update-MgDirectoryOnPremiseSynchronization | Microsoft Learn - Graph PowerShell v1.0](https://learn.microsoft.com/de-de/powershell/module/microsoft.graph.identity.directorymanagement/update-mgdirectoryonpremisesynchronization?view=graph-powershell-1.0)



#### Test Results


Skipped. OnPremisesSynchronization is not configured

**Learn more**: [https://maester.dev/docs/tests/MT.1073](https://maester.dev/docs/tests/MT.1073)

**Tag**: `DirSync` `Entra` `Graph` `Maester` `Security` `MT.1073`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtOnPremisesSynchronization.Tests.ps1`

---

###  MT.1074: Ensure no more then 100 outbound mails per day are send using the .onmicrosoft.com domain



#### Overview

Ensure none or less than 100 outbound mails per day are being sent using the .onmicrosoft.com domain.

Limitations of free 'onmicrosoft' shared domains:\
The "default" onmicrosoft domains are useful for testing mail flow but are not suitable for regular messaging. They do not reflect a customer's brand identity and offer limited administrative control. Moreover, because these domains all share the 'onmicrosoft' domain (for example, 'contoso.onmicrosoft.com'), their reputation is collectively impacted. Despite Microsoft's efforts to minimize abuse, spammers often exploit newly created tenants to send bursts of spam from '.onmicrosoft.com' addresses before they can intervene. This degrades this shared domain's reputation, affecting all legitimate users. To ensure brand trust and email deliverability, organizations should establish and use their own custom domains for sending email. Until now, Microsoft did not have any limits on use of MOERA domains for email delivery.

Introducing new throttling enforcement:\
To **prevent misuse and help improve deliverability** of customer email by encouraging best practices, Microsoft is changing its policy. In the future, MOERA domains should only be used for testing purposes, not regular email sending. Microsoft will be **introducing throttling to limit messages** sent from 'onmicrosoft.com' domains to **100 external recipients per organization per 24 hour** rolling window. Inbound messages won't be affected. External recipients are counted after the expansion of any of the original recipients. When a sender hits the throttling limit, they will receive NDRs with the code **550 5.7.236** for any attempts to send to external recipients while the tenant is throttled.

Rollout timeline:\
| MOERA outgoing email throttling starts | Exchange seats in the tenant |
| --- | --- |
| October 15, 2025 | Trial |
| December 1, 2025 | < 3 |
| January 7, 2026 | 3 - 10 |
| February 2, 2026 | 11 - 50 |
| March 2, 2026 | 51 - 200 |
| April 1, 2026 | 201 - 2.000 |
| May 4, 2026 | 2.001 - 10.000 |
| June 1, 2026 | 10.001 > |

Post origin from Exchange Team Blog, check your Message Center for further information on this change. [Exchange Team Blog](https://techcommunity.microsoft.com/blog/exchange/limiting-onmicrosoft-domain-usage-for-sending-emails/4446167?WT.mc_id=M365-MVP-5003086)

#### Remediation action:

Change primary usage of the .onmicrosoft.com domain for mailboxes.
1. Navigate to Exchange admin center [Exchange Admin Center](https://admin.exchange.microsoft.com/#/)
2. Click to expand **Recipients** and select **Mailboxes**.
3. Filter for mailboxes with the .onmicrosoft.com domain as a primary SMTP address.
4. Select a mailbox to open its properties and click **Manage email address types**.
5. Select **Add email address type** and add a new mail adress with your custom domain.
6. Check **Set as primary email address**.
7. Confirm with **Ok**.
8. Repeat for every mailbox.

#### Related links

* [Exchange Admin Center](https://admin.exchange.microsoft.com/#/)
* [Limiting Onmicrosoft Domain Usage for Sending Emails | Exchange Team Blog](https://techcommunity.microsoft.com/blog/exchange/limiting-onmicrosoft-domain-usage-for-sending-emails/4446167?WT.mc_id=M365-MVP-5003086)



#### Test Results


Error. An error occurred while running the test. ‚ö†Ô∏è

```

Exception: C:\Users\JesseMulderGiraffeIT\OneDrive - Giraffe-it B.V\Documenten\PowerShell\Modules\Maester\2.0.0\public\Invoke-MtGraphSecurityQuery.ps1:56
Line |
  56 |                          throw $KqlQueryExecutionError
     |                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | 'where' operator: Failed to resolve table or column expression named 'EmailEvents'. Fix semantic errors in your
     | query.



```



**Tag**: `Maester` `Exchange` `MT.1074`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### ‚ùî MT.1075: Require explicit assignment of Third Party Entra Apps.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtServicePrincipalsForAllUsers | Should -Be $true -Because 'Third Party Service Principals should require explicit assignment to users'
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1075](https://maester.dev/docs/tests/MT.1075)

**Tag**: `App` `Entra` `Full` `Graph` `LongRunning` `Maester` `Security` `MT.1075`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-AppRegistrations.Tests.ps1`

---

### üö´ MT.1076: MOERA SHOULD NOT be used for sent mail

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Microsoft Online Exchange Routing Addresses (MOERA) SHOULD NOT be used for sent mail.

#### Remediation action:

For each listed user principal name, update primary SMTP address to use a [registered domain](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/DomainsManagementMenuBlade/~/CustomDomainNames).

> If the listed user principal name sends mail from a script or application, you may need to update that configuration as well.

##### Entra Managed Mail Attributes

1. Within the Entra Portal, navigate to [All users](https://entra.microsoft.com/#view/Microsoft_AAD_UsersAndTenants/UserManagementMenuBlade/~/AllUsers/menuId/)

2. Select the user

3. Select Edit properties

4. Select Contact information

5. Update the Email attribute

6. Select Save

##### AD Managed Mail Attributes

Processes can vary depending on use of PowerShell, AD MMCs, or Exchange Management Portal. Update according to your internal processes.

#### Related links

* [Limiting Onmicrosoft Domain Usage for Sending Emails](https://techcommunity.microsoft.com/blog/exchange/limiting-onmicrosoft-domain-usage-for-sending-emails/4446167)



#### Test Results


Skipped. This test relies on privileged (i.e., ReadWrite) permissions.

**Tag**: `Maester` `Exchange` `MT.1076` `MOERA`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### ‚ùî MT.1077: App registrations with privileged API permissions should not have owners.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmAppRegWithPrivilegedApiAndOwners | Should -Be $true -Because "an app registration with privileged API permissions should not have assigned owner, as permanent and/or lower privileged users have full control over privileged application and may lead to privilege escalation."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1077](https://maester.dev/docs/tests/MT.1077)

**Tag**: `Privileged` `Entra` `Graph` `LongRunning` `Security` `EntraOps` `XSPM` `MT.1077`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmPrivilegedIdentities.Tests.ps1`

---

### ‚ùî MT.1078: App registrations with highly privileged directory roles should not have owners.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmAppRegWithPrivilegedRolesAndOwners | Should -Be $true -Because "an app registration with highly privileged directory roles should not have assigned owner, as permanent and/or lower privileged users have full control over privileged application and may lead to privilege escalation."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1078](https://maester.dev/docs/tests/MT.1078)

**Tag**: `Privileged` `Entra` `Graph` `LongRunning` `Security` `EntraOps` `XSPM` `MT.1078`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmPrivilegedIdentities.Tests.ps1`

---

### ‚ùî MT.1079: Privileged API permissions on service principals should not remain unused.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmAppRegWithPrivilegedUnusedPermissions | Should -Be $true -Because "an app registration with highly privileged API permissions should not have unused permissions, to minimize the attack surface and follow least privilege principles."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1079](https://maester.dev/docs/tests/MT.1079)

**Tag**: `Privileged` `Entra` `Graph` `LongRunning` `Security` `EntraOps` `XSPM` `MT.1079`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmPrivilegedIdentities.Tests.ps1`

---

### ‚ùî MT.1080: Credentials, tokens, or cookies from highly privileged users should not be exposed on vulnerable endpoints.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmExposedCredentialsForPrivilegedUsers | Should -Be $true -Because "Azure CLI secrets, tokens, or user cookies from highly privileged users should not be exposed on vulnerable endpoints."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1080](https://maester.dev/docs/tests/MT.1080)

**Tag**: `Privileged` `Entra` `Graph` `LongRunning` `Security` `EntraOps` `XSPM` `MT.1080`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmPrivilegedIdentities.Tests.ps1`

---

### ‚ùî MT.1081: Hybrid users should not be assigned Entra ID role assignments.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmHybridUsersWithAssignedEntraIdRoles | Should -Be $true -Because "Hybrid users should not be assigned to eligible or permanent Entra ID role assignments to avoid lateral movement by compromised Active Directory."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1081](https://maester.dev/docs/tests/MT.1081)

**Tag**: `Privileged` `Entra` `Graph` `LongRunning` `Security` `EntraOps` `XSPM` `MT.1081`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmPrivilegedIdentities.Tests.ps1`

---

### üö´ MT.1083: Ensure Delicensing Resiliency is enabled

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview


> **Important:** This test is only available if your tenant has at least **5000 non-trial Exchange Online licenses**.

Delicensing Resiliency SHOULD be enabled to maintain access to mailboxes when licenses are removed.


#### Remediation action:

Enable Delicensing Resiliency by running the following PowerShell command in Exchange Online:

```powershell
Set-OrganizationConfig -DelayedDelicensingEnabled:$true
```

##### Optional: Configure User Notifications

You can also configure notifications to inform administrators and end users about delicensing events:

```powershell
# Enable tenant admin notifications for delicensing events
Set-OrganizationConfig -TenantAdminNotificationForDelayedDelicensingEnabled:$true

# Enable end user mail notifications for delicensing events
Set-OrganizationConfig -EndUserMailNotificationForDelayedDelicensingEnabled:$true
```

**Note**: These notification settings help ensure stakeholders are informed when licensing changes occur that could affect mailbox access.

#### Related links

* [Delayed Delicensing in Exchange Online](https://learn.microsoft.com/en-us/Exchange/recipients-in-exchange-online/manage-user-mailboxes/exchange-online-delicensing-resiliency)
* [Set-OrganizationConfig](https://docs.microsoft.com/en-us/powershell/module/exchange/set-organizationconfig)



#### Test Results


Skipped. Not enough non-trial licenses. See [Delicensing Resiliency](https://learn.microsoft.com/en-us/Exchange/recipients-in-exchange-online/manage-user-mailboxes/exchange-online-delicensing-resiliency)


**Tag**: `Maester` `Exchange` `MT.1083` `DelicensingResiliency`

**Category**: `Maester/Exchange`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Exchange\Test-ExchangeSetting.Tests.ps1`

---

### üö´ MT.1084: Microsoft Entra seamless single sign-on should be disabled for all domains in EntraID Connect servers.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

## Description

Executes KQL function over IdentityLogonEvents data to retrieve information about domains with Seamless SSO usage. It enriches the data with device insights.

## Why This Matters

Seamless Single Sign-On in Entra ID Connect should be disabled because:

- **Lateral movement**: Allows for lateral movement between an on-premise domain and Entra ID when an Entra ID Connect server is compromised.
- **Brute force**: Can be used for brute force attacks against Entra ID.

Seamless Single Sign-On is used for passwordless access for domain-joined devices, end-user devices, or device versions that do not support Primary Refresh Tokens (Windows versions prior to Windows 10 for example). This scenario is becoming less common, meaning most organizations should be able to disable SSSO in Entra ID Connect.

The output of the query should help you in identifying of SSSO usage is expected for the specific source device, based on device enrichment with MDE data.

#### Remediation action

There are two steps to disabling Seamless SSO, the first is to disable the configuration in Microsoft Entra Connect and the second is to tidy up Active Directory.

To disable the feature from Microsoft Entra connect, follow these steps:

1. Log-in to the computer running Microsoft Entra Connect Sync.
2. Click **Configure**.
3. Select **Change User Sign In** and click Next.
4. On the User **Sign-In section**, uncheck the **Enable single sign-on** box, click **Next**, then **Configure**.

Then to tidy up Active Directory you need to install and run the AzureADSSO PowerShell module, follow the steps below:

1. On an Active Directory management server, open PowerShell and run the following commands to install the AzureADSSO PowerShell module:

```powershell
#Install the AzureAD Module
install-module AzureAD

#Import the AzureAD SSO module
Import-Module "C:\program files\Microsoft Azure Active Directory Connect\AzureADSSO.psd1"
```

2. Then use the following commands to list all forests in your environment which have had Seamless SSO enabled: (if you have a single forest, you can move on to the next step).

```powershell
#Create an authentication context object for Azure AD
New-AzureADSSOAuthenticationContext

#Get the SSO status and domains from Entra ID
Get-AzureADSSOStatus
```

The output should contain `"enable":false`

3. Now you can tidy up your Active Directory by running the below commands to safely delete the AZUREADSSOACC if it is still present.

```powershell
#Store domain admin credentials
$creds = Get-Credential

#Disable SSO in the forest
Disable-AzureADSSOForest -OnPremCredentials $creds
```

To verify that Seamless SSO has been successfully disabled in your environment, start by signing in to the **Entra Admin portal** and expanding **Identity > Hybrid management** and select **Microsoft Entra Connect**. Then click **Connect Sync** and verify that Seamless single sign-on is set to Disabled. [You can also use this link to go to the Entra portal directly](https://entra.microsoft.com/#view/Microsoft_AAD_Connect_Provisioning/AADConnectMenuBlade/~/ConnectSync)

#### Related links

- [HybridBrothers hunting query](https://github.com/HybridBrothers/Hunting-Queries-Detection-Rules/blob/main/Entra%20ID/HuntDomainsWithSeamlessSsoEnabled.md)
- [Finding Seamless SSO usage](https://nathanmcnulty.com/blog/2025/08/finding-seamless-sso-usage/#)
- [Why you should disable Seamless SSO in Microsoft Entra Connect](https://ourcloudnetwork.com/why-you-should-disable-seamless-sso-in-microsoft-entra-connect/)
- [Advanced Active Directory to Entra ID lateral movement techniques](https://media.defcon.org/DEF%20CON%2033/DEF%20CON%2033%20presentations/Dirk-jan%20Mollema%20-%20Advanced%20Active%20Directory%20to%20Entra%20ID%20lateral%20movement%20techniques.pdf)

#### Test Results

Skipped. OnPremisesSynchronization is not configured

**Learn more**: [https://maester.dev/docs/tests/MT.1084](https://maester.dev/docs/tests/MT.1084)

**Tag**: `EntraIdConnect` `Entra` `Graph` `Security` `MT.1084`

**Category**: `Maester/Entra`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Entra\Test-MtEntraIDConnect.Tests.ps1`

---

### ‚ùî MT.1086: Devices should not share both critical and non-critical user credentials.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmCriticalCredsOnDevicesWithNonCriticalAccounts | Should -Be $true -Because "Devices should not share both critical and non-critical user credentials, as this may lead to potential security risks and compromise of critical assets via a non-critical account."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1086](https://maester.dev/docs/tests/MT.1086)

**Tag**: `XSPM` `LongRunning` `Devices` `MT.1086`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmDevices.Tests.ps1`

---

### ‚ùî MT.1087: Devices should not be publicly exposed with remotely exploitable, highly likely to be exploited, high or critical severity CVE's.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmPublicRemotelyExploitableHighExposureDevices | Should -Be $true -Because "Devices should not be publicly exposed with remotely exploitable, highly likely to be exploited, high or critical severity CVE's. Such devices are at high risk of being compromised by attackers, potentially leading to data breaches and other security incidents."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1087](https://maester.dev/docs/tests/MT.1087)

**Tag**: `XSPM` `LongRunning` `Devices` `MT.1087`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmDevices.Tests.ps1`

---

### ‚ùî MT.1088: Devices with critical credentials should be protected by TPM.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmCriticalCredentialsOnNonTpmProtectedDevices | Should -Be $true -Because "Devices with critical credentials should be protected by TPM. Without TPM protection, these devices are vulnerable to various attacks that could compromise sensitive credentials, leading to potential security breaches."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1088](https://maester.dev/docs/tests/MT.1088)

**Tag**: `XSPM` `LongRunning` `Devices` `MT.1088`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmDevices.Tests.ps1`

---

### ‚ùî MT.1089: Devices with critical credentials should be protected by Credential Guard.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Not Run"/>

#### Overview

```ps1

        Test-MtXspmCriticalCredentialsOnNonCredGuardProtectedDevices | Should -Be $true -Because "Devices with critical credentials should be protected by Credential Guard. Without Credential Guard protection, these devices are vulnerable to various attacks that could compromise sensitive credentials, leading to potential security breaches."
    
```

**Learn more**: [https://maester.dev/docs/tests/MT.1089](https://maester.dev/docs/tests/MT.1089)

**Tag**: `XSPM` `LongRunning` `Devices` `MT.1089`

**Category**: `Exposure Management`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\XSPM\Test-XspmDevices.Tests.ps1`

---

### üö´ MT.1092: Intune APNS certificate should be valid for more than 30 days

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Check the validity of the Apple Push Notification Service (APNS) Certificate for Intune. The Apple Push Notification Service (APNS) Certificate is required for managing Apple devices with Microsoft Intune. This test checks if the APNS certificate is valid and not expired.

#### Remediation action

It is critical that you renew your APNs certificate, not request a new one. This means you must ensure that you use the same Apple ID and renew the same certificate from Apple‚Äôs site. If you request a new certificate instead of renewing your existing certificate, you will be forced to unenroll and re-enroll all of your existing iOS devices.

See the [Microsoft learn instructions to Renew Apple MDM certificate](https://learn.microsoft.com/en-us/intune-education/renew-ios-certificate-token#renew-apple-mdm-certificate).



#### Test Results


Skipped. No Apple Push Notification Certificate configured.

**Tag**: `Maester` `Intune` `MT.1092`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntuneConnectorHealth.Tests.ps1`

---

### üö´ MT.1093: Apple Automated Device Enrollment Tokens should be valid for more than 30 days

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

This test checks if the Apple ADE token is valid and not expired. The Apple Automated Device Enrollment (ADE) token is required to synchronize Apple devices with Microsoft Intune.
The token has a lifetime of one year and needs to be renewed to allow synchronization.

#### Remediation action

See the [Microsoft learn instructions to Renew enrollment program token](https://learn.microsoft.com/en-us/intune-education/renew-ios-certificate-token#renew-enrollment-program-token).

Direct Link for [Intune Portal -  Enrollment program tokens](https://intune.microsoft.com/#view/Microsoft_Intune_Enrollment/DepTokensPaging.ReactView).



#### Test Results


Skipped. No Apple Automated Device Enrollment tokens found.

**Tag**: `Maester` `Intune` `MT.1093`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntuneConnectorHealth.Tests.ps1`

---

### üö´ MT.1094: Apple Volume Purchase Program Tokens should be valid for more than 30 days

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

Check the validity of the Apple Volume Purchase Program (VPP) token for Intune. The Apple Volume Purchase Program (VPP) token is required to synchronize Apple store apps with Microsoft Intune. This test checks if the VPP token is valid and not expired.

#### Remediation action

See the [Microsoft learn instructions to Renew Apple VPP token](https://learn.microsoft.com/en-us/intune-education/renew-ios-certificate-token#renew-vpp-token).



#### Test Results


Skipped. No Apple Volume Purchase Program tokens found.

**Tag**: `Maester` `Intune` `MT.1094`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntuneConnectorHealth.Tests.ps1`

---

### üö´ MT.1095: Android Enterprise account connection should be healthy

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

This test checks if the Android Enterprise account connection is valid and has recently synchronized. The Android Enterprise connection is required to synchronize Android enterprise apps and allow device enrollment with Microsoft Intune.


#### Remediation action

The following Microsoft Learn article describes how to [Connect your Intune account to your managed Google Play account](https://learn.microsoft.com/en-us/intune/intune-service/enrollment/connect-intune-android-enterprise).

Additional links:

* [Intune - Managed Google Play Sync Blade](https://intune.microsoft.com/#view/Microsoft_Intune_Apps/ManagedGooglePlaySyncBlade)
* [Google - Organize managed Google Play accounts enterprises](https://support.google.com/googleplay/work/answer/7042126?hl=en&sjid=2119181478110152135-EU)



#### Test Results


Skipped. Android Enterprise is not configured or bound.

**Tag**: `Maester` `Intune` `MT.1095`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntuneConnectorHealth.Tests.ps1`

---

### üö´ MT.1097: Ensure all Intune Certificate Connectors are healthy and running supported versions

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

This check verifies that all Intune Certificate Connectors are healthy and running a supported Version.

#### Remediation action

1. Check the status of your certificate connectors in the [Intune Certifcate Connector blade](https://intune.microsoft.com/#view/Microsoft_Intune_DeviceSettings/TenantAdminConnectorsMenu/~/certConnectors)
2. Review the [Certificate Connector for Microsoft Intune Release Notes](https://learn.microsoft.com/en-us/intune/intune-service/protect/certificate-connector-overview#lifecycle)
3. Ensure the Certificate Connector servers are operational and running a recent version.



#### Test Results


Skipped. No Intune Certificate Connectors found.

**Tag**: `Maester` `Intune` `MT.1097`

**Category**: `Maester/Intune`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\Maester\Intune\Test-MtIntuneConnectorHealth.Tests.ps1`

---

### üö´ ORCA.143: Safety Tips are enabled.

<img align="right" src="https://maester.dev/img/test-result/pill-notrun.png" height="25" alt="Skipped"/>

#### Overview

By default, safety tips can provide useful security information when reading an email.

#### Remediation action
Safety Tips should be enabled.

#### Related Links

* [Microsoft 365 Defender Portal - Anti-spam settings](https://security.microsoft.com/antispam) 
* [Recommended settings for EOP and Microsoft Defender for Office 365](https://aka.ms/orca-antispam-docs-8)


#### Test Results

Skipped. The statement "SkipInReport" was specified by ORCA.

**Tag**: `ORCA` `ORCA.143` `EXO` `Security`

**Category**: `ORCA`

**Source**: `C:\projects\24kitchen\Maestersettings\maester-tests\orca\Test-ORCA143.Tests.ps1`

---



___
Maester 2.0.0

